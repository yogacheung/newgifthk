/** Cooked with Flambe, https://getflambe.com */
'use strict';(function(){function y(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function Rf(a){return a instanceof Array?function(){return F.iter(a)}:"function"==typeof a.iterator?G(a,a.iterator):a.iterator}function G(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=fg++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,
arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var Ya=function(a,b){b=b.split("u").join("");this.r=RegExp(a,b)};Ya.__name__=!0;Ya.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw"EReg::matched";},matchedPos:function(){if(null==this.r.m)throw"No string matched";return{pos:this.r.m.index,len:this.r.m[0].length}},split:function(a){return a.replace(this.r,
"#__delim__#").split("#__delim__#")},__class__:Ya};var F=function(){};F.__name__=!0;F.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};F.substr=function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};F.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};F.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};
var Ud=function(){};Ud.__name__=!0;Ud.array=function(a){for(var b=[],a=Rf(a)();a.hasNext();){var c=a.next();b.push(c)}return b};Ud.count=function(a,b){var c=0;if(null==b)for(var d=Rf(a)();d.hasNext();)d.next(),c++;else for(d=Rf(a)();d.hasNext();){var e=d.next();b(e)&&c++}return c};var U=function(){};U.__name__=!0;U.main=function(){u.init();j.defaultOrientation=Ma.Landscape;j.systemBgColor=14409182;j.maskRootCont=!1;j.rootContYAlign="top";j.useMouseHandCursor=!0;U.parseExtData()};U.onInit=function(){j.buttonClickSfx=
"button_click_sfx";0<=window.navigator.userAgent.indexOf("iPad")||0<=window.navigator.userAgent.indexOf("iPhone")?j.goToScene((new Je).root):j.goToScene((new aa).root)};U.parseExtData=function(){U.qs=Sf.parseQueryString(u._platform.getExternal().call("location.search.toString").substr(1),"rid");var a=new Ba;""==U.qs?a.add("card","XML_TEMPLATE/card.xml"):a.add("card","RECIPIENT_TEMPLATES/"+U.qs+".xml");u._platform.loadAssetPack(a).get(function(a){U.xmlData=new Vd(v.parse(a.getFile("card").toString()).firstElement());
a=new Ba;""!=U.qs?a.add("logo",U.xmlData.node.resolve("logo").get_innerData().toString()):a.add("logo","XML_TEMPLATE/logo.png");a.add("soundtrack","music/"+U.xmlData.node.resolve("music").get_innerData().toString()+".mp3");a.add("soundtrack","music/"+U.xmlData.node.resolve("music").get_innerData().toString()+".ogg");"1"==U.xmlData.node.resolve("color_theme").get_innerData().toString()&&(j.mainAssetsFolder="main2");j.extManifest=a;(new j(1920,1080)).init.connect(U.onInit).once()})};var Tf=function(){};
Tf.__name__=!0;Math.__name__=!0;var ma=function(){};ma.__name__=!0;ma.field=function(a,b){try{return a[b]}catch(c){return null}};ma.getProperty=function(a,b){var c;return null==a?null:a.__properties__&&(c=a.__properties__["get_"+b])?a[c]():a[b]};ma.callMethod=function(a,b,c){return b.apply(a,c)};ma.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b};var B=function(){};B.__name__=!0;B.is=function(a,
b){return ga.__instanceof(a,b)};B.instance=function(a,b){return a instanceof b?a:null};B.string=function(a){return ga.__string_rec(a,"")};B["int"]=function(a){return a|0};B.parseInt=function(a){var b=parseInt(a,10);if(0==b&&(120==F.cca(a,1)||88==F.cca(a,1)))b=parseInt(a);return isNaN(b)?null:b};B.parseFloat=function(a){return parseFloat(a)};var gd=function(){this.b=""};gd.__name__=!0;gd.prototype={add:function(a){this.b+=B.string(a)},addSub:function(a,b,c){this.b=null==c?this.b+F.substr(a,b,null):
this.b+F.substr(a,b,c)},__class__:gd};var S=function(){};S.__name__=!0;S.startsWith=function(a,b){return a.length>=b.length&&F.substr(a,0,b.length)==b};S.isSpace=function(a,b){var c=F.cca(a,b);return 8<c&&14>c||32==c};S.ltrim=function(a){for(var b=a.length,c=0;c<b&&S.isSpace(a,c);)c++;return 0<c?F.substr(a,c,b-c):a};S.rtrim=function(a){for(var b=a.length,c=0;c<b&&S.isSpace(a,b-c-1);)c++;return 0<c?F.substr(a,0,b-c):a};S.trim=function(a){return S.ltrim(S.rtrim(a))};S.replace=function(a,b,c){return a.split(b).join(c)};
S.fastCodeAt=function(a,b){return a.charCodeAt(b)};var v=function(){};v.__name__=!0;v.parse=function(a){return wb.parse(a)};v.createElement=function(a){var b=new v;b.nodeType=v.Element;b._children=[];b._attributes=new Za;b.set_nodeName(a);return b};v.createPCData=function(a){var b=new v;b.nodeType=v.PCData;b.set_nodeValue(a);return b};v.createCData=function(a){var b=new v;b.nodeType=v.CData;b.set_nodeValue(a);return b};v.createComment=function(a){var b=new v;b.nodeType=v.Comment;b.set_nodeValue(a);
return b};v.createDocType=function(a){var b=new v;b.nodeType=v.DocType;b.set_nodeValue(a);return b};v.createProcessingInstruction=function(a){var b=new v;b.nodeType=v.ProcessingInstruction;b.set_nodeValue(a);return b};v.createDocument=function(){var a=new v;a.nodeType=v.Document;a._children=[];return a};v.prototype={get_nodeName:function(){if(this.nodeType!=v.Element)throw"bad nodeType";return this._nodeName},set_nodeName:function(a){if(this.nodeType!=v.Element)throw"bad nodeType";return this._nodeName=
a},get_nodeValue:function(){if(this.nodeType==v.Element||this.nodeType==v.Document)throw"bad nodeType";return this._nodeValue},set_nodeValue:function(a){if(this.nodeType==v.Element||this.nodeType==v.Document)throw"bad nodeType";return this._nodeValue=a},get:function(a){if(this.nodeType!=v.Element)throw"bad nodeType";return this._attributes.get(a)},set:function(a,b){if(this.nodeType!=v.Element)throw"bad nodeType";this._attributes.set(a,b)},exists:function(a){if(this.nodeType!=v.Element)throw"bad nodeType";
return this._attributes.exists(a)},iterator:function(){if(null==this._children)throw"bad nodetype";return{cur:0,x:this._children,hasNext:function(){return this.cur<this.x.length},next:function(){return this.x[this.cur++]}}},elements:function(){if(null==this._children)throw"bad nodetype";return{cur:0,x:this._children,hasNext:function(){for(var a=this.cur,b=this.x.length;a<b&&!(this.x[a].nodeType==v.Element);)a+=1;this.cur=a;return a<b},next:function(){for(var a=this.cur,b=this.x.length;a<b;){var c=
this.x[a],a=a+1;if(c.nodeType==v.Element)return this.cur=a,c}return null}}},elementsNamed:function(a){if(null==this._children)throw"bad nodetype";return{cur:0,x:this._children,hasNext:function(){for(var b=this.cur,c=this.x.length;b<c;){var d=this.x[b];if(d.nodeType==v.Element&&d._nodeName==a)break;b++}this.cur=b;return b<c},next:function(){for(var b=this.cur,c=this.x.length;b<c;){var d=this.x[b];b++;if(d.nodeType==v.Element&&d._nodeName==a)return this.cur=b,d}return null}}},firstElement:function(){if(null==
this._children)throw"bad nodetype";for(var a=0,b=this._children.length;a<b;){var c=this._children[a];if(c.nodeType==v.Element)return c;a++}return null},addChild:function(a){if(null==this._children)throw"bad nodetype";null!=a._parent&&F.remove(a._parent._children,a);a._parent=this;this._children.push(a)},__class__:v,__properties__:{set_nodeValue:"set_nodeValue",get_nodeValue:"get_nodeValue",set_nodeName:"set_nodeName",get_nodeName:"get_nodeName"}};var Ra=function(){};Ra.__name__=!0;Ra.prototype={__class__:Ra};
var A=function(){this._flags=0;this.owner=this.next=null};A.__name__=!0;A.__interfaces__=[Ra];A.prototype={onAdded:function(){},onRemoved:function(){},onStart:function(){},onStop:function(){},onUpdate:function(){},dispose:function(){null!=this.owner&&this.owner.remove(this)},get_name:function(){return null},__class__:A,__properties__:{get_name:"get_name"}};var fc=function(){A.call(this);this._disposables=[]};fc.__name__=!0;fc.__super__=A;fc.prototype=y(A.prototype,{get_name:function(){return"Disposer_12"},
add:function(a){this._disposables.push(a);return this},connect1:function(a,b){this.add(a.connect(b));return this},onRemoved:function(){this.freeDisposables()},dispose:function(){A.prototype.dispose.call(this);this.freeDisposables()},freeDisposables:function(){var a=this._disposables;this._disposables=[];for(var b=0;b<a.length;){var c=a[b];++b;c.dispose()}},__class__:fc});var ba=function(){this.parent=this.firstChild=this.next=this.firstComponent=null;this._compMap={}};ba.__name__=!0;ba.__interfaces__=
[Ra];ba.prototype={add:function(a){null!=a.owner&&a.owner.remove(a);var b=a.get_name(),c=this._compMap[b];null!=c&&this.remove(c);this._compMap[b]=a;b=null;for(c=this.firstComponent;null!=c;)b=c,c=c.next;null!=b?b.next=a:this.firstComponent=a;a.owner=this;a.next=null;a.onAdded();return this},remove:function(a){for(var b=null,c=this.firstComponent;null!=c;){var d=c.next;if(c==a)return null==b?this.firstComponent=d:(b.owner=this,b.next=d),delete this._compMap[c.get_name()],0!=(c._flags&1)&&(c.onStop(),
c._flags&=-2),c.onRemoved(),c.owner=null,c.next=null,!0;b=c;c=d}return!1},addChild:function(a,b){null==b&&(b=!0);null!=a.parent&&a.parent.removeChild(a);a.parent=this;if(b){for(var c=null,d=this.firstChild;null!=d;)c=d,d=d.next;null!=c?c.next=a:this.firstChild=a}else a.next=this.firstChild,this.firstChild=a;return this},removeChild:function(a){for(var b=null,c=this.firstChild;null!=c;){var d=c.next;if(c==a){null==b?this.firstChild=d:b.next=d;c.parent=null;c.next=null;break}b=c;c=d}},disposeChildren:function(){for(;null!=
this.firstChild;)this.firstChild.dispose()},dispose:function(){for(null!=this.parent&&this.parent.removeChild(this);null!=this.firstComponent;)this.firstComponent.dispose();this.disposeChildren()},__class__:ba};var Uf=function(){};Uf.__name__=!0;var Ke=function(){};Ke.__name__=!0;Ke.prototype={__class__:Ke};var Nb=function(){};Nb.__name__=!0;Nb.__interfaces__=[Ke];Nb.prototype={init:function(){var a=this;w.fixAndroidMath();var b=null;try{b=window.flambe.canvas}catch(c){}b.setAttribute("tabindex",
"0");b.style.outlineStyle="none";b.style.webkitTapHighlightColor="transparent";b.setAttribute("moz-opaque","true");this._stage=new hd(b);this._pointer=new ia;this._mouse=new id(this._pointer,b);this._renderer=this.createRenderer(b);this.mainLoop=new uc;this.musicPlaying=!1;this._canvas=b;this._container=b.parentElement;this._container.style.overflow="hidden";this._container.style.position="relative";this._container.style.msTouchAction="none";var d=0,e=function(c){if(!(1E3>c.timeStamp-d)){var e=b.getBoundingClientRect(),
f=a.getX(c,e),e=a.getY(c,e);switch(c.type){case "mousedown":c.target==b&&(c.preventDefault(),a._mouse.submitDown(f,e,c.button),b.focus());break;case "mousemove":a._mouse.submitMove(f,e);break;case "mouseup":a._mouse.submitUp(f,e,c.button);break;case "mousewheel":case "DOMMouseScroll":a._mouse.submitScroll(f,e,"mousewheel"==c.type?c.wheelDelta/40:-c.detail)&&c.preventDefault()}}};window.addEventListener("mousedown",e,!1);window.addEventListener("mousemove",e,!1);window.addEventListener("mouseup",e,
!1);b.addEventListener("mousewheel",e,!1);b.addEventListener("DOMMouseScroll",e,!1);b.addEventListener("contextmenu",function(a){a.preventDefault()},!1);var f="undefined"!=typeof window.ontouchstart,e="msMaxTouchPoints"in window.navigator&&1<window.navigator.msMaxTouchPoints;if(f||e){var h=new Wd(this._pointer,f?4:window.navigator.msMaxTouchPoints);this._touch=h;e=function(b){var c;c=f?b.changedTouches:[b];var e=b.target.getBoundingClientRect();d=b.timeStamp;switch(b.type){case "touchstart":case "MSPointerDown":case "pointerdown":b.preventDefault();
w.SHOULD_HIDE_MOBILE_BROWSER&&w.hideMobileBrowser();for(b=0;b<c.length;){var i=c[b];++b;var k=a.getX(i,e),g=a.getY(i,e);h.submitDown((f?i.identifier:i.pointerId)|0,k,g)}break;case "touchmove":case "MSPointerMove":case "pointermove":b.preventDefault();for(b=0;b<c.length;)i=c[b],++b,k=a.getX(i,e),g=a.getY(i,e),h.submitMove((f?i.identifier:i.pointerId)|0,k,g);break;case "touchend":case "touchcancel":case "MSPointerUp":case "pointerup":for(b=0;b<c.length;)i=c[b],++b,k=a.getX(i,e),g=a.getY(i,e),h.submitUp((f?
i.identifier:i.pointerId)|0,k,g)}};f?(b.addEventListener("touchstart",e,!1),b.addEventListener("touchmove",e,!1),b.addEventListener("touchend",e,!1),b.addEventListener("touchcancel",e,!1)):(b.addEventListener("MSPointerDown",e,!1),b.addEventListener("MSPointerMove",e,!1),b.addEventListener("MSPointerUp",e,!1))}else this._touch=new Xd;var i=window.onerror;window.onerror=function(a,b,c){u.uncaughtError.emit(a);return null!=i?i(a,b,c):!1};var k=w.loadExtension("hidden",window.document);null!=k.value?
(e=function(){u.hidden.set__(ma.field(window.document,k.field))},e(null),window.document.addEventListener(k.prefix+"visibilitychange",e,!1)):(e=function(a){u.hidden.set__("pagehide"==a.type)},window.addEventListener("pageshow",e,!1),window.addEventListener("pagehide",e,!1));u.hidden.get_changed().connect(function(b){b||(a._skipFrame=!0)});this._skipFrame=!1;this._lastUpdate=Date.now();var g=w.loadExtension("requestAnimationFrame").value,e=w.loadExtension("requestAnimationFrame").prefix;if(null!=g&&
"webkit"!=e){var l=window.performance,j=null!=l&&w.polyfill("now",l);j?this._lastUpdate=l.now():null;var m=null,m=function(c){a.update(j?l.now():c);g(m,b)};g(m,b)}else window.setInterval(function(){a.update(Date.now())},16);Qc.info("Initialized HTML platform",["renderer",this._renderer.get_type()])},loadAssetPack:function(a){return(new J(this,a)).promise},getStage:function(){return this._stage},update:function(a){var b=(a-this._lastUpdate)/1E3;this._lastUpdate=a;u.hidden._value||(this._skipFrame?
this._skipFrame=!1:(this.mainLoop.update(b),this.mainLoop.render(this._renderer)))},getPointer:function(){return this._pointer},getMouse:function(){return this._mouse},getWeb:function(){null==this._web&&(this._web=new Yd(this._container));return this._web},getExternal:function(){null==this._external&&(this._external=new me);return this._external},getRenderer:function(){return this._renderer},getX:function(a,b){return(a.clientX-b.left)*this._stage.get_width()/b.width},getY:function(a,b){return(a.clientY-
b.top)*this._stage.get_height()/b.height},createRenderer:function(a){return new vc(a)},__class__:Nb};var ea=function(a,b){this._value=a;this._changed=null!=b?new Rc(b):null};ea.__name__=!0;ea.prototype={watch:function(a){a(this._value,this._value);return this.get_changed().connect(a)},set__:function(a){var b=this._value;a!=b&&(this._value=a,null!=this._changed&&this._changed.emit(a,b));return a},get_changed:function(){null==this._changed&&(this._changed=new Rc);return this._changed},__class__:ea,
__properties__:{get_changed:"get_changed",set__:"set__"}};var wc=function(a,b){this._next=null;this._signal=a;this._listener=b;this.stayInList=!0};wc.__name__=!0;wc.__interfaces__=[Ra];wc.prototype={once:function(){this.stayInList=!1;return this},dispose:function(){null!=this._signal&&(this._signal.disconnect(this),this._signal=null)},__class__:wc};var ca=function(a){this._head=null!=a?new wc(this,a):null;this._deferredTasks=null};ca.__name__=!0;ca.prototype={connectImpl:function(a,b){var c=this,
d=new wc(this,a);this._head==ca.DISPATCHING_SENTINEL?this.defer(function(){c.listAdd(d,b)}):this.listAdd(d,b);return d},disconnect:function(a){var b=this;this._head==ca.DISPATCHING_SENTINEL?this.defer(function(){b.listRemove(a)}):this.listRemove(a)},defer:function(a){for(var b=null,c=this._deferredTasks;null!=c;)b=c,c=c.next;a=new Le(a);null!=b?b.next=a:this._deferredTasks=a},willEmit:function(){var a=this._head;this._head=ca.DISPATCHING_SENTINEL;return a},didEmit:function(a){this._head=a;a=this._deferredTasks;
for(this._deferredTasks=null;null!=a;)a.fn(),a=a.next},listAdd:function(a,b){if(b)a._next=this._head,this._head=a;else{for(var c=null,d=this._head;null!=d;)c=d,d=d._next;null!=c?c._next=a:this._head=a}},listRemove:function(a){for(var b=null,c=this._head;null!=c;){if(c==a){a=c._next;null==b?this._head=a:b._next=a;break}b=c;c=c._next}},__class__:ca};var Rc=function(a){ca.call(this,a)};Rc.__name__=!0;Rc.__super__=ca;Rc.prototype=y(ca.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,
b)},emit:function(a,b){var c=this;this._head==ca.DISPATCHING_SENTINEL?this.defer(function(){c.emitImpl(a,b)}):this.emitImpl(a,b)},emitImpl:function(a,b){for(var c=this.willEmit(),d=c;null!=d;)d._listener(a,b),d.stayInList||d.dispose(),d=d._next;this.didEmit(c)},__class__:Rc});var Y=function(a){ca.call(this,a)};Y.__name__=!0;Y.__super__=ca;Y.prototype=y(ca.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a){var b=this;this._head==ca.DISPATCHING_SENTINEL?
this.defer(function(){b.emitImpl(a)}):this.emitImpl(a)},emitImpl:function(a){for(var b=this.willEmit(),c=b;null!=c;)c._listener(a),c.stayInList||c.dispose(),c=c._next;this.didEmit(b)},__class__:Y});var C=function(a,b){this._behavior=null;ea.call(this,a,b)};C.__name__=!0;C.__super__=ea;C.prototype=y(ea.prototype,{set__:function(a){this._behavior=null;return ea.prototype.set__.call(this,a)},update:function(a){null!=this._behavior&&(ea.prototype.set__.call(this,this._behavior.update(a)),this._behavior.isComplete()&&
(this._behavior=null))},animateTo:function(a,b,c){this.set_behavior(new Sc(this._value,a,b,c))},set_behavior:function(a){this._behavior=a;this.update(0);return a},__class__:C,__properties__:y(ea.prototype.__properties__,{set_behavior:"set_behavior"})});var u=function(){};u.__name__=!0;u.init=function(){u._calledInit||(u._platform.init(),u._calledInit=!0)};u.loadAssetPack=function(a){return u._platform.loadAssetPack(a)};var Qc=function(){};Qc.__name__=!0;Qc.info=function(){null};Qc.__super__=Uf;Qc.prototype=
y(Uf.prototype,{__class__:Qc});var Me=function(){this._realDt=0};Me.__name__=!0;Me.__super__=A;Me.prototype=y(A.prototype,{get_name:function(){return"SpeedAdjuster_15"},onUpdate:function(a){0<this._realDt&&(a=this._realDt,this._realDt=0);this.scale.update(a)},__class__:Me});var Ne=function(){};Ne.__name__=!0;Ne.prototype={__class__:Ne};var na=function(){};na.__name__=!0;na.linear=function(a){return a};na.quadIn=function(a){return a*a};na.quadOut=function(a){return a*(2-a)};na.cubeIn=function(a){return a*
a*a};na.circOut=function(a){--a;return Math.sqrt(1-a*a)};na.backOut=function(a){return 1- --a*a*(-2.70158*a-1.70158)};var Sc=function(a,b,c,d){this._from=a;this._to=b;this._duration=c;this.elapsed=0;this._easing=null!=d?d:na.linear};Sc.__name__=!0;Sc.__interfaces__=[Ne];Sc.prototype={update:function(a){this.elapsed+=a;return this.elapsed>=this._duration?this._to:this._from+(this._to-this._from)*this._easing(this.elapsed/this._duration)},isComplete:function(){return this.elapsed>=this._duration},__class__:Sc};
var gc=function(){};gc.__name__=!0;gc.__interfaces__=[Ra];gc.prototype={__class__:gc};var z={__ename__:!0,__constructs__:"WEBP,JXR,PNG,JPG,GIF,DDS,PVR,PKM,MP3,M4A,OPUS,OGG,WAV,Data".split(","),WEBP:["WEBP",0]};z.WEBP.__enum__=z;z.JXR=["JXR",1];z.JXR.__enum__=z;z.PNG=["PNG",2];z.PNG.__enum__=z;z.JPG=["JPG",3];z.JPG.__enum__=z;z.GIF=["GIF",4];z.GIF.__enum__=z;z.DDS=["DDS",5];z.DDS.__enum__=z;z.PVR=["PVR",6];z.PVR.__enum__=z;z.PKM=["PKM",7];z.PKM.__enum__=z;z.MP3=["MP3",8];z.MP3.__enum__=z;z.M4A=["M4A",
9];z.M4A.__enum__=z;z.OPUS=["OPUS",10];z.OPUS.__enum__=z;z.OGG=["OGG",11];z.OGG.__enum__=z;z.WAV=["WAV",12];z.WAV.__enum__=z;z.Data=["Data",13];z.Data.__enum__=z;var Oe=function(a,b,c,d){this.name=a;this.url=b;this.format=c;this.bytes=d};Oe.__name__=!0;Oe.prototype={__class__:Oe};var Ed=function(){};Ed.__name__=!0;Ed.__interfaces__=[Ra];Ed.prototype={__class__:Ed};var Zd=function(){};Zd.__name__=!0;Zd.__interfaces__=[gc];Zd.prototype={__class__:Zd};var Ba=function(){this._localBase=this._remoteBase=
null;this._entries=[]};Ba.__name__=!0;Ba.fromAssets=function(a,b){null==b&&(b=!0);var c=ma.field(Vf.getType(Ba).assets[0],a);if(null==c){if(b)throw Sa.withFields("Missing asset pack",["name",a]);return null}var d=new Ba;d.set_localBase("assets");for(var e=0;e<c.length;){var f=c[e];++e;var h=f.name,i=a+"/"+h+"?v="+B.string(f.md5),k=Ba.inferFormat(h);k!=z.Data&&(h=Sa.removeFileExtension(h));d.add(h,i,f.bytes,k)}return d};Ba.inferFormat=function(a){a=Sa.getUrlExtension(a);if(null!=a)switch(a.toLowerCase()){case "gif":return z.GIF;
case "jpg":case "jpeg":return z.JPG;case "jxr":case "wdp":return z.JXR;case "png":return z.PNG;case "webp":return z.WEBP;case "dds":return z.DDS;case "pvr":return z.PVR;case "pkm":return z.PKM;case "m4a":return z.M4A;case "mp3":return z.MP3;case "ogg":return z.OGG;case "opus":return z.OPUS;case "wav":return z.WAV}else null;return z.Data};Ba.prototype={add:function(a,b,c,d){null==c&&(c=0);null==d&&(d=Ba.inferFormat(b));a=new Oe(a,b,d,c);this._entries.push(a);return a},iterator:function(){return F.iter(this._entries)},
getFullURL:function(a){var b;b=null!=this.get_remoteBase()&&Ba._supportsCrossOrigin?this.get_remoteBase():this.get_localBase();return null!=b?Sa.joinPath(b,a.url):a.url},get_localBase:function(){return this._localBase},set_localBase:function(a){null!=a&&Wf.that(!S.startsWith(a,"http://")&&!S.startsWith(a,"https://"),"localBase must be a path on the same domain, NOT starting with http(s)://",null);return this._localBase=a},get_remoteBase:function(){return this._remoteBase},__class__:Ba,__properties__:{get_remoteBase:"get_remoteBase",
set_localBase:"set_localBase",get_localBase:"get_localBase"}};var oa={__ename__:!0,__constructs__:"Normal,Add,Multiply,Screen,Mask,Copy".split(","),Normal:["Normal",0]};oa.Normal.__enum__=oa;oa.Add=["Add",1];oa.Add.__enum__=oa;oa.Multiply=["Multiply",2];oa.Multiply.__enum__=oa;oa.Screen=["Screen",3];oa.Screen.__enum__=oa;oa.Mask=["Mask",4];oa.Mask.__enum__=oa;oa.Copy=["Copy",5];oa.Copy.__enum__=oa;var xc={__ename__:!0,__constructs__:["Gravity","Radial"],Gravity:["Gravity",0]};xc.Gravity.__enum__=
xc;xc.Radial=["Radial",1];xc.Radial.__enum__=xc;var E=function(a,b){this._file=a.getFile(b+".pex");for(var c=v.parse(this._file.toString()),d=0,e=0,f=b.lastIndexOf("/"),f=0<=f?F.substr(b,0,f+1):"",c=c.firstElement().elements();c.hasNext();){var h=c.next();switch(h.get_nodeName().toLowerCase()){case "texture":this.texture=a.getTexture(f+Sa.removeFileExtension(h.get("name")));break;case "angle":this.angle=E.getFloat(h,"value");break;case "anglevariance":this.angleVariance=E.getFloat(h,"value");break;
case "blendfuncdestination":e=B["int"](E.getFloat(h,"value"));break;case "blendfuncsource":d=B["int"](E.getFloat(h,"value"));break;case "duration":this.duration=E.getFloat(h,"value");break;case "emittertype":this.type=0==B["int"](E.getFloat(h,"value"))?xc.Gravity:xc.Radial;break;case "finishcolor":this.alphaEnd=E.getFloat(h,"alpha");break;case "finishcolorvariance":this.alphaEndVariance=E.getFloat(h,"alpha");break;case "finishparticlesize":this.sizeEnd=E.getFloat(h,"value");break;case "finishparticlesizevariance":this.sizeEndVariance=
E.getFloat(h,"value");break;case "gravity":this.gravityX=E.getFloat(h,"x");this.gravityY=E.getFloat(h,"y");break;case "maxparticles":this.maxParticles=B["int"](E.getFloat(h,"value"));break;case "maxradius":this.maxRadius=E.getFloat(h,"value");break;case "maxradiusvariance":this.maxRadiusVariance=E.getFloat(h,"value");break;case "minradius":this.minRadius=E.getFloat(h,"value");break;case "particlelifespan":this.lifespan=E.getFloat(h,"value");break;case "particlelifespanvariance":this.lifespanVariance=
E.getFloat(h,"value");break;case "radialaccelvariance":this.radialAccelVariance=E.getFloat(h,"value");break;case "radialacceleration":this.radialAccel=E.getFloat(h,"value");break;case "rotatepersecond":this.rotatePerSecond=E.getFloat(h,"value");break;case "rotatepersecondvariance":this.rotatePerSecondVariance=E.getFloat(h,"value");break;case "rotationend":this.rotationEnd=E.getFloat(h,"value");break;case "rotationendvariance":this.rotationEndVariance=E.getFloat(h,"value");break;case "rotationstart":this.rotationStart=
E.getFloat(h,"value");break;case "rotationstartvariance":this.rotationStartVariance=E.getFloat(h,"value");break;case "sourcepositionvariance":this.emitXVariance=E.getFloat(h,"x");this.emitYVariance=E.getFloat(h,"y");break;case "speed":this.speed=E.getFloat(h,"value");break;case "speedvariance":this.speedVariance=E.getFloat(h,"value");break;case "startcolor":this.alphaStart=E.getFloat(h,"alpha");break;case "startcolorvariance":this.alphaStartVariance=E.getFloat(h,"alpha");break;case "startparticlesize":this.sizeStart=
E.getFloat(h,"value");break;case "startparticlesizevariance":this.sizeStartVariance=E.getFloat(h,"value");break;case "tangentialaccelvariance":this.tangentialAccelVariance=E.getFloat(h,"value");break;case "tangentialacceleration":this.tangentialAccel=E.getFloat(h,"value")}}0>=this.lifespan&&(this.lifespan=this.duration);1==d&&1==e?this.blendMode=oa.Add:1==d&&771==e?this.blendMode=null:(0!=d||0!=e)&&null};E.__name__=!0;E.getFloat=function(a,b){return B.parseFloat(a.get(b))};E.prototype={createEmitter:function(){return new fa(this)},
__class__:E};var Pe=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};Pe.__name__=!0;Pe.prototype={__class__:Pe};var M=function(){this.blendMode=this.scissor=null;var a=this;A.call(this);this._flags|=54;this._localMatrix=new Qe;var b=function(){a._flags|=24};this.x=new C(0,b);this.y=new C(0,b);this.rotation=new C(0,b);this.scaleX=new C(1,b);this.scaleY=new C(1,b);this.anchorX=new C(0,b);this.anchorY=new C(0,b);this.alpha=new C(1)};M.__name__=!0;M.hitTest=function(a,b,c){var d=a._compMap.Sprite_1;
if(null!=d){if(6!=(d._flags&6))return null;d.getLocalMatrix().inverseTransform(b,c,M._scratchPoint)&&(b=M._scratchPoint.x,c=M._scratchPoint.y);var e=d.scissor;if(null!=e&&!e.contains(b,c))return null}a=M.hitTestBackwards(a.firstChild,b,c);return null!=a?a:null!=d&&d.containsLocal(b,c)?d:null};M.render=function(a,b){var c=a._compMap.Sprite_1;if(null!=c){var d=c.alpha._value;if(0==(c._flags&2)||0>=d)return;b.save();1>d&&b.multiplyAlpha(d);null!=c.blendMode&&b.setBlendMode(c.blendMode);var d=c.getLocalMatrix(),
e=d.m02,f=d.m12;0!=(c._flags&32)&&(e=Math.round(e),f=Math.round(f));b.transform(d.m00,d.m10,d.m01,d.m11,e,f);d=c.scissor;null!=d&&b.applyScissor(d.x,d.y,d.width,d.height);c.draw(b)}d=a._compMap.Director_10;if(null!=d){d=d.occludedScenes;for(e=0;e<d.length;)f=d[e],++e,M.render(f,b)}for(d=a.firstChild;null!=d;)e=d.next,M.render(d,b),d=e;null!=c&&b.restore()};M.hitTestBackwards=function(a,b,c){if(null!=a){var d=M.hitTestBackwards(a.next,b,c);return null!=d?d:M.hitTest(a,b,c)}return null};M.__super__=
A;M.prototype=y(A.prototype,{get_name:function(){return"Sprite_1"},getNaturalWidth:function(){return 0},getNaturalHeight:function(){return 0},containsLocal:function(a,b){return 0<=a&&a<this.getNaturalWidth()&&0<=b&&b<this.getNaturalHeight()},getLocalMatrix:function(){0!=(this._flags&8)&&(this._flags&=-9,this._localMatrix.compose(this.x._value,this.y._value,this.scaleX._value,this.scaleY._value,3.141592653589793*this.rotation._value/180),this._localMatrix.translate(-this.anchorX._value,-this.anchorY._value));
return this._localMatrix},setAnchor:function(a,b){this.anchorX.set__(a);this.anchorY.set__(b);return this},centerAnchor:function(){this.anchorX.set__(this.getNaturalWidth()/2);this.anchorY.set__(this.getNaturalHeight()/2);return this},setXY:function(a,b){this.x.set__(a);this.y.set__(b);return this},setAlpha:function(a){this.alpha.set__(a);return this},setRotation:function(a){this.rotation.set__(a);return this},setScale:function(a){this.scaleX.set__(a);this.scaleY.set__(a);return this},disablePointer:function(){this.set_pointerEnabled(!1);
return this},onAdded:function(){0!=(this._flags&64)&&this.connectHover()},onRemoved:function(){null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)},onUpdate:function(a){this.x.update(a);this.y.update(a);this.rotation.update(a);this.scaleX.update(a);this.scaleY.update(a);this.alpha.update(a);this.anchorX.update(a);this.anchorY.update(a)},draw:function(){},getParentSprite:function(){if(null==this.owner)return null;for(var a=this.owner.parent;null!=a;){var b=a._compMap.Sprite_1;
if(null!=b)return b;a=a.parent}return null},get_pointerDown:function(){null==this._pointerDown&&(this._pointerDown=new Y);return this._pointerDown},get_pointerMove:function(){null==this._pointerMove&&(this._pointerMove=new Y);return this._pointerMove},get_pointerUp:function(){null==this._pointerUp&&(this._pointerUp=new Y);return this._pointerUp},get_pointerIn:function(){null==this._pointerIn&&(this._pointerIn=new Y);return this._pointerIn},get_pointerOut:function(){null==this._pointerOut&&(this._pointerOut=
new Y);return this._pointerOut},connectHover:function(){var a=this;null==this._hoverConnection&&(this._hoverConnection=u._platform.getPointer().move.connect(function(b){for(var c=b.hit;null!=c;){if(c==a)return;c=c.getParentSprite()}null!=a._pointerOut&&0!=(a._flags&64)&&a._pointerOut.emit(b);a._flags&=-65;a._hoverConnection.dispose();a._hoverConnection=null}))},set_visible:function(a){this._flags=Re.set(this._flags,2,a);return a},set_pointerEnabled:function(a){this._flags=Re.set(this._flags,4,a);
return a},onPointerDown:function(a){this.onHover(a);null!=this._pointerDown&&this._pointerDown.emit(a)},onPointerMove:function(a){this.onHover(a);null!=this._pointerMove&&this._pointerMove.emit(a)},onHover:function(a){if(0==(this._flags&64)&&(this._flags|=64,null!=this._pointerIn||null!=this._pointerOut))null!=this._pointerIn&&this._pointerIn.emit(a),this.connectHover()},onPointerUp:function(a){switch(a.source[1]){case 1:null!=this._pointerOut&&0!=(this._flags&64)&&this._pointerOut.emit(a),this._flags&=
-65,null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)}null!=this._pointerUp&&this._pointerUp.emit(a)},__class__:M,__properties__:y(A.prototype.__properties__,{set_pointerEnabled:"set_pointerEnabled",set_visible:"set_visible",get_pointerOut:"get_pointerOut",get_pointerIn:"get_pointerIn",get_pointerUp:"get_pointerUp",get_pointerMove:"get_pointerMove",get_pointerDown:"get_pointerDown"})});var fa=function(a){this._emitElapsed=this._totalElapsed=0;this.enabled=!0;
this.numParticles=0;M.call(this);this.texture=a.texture;this.blendMode=a.blendMode;this.type=a.type;this.alphaEnd=new C(a.alphaEnd);this.alphaEndVariance=new C(a.alphaEndVariance);this.alphaStart=new C(a.alphaStart);this.alphaStartVariance=new C(a.alphaStartVariance);this.angle=new C(a.angle);this.angleVariance=new C(a.angleVariance);this.duration=a.duration;this.emitXVariance=new C(a.emitXVariance);this.emitYVariance=new C(a.emitYVariance);this.gravityX=new C(a.gravityX);this.gravityY=new C(a.gravityY);
this.maxRadius=new C(a.maxRadius);this.maxRadiusVariance=new C(a.maxRadiusVariance);this.minRadius=new C(a.minRadius);this.lifespan=new C(a.lifespan);this.lifespanVariance=new C(a.lifespanVariance);this.radialAccel=new C(a.radialAccel);this.radialAccelVariance=new C(a.radialAccelVariance);this.rotatePerSecond=new C(a.rotatePerSecond);this.rotatePerSecondVariance=new C(a.rotatePerSecondVariance);this.rotationEnd=new C(a.rotationEnd);this.rotationEndVariance=new C(a.rotationEndVariance);this.rotationStart=
new C(a.rotationStart);this.rotationStartVariance=new C(a.rotationStartVariance);this.sizeEnd=new C(a.sizeEnd);this.sizeEndVariance=new C(a.sizeEndVariance);this.sizeStart=new C(a.sizeStart);this.sizeStartVariance=new C(a.sizeStartVariance);this.speed=new C(a.speed);this.speedVariance=new C(a.speedVariance);this.tangentialAccel=new C(a.tangentialAccel);this.tangentialAccelVariance=new C(a.tangentialAccelVariance);this.emitX=new C(0);this.emitY=new C(0);this._particles=Array(a.maxParticles);for(var a=
0,b=this._particles.length;a<b;)this._particles[a]=new Se,++a};fa.__name__=!0;fa.random=function(a,b){0!=b&&(a+=b*(2*Math.random()-1));return a};fa.__super__=M;fa.prototype=y(M.prototype,{onUpdate:function(a){M.prototype.onUpdate.call(this,a);this.alphaEnd.update(a);this.alphaEndVariance.update(a);this.alphaStart.update(a);this.alphaStartVariance.update(a);this.angle.update(a);this.angleVariance.update(a);this.emitX.update(a);this.emitXVariance.update(a);this.emitY.update(a);this.emitYVariance.update(a);
this.gravityX.update(a);this.gravityY.update(a);this.lifespan.update(a);this.lifespanVariance.update(a);this.maxRadius.update(a);this.maxRadiusVariance.update(a);this.minRadius.update(a);this.radialAccel.update(a);this.radialAccelVariance.update(a);this.rotatePerSecond.update(a);this.rotatePerSecondVariance.update(a);this.rotationEnd.update(a);this.rotationEndVariance.update(a);this.rotationStart.update(a);this.rotationStartVariance.update(a);this.sizeEnd.update(a);this.sizeEndVariance.update(a);
this.sizeStart.update(a);this.sizeStartVariance.update(a);this.speed.update(a);this.speedVariance.update(a);this.tangentialAccel.update(a);this.tangentialAccelVariance.update(a);for(var b=this.type==xc.Gravity,c=0;c<this.numParticles;){var d=this._particles[c];if(d.life>a){if(b){d.x+=d.velX*a;d.y+=d.velY*a;var e=this.gravityX._value,f=-this.gravityY._value;if(0!=d.radialAccel||0!=d.tangentialAccel)var h=d.x-d.emitX,i=d.y-d.emitY,k=Math.sqrt(h*h+i*i),h=h/k,i=i/k,e=e+h*d.radialAccel,f=f+i*d.radialAccel,
k=h,e=e+-i*d.tangentialAccel,f=f+k*d.tangentialAccel;d.velX+=e*a;d.velY+=f*a}else d.radialRotation+=d.velRadialRotation*a,d.radialRadius+=d.velRadialRadius*a,e=d.radialRadius,d.x=this.emitX._value-Math.cos(d.radialRotation)*e,d.y=this.emitY._value-Math.sin(d.radialRotation)*e,e<this.minRadius._value&&(d.life=0);d.scale+=d.velScale*a;d.rotation+=d.velRotation*a;d.alpha+=d.velAlpha*a;d.life-=a;++c}else--this.numParticles,c!=this.numParticles&&(this._particles[c]=this._particles[this.numParticles],this._particles[this.numParticles]=
d)}if(this.enabled){if(0<this.duration&&(this._totalElapsed+=a,this._totalElapsed>=this.duration)){this.enabled=!1;return}b=this.lifespan._value/this._particles.length;for(this._emitElapsed+=a;this._emitElapsed>=b;)this.numParticles<this._particles.length&&this.initParticle(this._particles[this.numParticles])&&++this.numParticles,this._emitElapsed-=b}},draw:function(a){for(var b=-this.texture.get_width()/2,c=0,d=this.numParticles;c<d;){var e=this._particles[c];a.save();a.translate(e.x,e.y);1>e.alpha&&
a.multiplyAlpha(e.alpha);0!=e.rotation&&a.rotate(e.rotation);1!=e.scale&&a.scale(e.scale,e.scale);a.drawTexture(this.texture,b,b);a.restore();++c}},initParticle:function(a){a.life=fa.random(this.lifespan._value,this.lifespanVariance._value);if(0>=a.life)return!1;a.emitX=this.emitX._value;a.emitY=this.emitY._value;var b=-hc.toRadians(fa.random(this.angle._value,this.angleVariance._value)),c=fa.random(this.speed._value,this.speedVariance._value);a.velX=c*Math.cos(b);a.velY=c*Math.sin(b);a.radialAccel=
fa.random(this.radialAccel._value,this.radialAccelVariance._value);a.tangentialAccel=fa.random(this.tangentialAccel._value,this.tangentialAccelVariance._value);a.radialRadius=fa.random(this.maxRadius._value,this.maxRadiusVariance._value);a.velRadialRadius=-a.radialRadius/a.life;a.radialRotation=b;a.velRadialRotation=hc.toRadians(fa.random(this.rotatePerSecond._value,this.rotatePerSecondVariance._value));this.type==xc.Gravity?(a.x=fa.random(this.emitX._value,this.emitXVariance._value),a.y=fa.random(this.emitY._value,
this.emitYVariance._value)):(b=a.radialRadius,a.x=this.emitX._value-Math.cos(a.radialRotation)*b,a.y=this.emitY._value-Math.sin(a.radialRotation)*b);c=this.texture.get_width();b=fa.random(this.sizeStart._value,this.sizeStartVariance._value)/c;c=fa.random(this.sizeEnd._value,this.sizeEndVariance._value)/c;a.scale=b;a.velScale=(c-b)/a.life;b=fa.random(this.rotationStart._value,this.rotationStartVariance._value);c=fa.random(this.rotationEnd._value,this.rotationEndVariance._value);a.rotation=b;a.velRotation=
(c-b)/a.life;b=fa.random(this.alphaStart._value,this.alphaStartVariance._value);c=fa.random(this.alphaEnd._value,this.alphaEndVariance._value);a.alpha=b;a.velAlpha=(c-b)/a.life;return!0},__class__:fa});var Se=function(){this.emitX=this.emitY=this.x=this.velX=this.y=this.velY=this.radialRadius=this.velRadialRadius=this.radialRotation=this.velRadialRotation=this.radialAccel=this.tangentialAccel=this.scale=this.velScale=this.rotation=this.velRotation=this.alpha=this.velAlpha=this.life=0};Se.__name__=
!0;Se.prototype={__class__:Se};var $d=function(a,b,c){M.call(this);this.color=a;this.width=new C(b);this.height=new C(c)};$d.__name__=!0;$d.__super__=M;$d.prototype=y(M.prototype,{draw:function(a){a.fillRect(this.color,0,0,this.width._value,this.height._value)},getNaturalWidth:function(){return this.width._value},getNaturalHeight:function(){return this.height._value},setSize:function(a,b){this.width.set__(a);this.height.set__(b);return this},onUpdate:function(a){M.prototype.onUpdate.call(this,a);
this.width.update(a);this.height.update(a)},__class__:$d});var jd=function(a){this._kernings=null;this.xOffset=this.yOffset=this.xAdvance=0;this.page=null;this.x=this.y=this.width=this.height=0;this.charCode=a};jd.__name__=!0;jd.prototype={draw:function(a,b,c){0<this.width&&a.drawSubTexture(this.page,b+this.xOffset,c+this.yOffset,this.x,this.y,this.width,this.height)},getKerning:function(a){return null!=this._kernings?B["int"](this._kernings.get(a)):0},setKerning:function(a,b){null==this._kernings&&
(this._kernings=new Ia);this._kernings.set(a,b)},__class__:jd};var xb=function(a,b){this.name=b;this._pack=a;this._file=a.getFile(b+".fnt");this.reload()};xb.__name__=!0;xb.prototype={layoutText:function(a,b,c,d,e){null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=yb.Left);return new Ob(this,a,b,c,d,e)},reload:function(){this._glyphs=new Ia;this._glyphs.set(xb.NEWLINE.charCode,xb.NEWLINE);for(var a=new yc(this._file.toString()),b=new Ia,c=this.name.lastIndexOf("/"),c=0<=c?F.substr(this.name,
0,c+1):"",d=a.keywords();d.hasNext();)switch(d.next()){case "info":for(var e=a.pairs();e.hasNext();){var f=e.next();switch(f.key){case "size":this.size=f.getInt()}}break;case "common":for(e=a.pairs();e.hasNext();)switch(f=e.next(),f.key){case "lineHeight":this.lineHeight=f.getInt()}break;case "page":for(var e=0,f=null,h=a.pairs();h.hasNext();){var i=h.next();switch(i.key){case "id":e=i.getInt();break;case "file":f=i.getString()}}f=this._pack.getTexture(c+Sa.removeFileExtension(f));b.set(e,f);break;
case "char":e=null;for(f=a.pairs();f.hasNext();)switch(h=f.next(),h.key){case "id":e=new jd(h.getInt());break;case "x":e.x=h.getInt();break;case "y":e.y=h.getInt();break;case "width":e.width=h.getInt();break;case "height":e.height=h.getInt();break;case "page":h=h.getInt();e.page=b.get(h);break;case "xoffset":e.xOffset=h.getInt();break;case "yoffset":e.yOffset=h.getInt();break;case "xadvance":e.xAdvance=h.getInt()}this._glyphs.set(e.charCode,e);break;case "kerning":e=null;h=f=0;for(i=a.pairs();i.hasNext();){var k=
i.next();switch(k.key){case "first":e=this._glyphs.get(k.getInt());break;case "second":f=k.getInt();break;case "amount":h=k.getInt()}}null!=e&&0!=h&&e.setKerning(f,h)}},__class__:xb};var yb={__ename__:!0,__constructs__:["Left","Center","Right"],Left:["Left",0]};yb.Left.__enum__=yb;yb.Center=["Center",1];yb.Center.__enum__=yb;yb.Right=["Right",2];yb.Right.__enum__=yb;var Ob=function(a,b,c,d,e,f){this.lines=0;var h=this;this._font=a;this._glyphs=[];this._offsets=[];this._lineOffset=Math.round(a.lineHeight+
f);this.bounds=new Tc;for(var i=[],f=b.length,k=0;k<f;){var g=k++,g=b.charCodeAt(g),g=a._glyphs.get(g);null!=g?this._glyphs.push(g):null}for(var b=-1,l=0,j=0,a=a._glyphs.get(10),f=function(){h.bounds.width=hc.max(h.bounds.width,l);h.bounds.height+=j;i[h.lines]=l;j=l=0;++h.lines},k=0;k<this._glyphs.length;){g=this._glyphs[k];this._offsets[k]=Math.round(l);var m=0<d&&l+g.width>d;m||g==a?(m&&(0<=b?(this._glyphs[b]=a,l=this._offsets[b],k=b):this._glyphs.splice(k,0,a)),b=-1,j=this._lineOffset,f()):(32==
g.charCode&&(b=k),l+=g.xAdvance+e,j=hc.max(j,g.height+g.yOffset),k+1<this._glyphs.length&&(l+=g.getKerning(this._glyphs[k+1].charCode)));++k}f();e=0;a=Ob.getAlignOffset(c,i[0],d);b=1.79769313486231E308;f=-1.79769313486231E308;g=k=0;for(m=this._glyphs.length;g<m;){var L=this._glyphs[g];10==L.charCode&&(e+=this._lineOffset,++k,a=Ob.getAlignOffset(c,i[k],d));this._offsets[g]+=a;var o=e+L.yOffset;b<o||(b=o);f=hc.max(f,o+L.height);++g}this.bounds.x=Ob.getAlignOffset(c,this.bounds.width,d);this.bounds.y=
b;this.bounds.height=f-b};Ob.__name__=!0;Ob.getAlignOffset=function(a,b,c){switch(a[1]){case 0:return 0;case 2:return c-b;case 1:return Math.round((c-b)/2)}};Ob.prototype={draw:function(a){for(var b=0,c=0,d=this._glyphs.length;c<d;){var e=this._glyphs[c];10==e.charCode?b+=this._lineOffset:e.draw(a,this._offsets[c],b);++c}},__class__:Ob};var yc=function(a){this._configText=a;this._keywordPattern=new Ya("([A-Za-z]+)(.*)","");this._pairPattern=new Ya('([A-Za-z]+)=("[^"]*"|[^\\s]+)',"")};yc.__name__=
!0;yc.advance=function(a,b){var c=b.matchedPos();return F.substr(a,c.pos+c.len,a.length)};yc.prototype={keywords:function(){var a=this,b=this._configText;return{next:function(){b=yc.advance(b,a._keywordPattern);a._pairText=a._keywordPattern.matched(2);return a._keywordPattern.matched(1)},hasNext:function(){return a._keywordPattern.match(b)}}},pairs:function(){var a=this,b=this._pairText;return{next:function(){b=yc.advance(b,a._pairPattern);return new Te(a._pairPattern.matched(1),a._pairPattern.matched(2))},
hasNext:function(){return a._pairPattern.match(b)}}},__class__:yc};var Te=function(a,b){this.key=a;this._value=b};Te.__name__=!0;Te.prototype={getInt:function(){return B.parseInt(this._value)},getString:function(){return 34!=this._value.charCodeAt(0)?null:F.substr(this._value,1,this._value.length-2)},__class__:Te};var Ue=function(){};Ue.__name__=!0;Ue.prototype={__class__:Ue};var ic=function(a){M.call(this);this.texture=a};ic.__name__=!0;ic.__super__=M;ic.prototype=y(M.prototype,{draw:function(a){null!=
this.texture&&a.drawTexture(this.texture,0,0)},getNaturalWidth:function(){return null!=this.texture?this.texture.get_width():0},getNaturalHeight:function(){return null!=this.texture?this.texture.get_height():0},__class__:ic});var Ma={__ename__:!0,__constructs__:["Portrait","Landscape"],Portrait:["Portrait",0]};Ma.Portrait.__enum__=Ma;Ma.Landscape=["Landscape",1];Ma.Landscape.__enum__=Ma;var Uc=function(){};Uc.__name__=!0;Uc.__interfaces__=[gc];Uc.prototype={__class__:Uc};var Xf=function(){};Xf.__name__=
!0;Xf.__interfaces__=[Uc];var ae=function(a,b){null==b&&(b="");this._layout=null;var c=this;M.call(this);this._font=a;this._text=b;this._align=yb.Left;this._flags|=128;var d=function(){c._flags|=128};this.wrapWidth=new C(0,d);this.letterSpacing=new C(0,d);this.lineSpacing=new C(0,d)};ae.__name__=!0;ae.__super__=M;ae.prototype=y(M.prototype,{draw:function(a){this.updateLayout();this._layout.draw(a)},getNaturalWidth:function(){this.updateLayout();return 0<this.wrapWidth._value?this.wrapWidth._value:
this._layout.bounds.width},getNaturalHeight:function(){this.updateLayout();var a=this._layout.lines*(this._font.lineHeight+this.lineSpacing._value),b=this._layout.bounds.height;return a>b?a:b},containsLocal:function(a,b){this.updateLayout();return this._layout.bounds.contains(a,b)},setWrapWidth:function(a){this.wrapWidth.set__(a);return this},setAlign:function(a){this.set_align(a);return this},set_font:function(a){a!=this._font&&(this._font=a,this._flags|=128);return a},set_align:function(a){a!=this._align&&
(this._align=a,this._flags|=128);return a},updateLayout:function(){0!=(this._flags&128)&&(this._flags&=-129,this._layout=this._font.layoutText(this._text,this._align,this.wrapWidth._value,this.letterSpacing._value,this.lineSpacing._value))},onUpdate:function(a){M.prototype.onUpdate.call(this,a);this.wrapWidth.update(a);this.letterSpacing.update(a);this.lineSpacing.update(a)},__class__:ae,__properties__:y(M.prototype.__properties__,{set_align:"set_align",set_font:"set_font"})});var ra={__ename__:!0,
__constructs__:["Left","Middle","Right","Unknown"],Left:["Left",0]};ra.Left.__enum__=ra;ra.Middle=["Middle",1];ra.Middle.__enum__=ra;ra.Right=["Right",2];ra.Right.__enum__=ra;ra.Unknown=function(a){a=["Unknown",3,a];a.__enum__=ra;return a};var Ja={__ename__:!0,__constructs__:["Default","Button","None"],Default:["Default",0]};Ja.Default.__enum__=Ja;Ja.Button=["Button",1];Ja.Button.__enum__=Ja;Ja.None=["None",2];Ja.None.__enum__=Ja;var Ve=function(){this.init(0,0,0,null)};Ve.__name__=!0;Ve.prototype=
{init:function(a,b,c,d){this.id=a;this.viewX=b;this.viewY=c;this.button=d},__class__:Ve};var zc={__ename__:!0,__constructs__:["Mouse","Touch"]};zc.Mouse=function(a){a=["Mouse",0,a];a.__enum__=zc;return a};zc.Touch=function(a){a=["Touch",1,a];a.__enum__=zc;return a};var We=function(){this.init(0,0,0,null,null)};We.__name__=!0;We.prototype={init:function(a,b,c,d,e){this.id=a;this.viewX=b;this.viewY=c;this.hit=d;this.source=e;this._stopped=!1},__class__:We};var Xe=function(a){this.id=a;this._source=
zc.Touch(this)};Xe.__name__=!0;Xe.prototype={init:function(a,b){this.viewX=a;this.viewY=b},__class__:Xe};var hc=function(){};hc.__name__=!0;hc.toRadians=function(a){return 3.141592653589793*a/180};hc.max=function(a,b){return a>b?a:b};var Qe=function(){this.identity()};Qe.__name__=!0;Qe.prototype={set:function(a,b,c,d,e,f){this.m00=a;this.m01=c;this.m02=e;this.m10=b;this.m11=d;this.m12=f},identity:function(){this.set(1,0,0,1,0,0)},compose:function(a,b,c,d,e){var f=Math.sin(e),e=Math.cos(e);this.set(e*
c,f*c,-f*d,e*d,a,b)},translate:function(a,b){this.m02+=this.m00*a+this.m01*b;this.m12+=this.m11*b+this.m10*a},determinant:function(){return this.m00*this.m11-this.m01*this.m10},inverseTransform:function(a,b,c){var d=this.determinant();if(0==d)return!1;a-=this.m02;b-=this.m12;c.x=(a*this.m11-b*this.m01)/d;c.y=(b*this.m00-a*this.m10)/d;return!0},__class__:Qe};var Tc=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.set(a,b,c,d)};Tc.__name__=!0;Tc.prototype={set:function(a,
b,c,d){this.x=a;this.y=b;this.width=c;this.height=d},contains:function(a,b){a-=this.x;if(0<=this.width){if(0>a||a>this.width)return!1}else if(0<a||a<this.width)return!1;b-=this.y;if(0<=this.height){if(0>b||b>this.height)return!1}else if(0<b||b<this.height)return!1;return!0},__class__:Tc};var sa=function(){this._disposed=!1};sa.__name__=!0;sa.__interfaces__=[gc];sa.prototype={dispose:function(){this._disposed||(this._disposed=!0,this.onDisposed())},onDisposed:function(){null},__class__:sa};var db=
function(a,b){var c=this;this.manifest=b;this._platform=a;this.promise=new be;this._bytesLoaded=new Za;this._pack=new ce(b,this);var d=Ud.array(b);if(0==d.length)this.handleSuccess();else{for(var e=new Za,f=0;f<d.length;){var h=d[f];++f;var i=e.get(h.name);null==i&&(i=[],e.set(h.name,i));i.push(h)}this._assetsRemaining=Ud.count(e);for(d=e.iterator();d.hasNext();)e=[d.next()],this.pickBestEntry(e[0],function(a){return function(d){if(null!=d){var e=b.getFullURL(d);try{c.loadEntry(e,d)}catch(f){c.handleError(d,
"Unexpected error: "+B.string(f))}e=c.promise;e.set_total(e._total+d.bytes)}else d=a[0][0],db.isAudio(d.format)?c.handleLoad(d,$a.getInstance()):c.handleError(d,"Could not find a supported format to load")}}(e))}};db.__name__=!0;db.isAudio=function(a){switch(a[1]){case 8:case 9:case 10:case 11:case 12:return!0;default:return!1}};db.prototype={onDisposed:function(){},pickBestEntry:function(a,b){this.getAssetFormats(function(c){for(var d=0;d<c.length;){var e=c[d];++d;for(var f=0;f<a.length;){var h=
a[f];++f;if(h.format==e){b(h);return}}}b(null)})},loadEntry:function(){null},getAssetFormats:function(){null},handleLoad:function(a,b){if(!this._pack.disposed){this.handleProgress(a,a.bytes);var c;switch(a.format[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c=this._pack.textures;break;case 8:case 9:case 10:case 11:case 12:c=this._pack.sounds;break;case 13:c=this._pack.files}c.set(a.name,b);this._assetsRemaining-=1;0==this._assetsRemaining&&this.handleSuccess()}},handleProgress:function(a,
b){this._bytesLoaded.set(a.name,b);for(var c=0,d=this._bytesLoaded.iterator();d.hasNext();)var e=d.next(),c=c+e;this.promise.set_progress(c)},handleSuccess:function(){this.promise.set_result(this._pack)},handleError:function(a,b){this.promise.error.emit(Sa.withFields(b,["url",a.url]))},handleTextureError:function(a){this.handleError(a,"Failed to create texture. Is the GPU context unavailable?")},__class__:db};var ce=function(a,b){this.disposed=!1;this._manifest=a;this.loader=b;this.textures=new Za;
this.sounds=new Za;this.files=new Za};ce.__name__=!0;ce.__interfaces__=[Ed];ce.prototype={getTexture:function(a,b){null==b&&(b=!0);var c=this.textures.get(a);if(null==c&&b)throw Sa.withFields("Missing texture",["name",a]);return c},getSound:function(a,b){null==b&&(b=!0);var c=this.sounds.get(a);if(null==c&&b)throw Sa.withFields("Missing sound",["name",a]);return c},getFile:function(a,b){null==b&&(b=!0);var c=this.files.get(a);if(null==c&&b)throw Sa.withFields("Missing file",["name",a]);return c},
dispose:function(){if(!this.disposed){this.disposed=!0;for(var a=this.textures.iterator();a.hasNext();)a.next().dispose();this.textures=null;for(a=this.sounds.iterator();a.hasNext();)a.next().dispose();this.sounds=null;for(a=this.files.iterator();a.hasNext();)a.next().dispose();this.files=null;this.loader.onDisposed()}},__class__:ce};var kd=function(a){this._disposed=!1;this._content=a};kd.__name__=!0;kd.__interfaces__=[Zd];kd.__super__=sa;kd.prototype=y(sa.prototype,{toString:function(){return this._content},
onDisposed:function(){this._content=null},__class__:kd});var Ye=function(){};Ye.__name__=!0;Ye.prototype={__class__:Ye};var ta=function(a){this._pointer=a;this._source=zc.Mouse(ta._sharedEvent);this.down=new Y;this.move=new Y;this.up=new Y;this.scroll=new Y;this._y=this._x=0;this._cursor=Ja.Default;this._buttonStates=new Ia};ta.__name__=!0;ta.__interfaces__=[Ye];ta.prototype={set_cursor:function(a){return this._cursor=a},submitDown:function(a,b,c){this._buttonStates.exists(c)||(this._buttonStates.set(c,
!0),this.prepare(a,b,Ze.toButton(c)),this._pointer.submitDown(a,b,this._source),this.down.emit(ta._sharedEvent))},submitMove:function(a,b){this.prepare(a,b,null);this._pointer.submitMove(a,b,this._source);this.move.emit(ta._sharedEvent)},submitUp:function(a,b,c){this._buttonStates.exists(c)&&(this._buttonStates.remove(c),this.prepare(a,b,Ze.toButton(c)),this._pointer.submitUp(a,b,this._source),this.up.emit(ta._sharedEvent))},submitScroll:function(a,b,c){this._x=a;this._y=b;if(null==this.scroll._head)return!1;
this.scroll.emit(c);return!0},prepare:function(a,b,c){this._x=a;this._y=b;ta._sharedEvent.init(ta._sharedEvent.id+1,a,b,c)},__class__:ta,__properties__:{set_cursor:"set_cursor"}};var $e=function(){};$e.__name__=!0;$e.prototype={__class__:$e};var ia=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);this.down=new Y;this.move=new Y;this.up=new Y;this._x=a;this._y=b;this._isDown=c};ia.__name__=!0;ia.__interfaces__=[$e];ia.prototype={get_x:function(){return this._x},get_y:function(){return this._y},
isDown:function(){return this._isDown},submitDown:function(a,b,c){if(!this._isDown){this.submitMove(a,b,c);this._isDown=!0;var d=[],e=M.hitTest(u.root,a,b);if(null!=e){var f=e.owner;do{var h=f._compMap.Sprite_1;null!=h&&d.push(h);f=f.parent}while(null!=f)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerDown(ia._sharedEvent),ia._sharedEvent._stopped)return;this.down.emit(ia._sharedEvent)}},submitMove:function(a,b,c){if(!(a==this._x&&b==this._y)){var d=[],e=M.hitTest(u.root,a,b);
if(null!=e){var f=e.owner;do{var h=f._compMap.Sprite_1;null!=h&&d.push(h);f=f.parent}while(null!=f)}this.prepare(a,b,e,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerMove(ia._sharedEvent),ia._sharedEvent._stopped)return;this.move.emit(ia._sharedEvent)}},submitUp:function(a,b,c){if(this._isDown){this.submitMove(a,b,c);this._isDown=!1;var d=[],e=M.hitTest(u.root,a,b);if(null!=e){var f=e.owner;do{var h=f._compMap.Sprite_1;null!=h&&d.push(h);f=f.parent}while(null!=f)}this.prepare(a,b,e,c);for(a=0;a<
d.length;)if(b=d[a],++a,b.onPointerUp(ia._sharedEvent),ia._sharedEvent._stopped)return;this.up.emit(ia._sharedEvent)}},prepare:function(a,b,c,d){this._x=a;this._y=b;ia._sharedEvent.init(ia._sharedEvent.id+1,a,b,c,d)},__class__:ia,__properties__:{get_y:"get_y",get_x:"get_x"}};var Ac=function(a,b,c){this._x=this._y=0;this._parent=null;this.rootX=this.rootY=0;this._disposed=!1;this.root=a;this._width=b;this._height=c};Ac.__name__=!0;Ac.__interfaces__=[Xf];Ac.__super__=sa;Ac.prototype=y(sa.prototype,
{subTexture:function(a,b,c,d){c=this.root.createTexture(c,d);c._parent=this;c._x=a;c._y=b;c.rootX=this.rootX+a;c.rootY=this.rootY+b;return c},onDisposed:function(){null==this._parent&&this.root.dispose()},get_width:function(){return this._width},get_height:function(){return this._height},__class__:Ac,__properties__:{get_height:"get_height",get_width:"get_width"}});var Yf=function(){};Yf.__name__=!0;var Wd=function(a,b){null==b&&(b=4);this._pointer=a;this._maxPoints=b;this._pointMap=new Ia;this._points=
[];this.down=new Y;this.move=new Y;this.up=new Y};Wd.__name__=!0;Wd.__interfaces__=[Yf];Wd.prototype={submitDown:function(a,b,c){if(!this._pointMap.exists(a)){var d=new Xe(a);d.init(b,c);this._pointMap.set(a,d);this._points.push(d);null==this._pointerTouch&&(this._pointerTouch=d,this._pointer.submitDown(b,c,d._source));this.down.emit(d)}},submitMove:function(a,b,c){a=this._pointMap.get(a);null!=a&&(a.init(b,c),this._pointerTouch==a&&this._pointer.submitMove(b,c,a._source),this.move.emit(a))},submitUp:function(a,
b,c){var d=this._pointMap.get(a);null!=d&&(d.init(b,c),this._pointMap.remove(a),F.remove(this._points,d),this._pointerTouch==d&&(this._pointerTouch=null,this._pointer.submitUp(b,c,d._source)),this.up.emit(d))},__class__:Wd};var Bc=function(){};Bc.__name__=!0;Bc.__interfaces__=[gc];Bc.prototype={__class__:Bc};var $a=function(){this._disposed=!1;this._playback=new de(this)};$a.__name__=!0;$a.__interfaces__=[Bc];$a.getInstance=function(){null==$a._instance&&($a._instance=new $a);return $a._instance};
$a.__super__=sa;$a.prototype=y(sa.prototype,{play:function(){return this._playback},loop:function(){return this._playback},onDisposed:function(){},__class__:$a});var jc=function(){};jc.__name__=!0;jc.__interfaces__=[Ra];jc.prototype={__class__:jc};var de=function(a){this._sound=a;this.volume=new C(0);this._complete=new ea(!0)};de.__name__=!0;de.__interfaces__=[jc];de.prototype={get_sound:function(){return this._sound},set_paused:function(){return!0},dispose:function(){},__class__:de,__properties__:{get_sound:"get_sound",
set_paused:"set_paused"}};var Xd=function(){this.down=new Y;this.move=new Y;this.up=new Y};Xd.__name__=!0;Xd.__interfaces__=[Yf];Xd.prototype={__class__:Xd};var ld=function(){this._entries=[]};ld.__name__=!0;ld.__interfaces__=[Ra];ld.prototype={addListener:function(a,b,c){a.addEventListener(b,c,!1);this._entries.push(new af(a,b,c))},addDisposingListener:function(a,b,c){var d=this;this.addListener(a,b,function(a){d.dispose();c(a)})},dispose:function(){for(var a=0,b=this._entries;a<b.length;){var c=
b[a];++a;c.dispatcher.removeEventListener(c.type,c.listener,!1)}this._entries=[]},__class__:ld};var af=function(a,b,c){this.dispatcher=a;this.type=b;this.listener=c};af.__name__=!0;af.prototype={__class__:af};var md=function(){};md.__name__=!0;md.__interfaces__=[Ue];md.prototype={__class__:md};var bf=function(){};bf.__name__=!0;bf.prototype={__class__:bf};var nd=function(){};nd.__name__=!0;nd.__interfaces__=[bf];nd.prototype={__class__:nd};var uc=function(){this._tickables=[]};uc.__name__=!0;uc.updateEntity=
function(a,b){var c=a._compMap.SpeedAdjuster_15;if(null!=c&&(c._realDt=b,b*=c.scale._value,0>=b)){c.onUpdate(b);return}for(c=a.firstComponent;null!=c;){var d=c.next;0==(c._flags&1)&&(c._flags|=1,c.onStart());c.onUpdate(b);c=d}for(c=a.firstChild;null!=c;)d=c.next,uc.updateEntity(c,b),c=d};uc.prototype={update:function(a){if(!(0>=a)){1<a&&(a=1);for(var b=0;b<this._tickables.length;){var c=this._tickables[b];null==c||c.update(a)?this._tickables.splice(b,1):++b}u.volume.update(a);uc.updateEntity(u.root,
a)}},render:function(a){var b=a.graphics;null!=b&&(a.willRender(),M.render(u.root,b),a.didRender())},addTickable:function(a){this._tickables.push(a)},__class__:uc};var Ze=function(){};Ze.__name__=!0;Ze.toButton=function(a){switch(a){case 0:return ra.Left;case 1:return ra.Middle;case 2:return ra.Right}return ra.Unknown(a)};var cf=function(){};cf.__name__=!0;cf.prototype={__class__:cf};var ee=function(){};ee.__name__=!0;ee.prototype={__class__:ee};var Fd=function(a,b){this._firstDraw=!1;this._canvasCtx=
a.getContext("2d",{alpha:b})};Fd.__name__=!0;Fd.__interfaces__=[md];Fd.prototype={save:function(){this._canvasCtx.save()},translate:function(a,b){this._canvasCtx.translate(a|0,b|0)},scale:function(a,b){this._canvasCtx.scale(a,b)},rotate:function(a){this._canvasCtx.rotate(3.141592653589793*a/180)},transform:function(a,b,c,d,e,f){this._canvasCtx.transform(a,b,c,d,e,f)},restore:function(){this._canvasCtx.restore()},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},
drawSubTexture:function(a,b,c,d,e,f,h){this._firstDraw?(this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.drawSubTexture(a,b,c,d,e,f,h),this._canvasCtx.globalCompositeOperation="source-over"):this._canvasCtx.drawImage(a.root.image,a.rootX+d|0,a.rootY+e|0,f|0,h|0,b|0,c|0,f|0,h|0)},fillRect:function(a,b,c,d,e){if(this._firstDraw)this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.fillRect(a,b,c,d,e),this._canvasCtx.globalCompositeOperation="source-over";else{for(a=
(16777215&a).toString(16);6>a.length;)a="0"+B.string(a);this._canvasCtx.fillStyle="#"+B.string(a);this._canvasCtx.fillRect(b|0,c|0,d|0,e|0)}},multiplyAlpha:function(a){this._canvasCtx.globalAlpha*=a},setBlendMode:function(a){var b;switch(a[1]){case 0:b="source-over";break;case 1:b="lighter";break;case 2:b="multiply";break;case 3:b="screen";break;case 4:b="destination-in";break;case 5:b="copy"}this._canvasCtx.globalCompositeOperation=b},applyScissor:function(a,b,c,d){this._canvasCtx.beginPath();this._canvasCtx.rect(a|
0,b|0,c|0,d|0);this._canvasCtx.clip()},willRender:function(){this._firstDraw=!0},didRender:function(){},__class__:Fd};var vc=function(a){this.graphics=new Fd(a,!1);this._hasGPU=new ea(!0)};vc.__name__=!0;vc.__interfaces__=[nd];vc.prototype={get_type:function(){return Cc.Canvas},createTextureFromImage:function(a){a=new Gd(vc.CANVAS_TEXTURES?w.createCanvas(a):a);return a.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){return null},
willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},__class__:vc,__properties__:{get_type:"get_type"}};var od=function(a,b,c){Ac.call(this,a,b,c)};od.__name__=!0;od.__super__=Ac;od.prototype=y(Ac.prototype,{__class__:od});var Gd=function(a){this._graphics=null;this._disposed=!1;this.image=a;this.width=a.width;this.height=a.height};Gd.__name__=!0;Gd.__interfaces__=[cf];Gd.__super__=sa;Gd.prototype=y(sa.prototype,{createTexture:function(a,b){return new od(this,
a,b)},onDisposed:function(){this._graphics=this.image=null},__class__:Gd});var J=function(a,b){db.call(this,a,b)};J.__name__=!0;J.detectImageFormats=function(a){var b=[z.PNG,z.JPG,z.GIF],c=2,d;d=window.document.createElement("img");d.onload=d.onerror=function(){1==d.width&&b.unshift(z.WEBP);--c;0==c&&a(b)};d.src="data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==";var e;e=window.document.createElement("img");e.onload=e.onerror=function(){1==e.width&&b.unshift(z.JXR);--c;0==c&&
a(b)};e.src="data:image/vnd.ms-photo;base64,SUm8AQgAAAAFAAG8AQAQAAAASgAAAIC8BAABAAAAAQAAAIG8BAABAAAAAQAAAMC8BAABAAAAWgAAAMG8BAABAAAAHwAAAAAAAAAkw91vA07+S7GFPXd2jckNV01QSE9UTwAZAYBxAAAAABP/gAAEb/8AAQAAAQAAAA=="};J.detectAudioFormats=function(){var a;a=window.document.createElement("audio");if(null==a||null==G(a,a.canPlayType))return[];var b=new Ya("\\b(iPhone|iPod|iPad|Android|Windows Phone)\\b",""),c=window.navigator.userAgent;if(!P.get_supported()&&b.match(c))return[];for(var b=[{format:z.M4A,mimeType:"audio/mp4; codecs=mp4a"},
{format:z.MP3,mimeType:"audio/mpeg"},{format:z.OPUS,mimeType:"audio/ogg; codecs=opus"},{format:z.OGG,mimeType:"audio/ogg; codecs=vorbis"},{format:z.WAV,mimeType:"audio/wav"}],c=[],d=0;d<b.length;){var e=b[d];++d;var f="";try{f=a.canPlayType(e.mimeType)}catch(h){}""!=f&&c.push(e.format)}return c};J.supportsBlob=function(){if(J._detectBlobSupport){J._detectBlobSupport=!1;if((new Ya("\\bSilk\\b","")).match(window.navigator.userAgent)||null==window.Blob)return!1;var a=new XMLHttpRequest;a.open("GET",
".",!0);if(""!=a.responseType)return!1;a.responseType="blob";if("blob"!=a.responseType)return!1;J._URL=w.loadExtension("URL").value}return null!=J._URL&&null!=J._URL.createObjectURL};J.__super__=db;J.prototype=y(db.prototype,{loadEntry:function(a,b){var c=this;switch(b.format[1]){case 0:case 1:case 2:case 3:case 4:var d;d=window.document.createElement("img");var e=new ld;e.addDisposingListener(d,"load",function(){J.supportsBlob()&&J._URL.revokeObjectURL(d.src);var a=c._platform.getRenderer().createTextureFromImage(d);
null!=a?c.handleLoad(b,a):c.handleTextureError(b)});e.addDisposingListener(d,"error",function(){c.handleError(b,"Failed to load image")});J.supportsBlob()?this.download(a,b,"blob",function(a){d.src=J._URL.createObjectURL(a)}):d.src=a;break;case 5:case 6:case 7:this.download(a,b,"arraybuffer",function(){var a=c._platform.getRenderer().createCompressedTexture(b.format,null);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});break;case 8:case 9:case 10:case 11:case 12:if(P.get_supported())this.download(a,
b,"arraybuffer",function(a){P.ctx.decodeAudioData(a,function(a){c.handleLoad(b,new P(a))},function(){c.handleLoad(b,$a.getInstance())})});else{var f;f=window.document.createElement("audio");f.preload="auto";var h=++J._mediaRefCount;null==J._mediaElements&&(J._mediaElements=new Ia);J._mediaElements.set(h,f);e=new ld;e.addDisposingListener(f,"canplaythrough",function(){J._mediaElements.remove(h);c.handleLoad(b,new Hd(f))});e.addDisposingListener(f,"error",function(){J._mediaElements.remove(h);var a=
f.error.code;3==a||4==a?c.handleLoad(b,$a.getInstance()):c.handleError(b,"Failed to load audio: "+f.error.code)});e.addListener(f,"progress",function(){if(0<f.buffered.length&&0<f.duration){var a=f.buffered.end(0)/f.duration;c.handleProgress(b,a*b.bytes|0)}});f.src=a;f.load()}break;case 13:this.download(a,b,"text",function(a){c.handleLoad(b,new kd(a))})}},getAssetFormats:function(a){var b=this;null==J._supportedFormats&&(J._supportedFormats=new be,J.detectImageFormats(function(a){J._supportedFormats.set_result(b._platform.getRenderer().getCompressedTextureFormats().concat(a).concat(J.detectAudioFormats()).concat([z.Data]))}));
J._supportedFormats.get(a)},download:function(a,b,c,d){var e=this,f=null,h=null,i=0,g=!1,n=function(){g&&(g=!1,window.clearInterval(i))},l=3,j=function(){--l;return 0<=l?(h(),!0):!1},h=function(){n();null!=f&&f.abort();f=new XMLHttpRequest;f.open("GET",a,!0);f.responseType=c;var h=0;f.onprogress=function(a){g||(g=!0,i=window.setInterval(function(){4!=f.readyState&&5E3<Date.now()-h&&!j()&&(n(),e.handleError(b,"Download stalled"))},1E3));h=Date.now();e.handleProgress(b,a.loaded)};f.onerror=function(){if(0!=
f.status||!j())n(),e.handleError(b,"HTTP error "+f.status)};f.onload=function(){var a=f.response;null==a&&(a=f.responseText);n();d(a)};f.send()};h()},__class__:J});var df=function(){};df.__name__=!0;df.prototype={__class__:df};var me=function(){};me.__name__=!0;me.__interfaces__=[df];me.prototype={call:function(a,b){null==b&&(b=[]);for(var c=window,d=c,e=0,f=a.split(".");e<f.length;){var h=f[e];++e;c=d;d=ma.field(c,h)}return d.apply(c,b)},__class__:me};var id=function(a,b){ta.call(this,a);this._canvas=
b};id.__name__=!0;id.__super__=ta;id.prototype=y(ta.prototype,{set_cursor:function(a){var b;switch(a[1]){case 0:b="";break;case 1:b="pointer";break;case 2:b="none"}this._canvas.style.cursor=b;return ta.prototype.set_cursor.call(this,a)},__class__:id});var Hd=function(a){this._disposed=!1;this.audioElement=a};Hd.__name__=!0;Hd.__interfaces__=[Bc];Hd.__super__=sa;Hd.prototype=y(sa.prototype,{play:function(a){null==a&&(a=1);return new Id(this,a,!1)},loop:function(a){null==a&&(a=1);return new Id(this,
a,!0)},onDisposed:function(){this.audioElement=null},__class__:Hd});var Id=function(a,b,c){var d=this;this._sound=a;this._tickableAdded=!1;this._clonedElement=window.document.createElement("audio");this._clonedElement.loop=c;this._clonedElement.src=a.audioElement.src;this.volume=new C(b,function(){d.updateVolume()});this.updateVolume();this._complete=new ea(!1);this.playAudio();u.hidden._value&&this.set_paused(!0)};Id.__name__=!0;Id.__interfaces__=[ee,jc];Id.prototype={get_sound:function(){return this._sound},
set_paused:function(a){this._clonedElement.paused!=a&&(a?this._clonedElement.pause():this.playAudio());return a},update:function(a){this.volume.update(a);this._complete.set__(this._clonedElement.ended);return this._complete._value||this._clonedElement.paused?(this._tickableAdded=!1,this._volumeBinding.dispose(),this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);this._complete.set__(!0)},playAudio:function(){var a=this;this._clonedElement.play();this._tickableAdded||(Nb.instance.mainLoop.addTickable(this),
this._tickableAdded=!0,this._volumeBinding=u.volume.get_changed().connect(function(){a.updateVolume()}),this._hideBinding=u.hidden.get_changed().connect(function(b){b?(a._wasPaused=a._clonedElement.paused,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},updateVolume:function(){this._clonedElement.volume=u.volume._value*this.volume._value},__class__:Id,__properties__:{get_sound:"get_sound",set_paused:"set_paused"}};var ef=function(){};ef.__name__=!0;ef.prototype={__class__:ef};var hd=function(a){var b=
this;this._canvas=a;this.resize=new kc;this.scaleFactor=hd.computeScaleFactor();1!=this.scaleFactor&&(w.setVendorStyle(this._canvas,"transform-origin","top left"),w.setVendorStyle(this._canvas,"transform","scale("+1/this.scaleFactor+")"));w.SHOULD_HIDE_MOBILE_BROWSER&&(window.addEventListener("orientationchange",function(){w.callLater(G(b,b.hideMobileBrowser),200)},!1),this.hideMobileBrowser());window.addEventListener("resize",G(this,this.onWindowResize),!1);this.onWindowResize(null);this.orientation=
new ea(null);null!=window.orientation&&(window.addEventListener("orientationchange",G(this,this.onOrientationChange),!1),this.onOrientationChange(null));this.fullscreen=new ea(!1);w.addVendorListener(window.document,"fullscreenchange",function(){b.updateFullscreen()},!1);this.updateFullscreen()};hd.__name__=!0;hd.__interfaces__=[ef];hd.computeScaleFactor=function(){var a=window.devicePixelRatio;null==a&&(a=1);var b=window.document.createElement("canvas").getContext("2d"),b=w.loadExtension("backingStorePixelRatio",
b).value;null==b&&(b=1);a/=b;b=window.screen.height;return 2136<a*window.screen.width||2136<a*b?1:a};hd.prototype={get_width:function(){return this._canvas.width},get_height:function(){return this._canvas.height},lockOrientation:function(a){var b=w.loadExtension("lockOrientation",window.screen).value;if(null!=b){var c;switch(a[1]){case 0:c="portrait";break;case 1:c="landscape"}b.apply(window.screen,[c])||null}},requestFullscreen:function(a){null==a&&(a=!0);if(a){var a=window.document.documentElement,
b=w.loadFirstExtension(["requestFullscreen","requestFullScreen"],a).value;null!=b&&b.apply(a,[])}else a=w.loadFirstExtension(["cancelFullscreen","cancelFullScreen"],window.document).value,null!=a&&ma.callMethod(window.document,a,[])},onWindowResize:function(){var a=this._canvas.parentElement.getBoundingClientRect();this.resizeCanvas(a.width,a.height)},resizeCanvas:function(a,b){var c=this.scaleFactor*a,d=this.scaleFactor*b;if(this._canvas.width==c&&this._canvas.height==d)return!1;this._canvas.width=
c|0;this._canvas.height=d|0;this.resize.emit();return!0},hideMobileBrowser:function(){var a=this,b=window.document.documentElement.style;b.height=window.innerHeight+100+"px";b.width=window.innerWidth+"px";b.overflow="visible";w.callLater(function(){w.hideMobileBrowser();w.callLater(function(){b.height=window.innerHeight+"px";a.onWindowResize(null)},100)})},onOrientationChange:function(){this.orientation.set__(w.orientation(window.orientation))},updateFullscreen:function(){this.fullscreen.set__(!0==
w.loadFirstExtension(["fullscreen","fullScreen","isFullScreen"],window.document).value)},__class__:hd,__properties__:{get_height:"get_height",get_width:"get_width"}};var w=function(){};w.__name__=!0;w.callLater=function(a,b){null==b&&(b=0);window.setTimeout(a,b)};w.hideMobileBrowser=function(){window.scrollTo(1,0)};w.loadExtension=function(a,b){null==b&&(b=window);var c=ma.field(b,a);if(null!=c)return{prefix:"",field:a,value:c};for(var c=a.charAt(0).toUpperCase()+F.substr(a,1,null),d=0,e=w.VENDOR_PREFIXES;d<
e.length;){var f=e[d];++d;var h=f+c,i=ma.field(b,h);if(null!=i)return{prefix:f,field:h,value:i}}return{prefix:null,field:null,value:null}};w.loadFirstExtension=function(a,b){for(var c=0;c<a.length;){var d=a[c];++c;d=w.loadExtension(d,b);if(null!=d.field)return d}return{prefix:null,field:null,value:null}};w.polyfill=function(a,b){null==b&&(b=window);var c=w.loadExtension(a,b).value;if(null==c)return!1;b[a]=c;return!0};w.setVendorStyle=function(a,b,c){for(var a=a.style,d=0,e=w.VENDOR_PREFIXES;d<e.length;){var f=
e[d];++d;a.setProperty("-"+f+"-"+b,c)}a.setProperty(b,c)};w.addVendorListener=function(a,b,c,d){for(var e=0,f=w.VENDOR_PREFIXES;e<f.length;){var h=f[e];++e;a.addEventListener(h+b,c,d)}a.addEventListener(b,c,d)};w.orientation=function(a){switch(a){case -90:case 90:return Ma.Landscape;default:return Ma.Portrait}};w.createEmptyCanvas=function(a,b){var c;c=window.document.createElement("canvas");c.width=a;c.height=b;return c};w.createCanvas=function(a){var b=w.createEmptyCanvas(a.width,a.height),c=b.getContext("2d");
c.save();c.globalCompositeOperation="copy";c.drawImage(a,0,0);c.restore();return b};w.fixAndroidMath=function(){if(0<=window.navigator.userAgent.indexOf("Linux; U; Android 4")){var a=Math.sin,b=Math.cos;Math.sin=function(b){return 0==b?0:a(b)};Math.cos=function(a){return 0==a?1:b(a)}}};var ff=function(){};ff.__name__=!0;ff.prototype={__class__:ff};var Yd=function(a){this._container=a};Yd.__name__=!0;Yd.__interfaces__=[ff];Yd.prototype={openBrowser:function(a){window.open(a,"_blank")},__class__:Yd};
var P=function(a){this._disposed=!1;this.buffer=a};P.__name__=!0;P.__interfaces__=[Bc];P.__properties__={get_supported:"get_supported"};P.get_supported=function(){if(P._detectSupport){P._detectSupport=!1;var a=w.loadExtension("AudioContext").value;null!=a&&(P.ctx=new a,P.gain=P.createGain(),P.gain.connect(P.ctx.destination),u.volume.watch(function(a){P.gain.gain.value=a}))}return null!=P.ctx};P.createGain=function(){return null!=P.ctx.createGain?P.ctx.createGain():P.ctx.createGainNode()};P.start=
function(a,b){null!=a.start?a.start(b):a.noteOn(b)};P.__super__=sa;P.prototype=y(sa.prototype,{play:function(a){null==a&&(a=1);return new Jd(this,a,!1)},loop:function(a){null==a&&(a=1);return new Jd(this,a,!0)},get_duration:function(){return this.buffer.duration},onDisposed:function(){this.buffer=null},__class__:P,__properties__:{get_duration:"get_duration"}});var Jd=function(a,b,c){var d=this;this._sound=a;this._head=P.gain;this._complete=new ea(!1);this._sourceNode=P.ctx.createBufferSource();this._sourceNode.buffer=
a.buffer;this._sourceNode.loop=c;this._sourceNode.onended=function(){d._complete.set__(!0)};P.start(this._sourceNode,0);this.playAudio();this.volume=new C(b,function(a){d.setVolume(a)});1!=b&&this.setVolume(b);u.hidden._value&&this.set_paused(!0)};Jd.__name__=!0;Jd.__interfaces__=[ee,jc];Jd.prototype={get_sound:function(){return this._sound},set_paused:function(a){a!=0<=this._pausedAt&&(a?(this._sourceNode.disconnect(),this._pausedAt=this.get_position()):this.playAudio());return a},get_position:function(){return this._complete._value?
this._sound.get_duration():0<=this._pausedAt?this._pausedAt:(P.ctx.currentTime-this._startedAt)%this._sound.get_duration()},update:function(a){this.volume.update(a);3==this._sourceNode.playbackState&&this._complete.set__(!0);return this._complete._value||0<=this._pausedAt?(this._tickableAdded=!1,this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);this._complete.set__(!0)},setVolume:function(a){null==this._gainNode&&(this._gainNode=P.createGain(),this.insertNode(this._gainNode));
this._gainNode.gain.value=a},insertNode:function(a){0<=this._pausedAt||(this._sourceNode.disconnect(),this._sourceNode.connect(a));a.connect(this._head);this._head=a},playAudio:function(){var a=this;this._sourceNode.connect(this._head);this._startedAt=P.ctx.currentTime;this._pausedAt=-1;this._tickableAdded||(Nb.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._hideBinding=u.hidden.get_changed().connect(function(b){b?(a._wasPaused=0<=a._pausedAt,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},
__class__:Jd,__properties__:{get_position:"get_position",get_sound:"get_sound",set_paused:"set_paused"}};var fe=function(){this._width=this._height=-1;this._transitor=null;A.call(this);this.scenes=[];this.occludedScenes=[];this._root=new ba};fe.__name__=!0;fe.__super__=A;fe.prototype=y(A.prototype,{get_name:function(){return"Director_10"},setSize:function(a,b){this._width=a;this._height=b;return this},pushScene:function(a,b){var c=this;this.completeTransition();var d=this.get_topScene();null!=d?this.playTransition(d,
a,b,function(){c.hide(d)}):(this.add(a),this.invalidateVisibility())},unwindToScene:function(a,b){var c=this;this.completeTransition();var d=this.get_topScene();if(null!=d){if(d!=a){for(this.scenes.pop();0<this.scenes.length&&this.scenes[this.scenes.length-1]!=a;)this.scenes.pop().dispose();this.playTransition(d,a,b,function(){c.hideAndDispose(d)})}}else this.pushScene(a,b)},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this.completeTransition();for(var a=0,b=this.scenes;a<
b.length;){var c=b[a];++a;c.dispose()}this.scenes=[];this.occludedScenes=[];this._root.dispose()},onUpdate:function(a){null!=this._transitor&&this._transitor.update(a)&&this.completeTransition()},get_topScene:function(){var a=this.scenes.length;return 0<a?this.scenes[a-1]:null},add:function(a){var b=this.get_topScene();null!=b&&this._root.removeChild(b);F.remove(this.scenes,a);this.scenes.push(a);this._root.addChild(a)},hide:function(a){a=a._compMap.Scene_14;null!=a&&a.hidden.emit()},hideAndDispose:function(a){this.hide(a);
a.dispose()},show:function(a){a=a._compMap.Scene_14;null!=a&&a.shown.emit()},invalidateVisibility:function(){for(var a=this.scenes.length;0<a;){var b=this.scenes[--a]._compMap.Scene_14;if(null==b||b.opaque)break}this.occludedScenes=0<this.scenes.length?this.scenes.slice(a,this.scenes.length-1):[];a=this.get_topScene();null!=a&&this.show(a)},completeTransition:function(){null!=this._transitor&&(this._transitor.complete(),this._transitor=null,this.invalidateVisibility())},playTransition:function(a,
b,c,d){this.completeTransition();this.add(b);null!=c?(this.occludedScenes.push(a),this._transitor=new gf(a,b,c,d),this._transitor.init(this)):(d(),this.invalidateVisibility())},__class__:fe,__properties__:y(A.prototype.__properties__,{get_topScene:"get_topScene"})});var gf=function(a,b,c,d){this._from=a;this._to=b;this._transition=c;this._onComplete=d};gf.__name__=!0;gf.prototype={init:function(a){this._transition.init(a,this._from,this._to)},update:function(a){return this._transition.update(a)},
complete:function(){this._transition.complete();this._onComplete()},__class__:gf};var Kd=function(){};Kd.__name__=!0;Kd.prototype={init:function(a,b,c){this._director=a;this._from=b;this._to=c},update:function(){return!0},complete:function(){},__class__:Kd};var lc=function(a,b){this._duration=a;this._ease=null!=b?b:na.linear};lc.__name__=!0;lc.__super__=Kd;lc.prototype=y(Kd.prototype,{init:function(a,b,c){Kd.prototype.init.call(this,a,b,c);this._elapsed=0},update:function(a){this._elapsed+=a;return this._elapsed>=
this._duration},interp:function(a,b){return a+(b-a)*this._ease(this._elapsed/this._duration)},__class__:lc});var pd=function(a,b){lc.call(this,a,b)};pd.__name__=!0;pd.__super__=lc;pd.prototype=y(lc.prototype,{init:function(a,b,c){lc.prototype.init.call(this,a,b,c);a=this._to._compMap.Sprite_1;null==a&&this._to.add(a=new M);a.alpha.set__(0)},update:function(a){a=lc.prototype.update.call(this,a);this._to._compMap.Sprite_1.alpha.set__(this.interp(0,1));return a},complete:function(){this._to._compMap.Sprite_1.alpha.set__(1)},
__class__:pd});var Dc=function(a){null==a&&(a=!0);A.call(this);this.opaque=a;this.shown=new kc;this.hidden=new kc};Dc.__name__=!0;Dc.__super__=A;Dc.prototype=y(A.prototype,{get_name:function(){return"Scene_14"},__class__:Dc});var Ec=function(){};Ec.__name__=!0;Ec.prototype={__class__:Ec};var Ld=function(a,b,c,d){this._value=a;this._to=b;this._seconds=c;this._easing=d};Ld.__name__=!0;Ld.__interfaces__=[Ec];Ld.prototype={update:function(a){null==this._tween&&(this._tween=new Sc(this._value._value,this._to,
this._seconds,this._easing),this._value.set_behavior(this._tween),this._value.update(a));if(this._value._behavior!=this._tween){var b=this._tween.elapsed-this._seconds;this._tween=null;return 0<b?Math.max(0,a-b):0}return-1},__class__:Ld};var Pb=function(a){this._fn=a};Pb.__name__=!0;Pb.__interfaces__=[Ec];Pb.prototype={update:function(){this._fn();return 0},__class__:Pb};var ua=function(a){this._duration=a;this._elapsed=0};ua.__name__=!0;ua.__interfaces__=[Ec];ua.prototype={update:function(a){this._elapsed+=
a;if(this._elapsed>=this._duration){var b=this._elapsed-this._duration;this._elapsed=0;return a-b}return-1},__class__:ua};var Md=function(a){this._completedActions=[];this._runningActions=null!=a?a.slice():[]};Md.__name__=!0;Md.__interfaces__=[Ec];Md.prototype={update:function(a,b){for(var c=!0,d=0,e=0,f=this._runningActions.length;e<f;){var h=e++,i=this._runningActions[h];if(null!=i){var g=i.update(a,b);0<=g?(this._runningActions[h]=null,this._completedActions.push(i),g>d&&(d=g)):c=!1}}return c?
(this._runningActions=this._completedActions,this._completedActions=[],d):-1},__class__:Md};var ge=function(a,b){null==b&&(b=-1);this._action=a;this._remaining=this._count=b};ge.__name__=!0;ge.__interfaces__=[Ec];ge.prototype={update:function(a,b){if(0==this._count)return 0;var c=this._action.update(a,b);return 0<this._count&&0<=c&&0==--this._remaining?(this._remaining=this._count,c):-1},__class__:ge};var Fc=function(){A.call(this);this.stopAll()};Fc.__name__=!0;Fc.__super__=A;Fc.prototype=y(A.prototype,
{get_name:function(){return"Script_13"},run:function(a){a=new Nd(a);this._handles.push(a);return a},stopAll:function(){this._handles=[]},onUpdate:function(a){for(var b=0;b<this._handles.length;){var c=this._handles[b];c.removed||0<=c.action.update(a,this.owner)?this._handles.splice(b,1):++b}},__class__:Fc});var Nd=function(a){this.removed=!1;this.action=a};Nd.__name__=!0;Nd.__interfaces__=[Ra];Nd.prototype={dispose:function(){this.removed=!0;this.action=null},__class__:Nd};var qd=function(a){this._idx=
0;this._runningActions=null!=a?a.slice():[]};qd.__name__=!0;qd.__interfaces__=[Ec];qd.prototype={add:function(a){this._runningActions.push(a)},update:function(a,b){for(var c=0;;){var d=this._runningActions[this._idx];if(null!=d)if(d=d.update(a-c,b),0<=d)c+=d;else return-1;++this._idx;if(this._idx>=this._runningActions.length){this._idx=0;break}else if(c>a)return-1}return c},__class__:qd};var Cc={__ename__:!0,__constructs__:["Stage3D","WebGL","Canvas"],Stage3D:["Stage3D",0]};Cc.Stage3D.__enum__=Cc;
Cc.WebGL=["WebGL",1];Cc.WebGL.__enum__=Cc;Cc.Canvas=["Canvas",2];Cc.Canvas.__enum__=Cc;var Wf=function(){};Wf.__name__=!0;Wf.that=function(){};var Re=function(){};Re.__name__=!0;Re.set=function(a,b,c){return c?a|b:a&~b};var Od=function(){this.mainSection=new Za;this.sections=new Za};Od.__name__=!0;Od.parse=function(a){for(var b=new Od,c=new Ya("^\\s*;",""),d=new Ya("^\\s*\\[\\s*([^\\]]*)\\s*\\]",""),e=new Ya("^\\s*([\\w\\.\\-_]+)\\s*=\\s*(.*)",""),f=b.mainSection,h=0,a=(new Ya("\r\n|\r|\n","g")).split(a);h<
a.length;){var i=a[h];++h;if(!c.match(i))if(d.match(i))i=d.matched(1),b.sections.exists(i)?f=b.sections.get(i):(f=new Za,b.sections.set(i,f));else if(e.match(i)){var i=e.matched(1),g=e.matched(2),n=g.charCodeAt(0);if((34==n||39==n)&&g.charCodeAt(g.length-1)==n)g=F.substr(g,1,g.length-2);g=S.replace(S.replace(S.replace(S.replace(S.replace(S.replace(g,"\\n","\n"),"\\r","\r"),"\\t","\t"),"\\'","'"),'\\"','"'),"\\\\","\\");f.set(i,g)}}return b};Od.prototype={__class__:Od};var Vc=function(a){this.config=
a;this.missingTranslation=new Y};Vc.__name__=!0;Vc.parse=function(a){return new Vc(Od.parse(a))};Vc.prototype={__class__:Vc};var be=function(){this.success=new Y;this.error=new Y;this.progressChanged=new kc;this.hasResult=!1;this._total=this._progress=0};be.__name__=!0;be.prototype={set_result:function(a){if(this.hasResult)throw"Promise result already assigned";this._result=a;this.hasResult=!0;this.success.emit(a);return a},get:function(a){return this.hasResult?(a(this._result),null):this.success.connect(a).once()},
set_progress:function(a){this._progress!=a&&(this._progress=a,this.progressChanged.emit());return a},set_total:function(a){this._total!=a&&(this._total=a,this.progressChanged.emit());return a},__class__:be,__properties__:{set_total:"set_total",set_progress:"set_progress",set_result:"set_result"}};var kc=function(a){ca.call(this,a)};kc.__name__=!0;kc.__super__=ca;kc.prototype=y(ca.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(){var a=this;this._head==
ca.DISPATCHING_SENTINEL?this.defer(function(){a.emitImpl()}):this.emitImpl()},emitImpl:function(){for(var a=this.willEmit(),b=a;null!=b;)b._listener(),b.stayInList||b.dispose(),b=b._next;this.didEmit(a)},__class__:kc});var Le=function(a){this.next=null;this.fn=a};Le.__name__=!0;Le.prototype={__class__:Le};var Sa=function(){};Sa.__name__=!0;Sa.getFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?F.substr(a,b+1,null):null};Sa.removeFileExtension=function(a){var b=a.lastIndexOf(".");return 0<
b?F.substr(a,0,b):a};Sa.getUrlExtension=function(a){var b=a.lastIndexOf("?");0<=b&&(a=F.substr(a,0,b));b=a.lastIndexOf("/");0<=b&&(a=F.substr(a,b+1,null));return Sa.getFileExtension(a)};Sa.joinPath=function(a,b){0<a.length&&47!=a.charCodeAt(a.length-1)&&(a+="/");return a+b};Sa.withFields=function(a,b){var c=b.length;if(0<c){for(var a=0<a.length?a+" [":a+"[",d=0;d<c;){0<d&&(a+=", ");var e=b[d],f=b[d+1];if(B.is(f,Error)){var h=f.stack;null!=h&&(f=h)}a+=e+"="+B.string(f);d+=2}a+="]"}return a};var Ia=
function(){this.h={}};Ia.__name__=!0;Ia.__interfaces__=[Tf];Ia.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},__class__:Ia};var Za=function(){this.h={}};Za.__name__=!0;Za.__interfaces__=[Tf];Za.prototype={set:function(a,b){this.h["$"+a]=b},get:function(a){return this.h["$"+a]},exists:function(a){return this.h.hasOwnProperty("$"+a)},keys:function(){var a=
[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b.substr(1));return F.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){return this.ref["$"+this.it.next()]}}},__class__:Za};var Vf=function(){};Vf.__name__=!0;Vf.getType=function(a){a=a.__meta__;return null==a||null==a.obj?{}:a.obj};var hf=function(a){this.__x=a};hf.__name__=!0;hf.prototype={resolve:function(a){var b=this.__x.elementsNamed(a).next();if(null==b)throw(this.__x.nodeType==
v.Document?"Document":this.__x.get_nodeName())+" is missing element "+a;return new Vd(b)},__class__:hf};var jf=function(a){this.__x=a};jf.__name__=!0;jf.prototype={__class__:jf};var kf=function(a){this.__x=a};kf.__name__=!0;kf.prototype={__class__:kf};var lf=function(a){this.__x=a};lf.__name__=!0;lf.prototype={__class__:lf};var mf=function(a){this.__x=a};mf.__name__=!0;mf.prototype={__class__:mf};var Vd=function(a){if(a.nodeType!=v.Document&&a.nodeType!=v.Element)throw"Invalid nodeType "+B.string(a.nodeType);
this.x=a;this.node=new hf(a);this.nodes=new mf(a);this.att=new jf(a);this.has=new kf(a);this.hasNode=new lf(a)};Vd.__name__=!0;Vd.prototype={get_name:function(){return this.x.nodeType==v.Document?"Document":this.x.get_nodeName()},get_innerData:function(){var a=this.x.iterator();if(!a.hasNext())throw this.get_name()+" does not have data";var b=a.next(),c=a.next();if(null!=c){if(b.nodeType==v.PCData&&c.nodeType==v.CData&&""==S.trim(b.get_nodeValue())&&(b=a.next(),null==b||b.nodeType==v.PCData&&""==
S.trim(b.get_nodeValue())&&null==a.next()))return c.get_nodeValue();throw this.get_name()+" does not only have data";}if(b.nodeType!=v.PCData&&b.nodeType!=v.CData)throw this.get_name()+" does not have data";return b.get_nodeValue()},__class__:Vd,__properties__:{get_innerData:"get_innerData",get_name:"get_name"}};var wb=function(){};wb.__name__=!0;wb.parse=function(a){var b=v.createDocument();wb.doParse(a,0,b);return b};wb.doParse=function(a,b,c){null==b&&(b=0);for(var d=null,e=1,f=1,h=null,i=0,g=
0,n=0,l=a.charCodeAt(b),j=new gd;l==l;){switch(e){case 0:switch(l){case 10:case 13:case 9:case 32:break;default:e=f;continue}break;case 1:switch(l){case 60:e=0;f=2;break;default:i=b;e=13;continue}break;case 13:60==l?(f=v.createPCData(j.b+F.substr(a,i,b-i)),j=new gd,c.addChild(f),g++,e=0,f=2):38==l&&(j.addSub(a,i,b-i),e=18,f=13,i=b+1);break;case 17:93==l&&93==a.charCodeAt(b+1)&&62==a.charCodeAt(b+2)&&(e=v.createCData(F.substr(a,i,b-i)),c.addChild(e),g++,b+=2,e=1);break;case 2:switch(l){case 33:if(91==
a.charCodeAt(b+1)){b+=2;if("CDATA["!=F.substr(a,b,6).toUpperCase())throw"Expected <![CDATA[";b+=5;e=17}else if(68==a.charCodeAt(b+1)||100==a.charCodeAt(b+1)){if("OCTYPE"!=F.substr(a,b+2,6).toUpperCase())throw"Expected <!DOCTYPE";b+=8;e=16}else{if(45!=a.charCodeAt(b+1)||45!=a.charCodeAt(b+2))throw"Expected <\!--";b+=2;e=15}i=b+1;break;case 63:e=14;i=b;break;case 47:if(null==c)throw"Expected node name";i=b+1;e=0;f=10;break;default:e=3;i=b;continue}break;case 3:if(!(97<=l&&122>=l||65<=l&&90>=l||48<=
l&&57>=l||58==l||46==l||95==l||45==l)){if(b==i)throw"Expected node name";d=v.createElement(F.substr(a,i,b-i));c.addChild(d);e=0;f=4;continue}break;case 4:switch(l){case 47:e=11;g++;break;case 62:e=9;g++;break;default:e=5;i=b;continue}break;case 5:if(!(97<=l&&122>=l||65<=l&&90>=l||48<=l&&57>=l||58==l||46==l||95==l||45==l)){if(i==b)throw"Expected attribute name";h=F.substr(a,i,b-i);if(d.exists(h))throw"Duplicate attribute";e=0;f=6;continue}break;case 6:switch(l){case 61:e=0;f=7;break;default:throw"Expected =";
}break;case 7:switch(l){case 34:case 39:e=8;i=b;break;default:throw'Expected "';}break;case 8:l==a.charCodeAt(i)&&(f=F.substr(a,i+1,b-i-1),d.set(h,f),e=0,f=4);break;case 9:i=b=wb.doParse(a,b,d);e=1;break;case 11:switch(l){case 62:e=1;break;default:throw"Expected >";}break;case 12:switch(l){case 62:return 0==g&&c.addChild(v.createPCData("")),b;default:throw"Expected >";}case 10:if(!(97<=l&&122>=l||65<=l&&90>=l||48<=l&&57>=l||58==l||46==l||95==l||45==l)){if(i==b)throw"Expected node name";if(F.substr(a,
i,b-i)!=c.get_nodeName())throw"Expected </"+c.get_nodeName()+">";e=0;f=12;continue}break;case 15:45==l&&45==a.charCodeAt(b+1)&&62==a.charCodeAt(b+2)&&(c.addChild(v.createComment(F.substr(a,i,b-i))),b+=2,e=1);break;case 16:91==l?n++:93==l?n--:62==l&&0==n&&(c.addChild(v.createDocType(F.substr(a,i,b-i))),e=1);break;case 14:63==l&&62==a.charCodeAt(b+1)&&(b++,e=F.substr(a,i+1,b-i-2),c.addChild(v.createProcessingInstruction(e)),e=1);break;case 18:59==l&&(i=F.substr(a,i,b-i),35==i.charCodeAt(0)?(i=120==
i.charCodeAt(1)?B.parseInt("0"+F.substr(i,1,i.length-1)):B.parseInt(F.substr(i,1,i.length-1)),j.add(String.fromCharCode(i))):wb.escapes.exists(i)?j.add(wb.escapes.get(i)):j.b+=B.string("&"+i+";"),i=b+1,e=f)}l=S.fastCodeAt(a,++b)}1==e&&(i=b,e=13);if(13==e)return(b!=i||0==g)&&c.addChild(v.createPCData(j.b+F.substr(a,i,b-i))),b;throw"Unexpected end";};var ga=function(){};ga.__name__=!0;ga.getClass=function(a){return a instanceof Array&&null==a.__enum__?Array:a.__class__};ga.__string_rec=function(a,b){if(null==
a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];for(var c=a[0]+"(",b=b+"\t",d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+ga.__string_rec(a[f],b)):c+ga.__string_rec(a[f],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)f=e++,d+=(0<f?",":"")+ga.__string_rec(a[f],b);return d+"]"}try{d=a.toString}catch(h){return"???"}if(null!=d&&d!=Object.toString&&
(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)if(!e||a.hasOwnProperty(c))"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+ga.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return""+a}};ga.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=
c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||ga.__interfLoop(f,b))return!0}return ga.__interfLoop(a.__super__,b)};ga.__instanceof=function(a,b){if(null==b)return!1;switch(b){case gg:return(a|0)===a;case bg:return"number"==typeof a;case cg:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case hg:return!0;default:if(null!=a){if("function"==typeof b&&(a instanceof b||ga.__interfLoop(ga.getClass(a),b)))return!0}else return!1;
return b==ig&&null!=a.__name__||b==jg&&null!=a.__ename__?!0:a.__enum__==b}};ga.__cast=function(a,b){if(ga.__instanceof(a,b))return a;throw"Cannot cast "+B.string(a)+" to "+B.string(b);};var m=function(){};m.__name__=!0;var ab=function(){this.zpp_inner=null};ab.__name__=!0;ab.prototype={toString:function(){return""},__class__:ab};var he=function(){this.zpp_inner=null};he.__name__=!0;he.__super__=ab;he.prototype=y(ab.prototype,{toString:function(){var a;a="Cb:"+["WAKE","SLEEP"][this.zpp_inner.event-
g.id_CbEvent_WAKE];a+=":"+this.zpp_inner.body.outer.toString();return a+=" : listener: "+B.string(this.zpp_inner.listener.outer)},__class__:he});var Qb=function(){this.zpp_inner=null};Qb.__name__=!0;Qb.prototype={toString:function(){var a="BEGIN,END,WAKE,SLEEP,BREAK,PRE,ONGOING".split(",")[this.zpp_inner.event];if(this.zpp_inner.type==g.id_ListenerType_BODY)return"BodyListener{"+a+"::"+B.string(this.zpp_inner.body.outer_zn.zpp_inner_zn.options.outer)+"}";if(this.zpp_inner.type==g.id_ListenerType_CONSTRAINT)return"ConstraintListener{"+
a+"::"+B.string(this.zpp_inner.constraint.outer_zn.zpp_inner_zn.options.outer)+"}";var b=this.zpp_inner.interaction,c;switch(b.itype){case g.id_InteractionType_COLLISION:c="COLLISION";break;case g.id_InteractionType_SENSOR:c="SENSOR";break;case g.id_InteractionType_FLUID:c="FLUID";break;default:c="ALL"}return(this.zpp_inner.type==g.id_ListenerType_INTERACTION?"InteractionListener{"+a+"#"+c+"::"+B.string(b.outer_zni.zpp_inner_zn.options1.outer)+":"+B.string(b.outer_zni.zpp_inner_zn.options2.outer)+
"}":"PreListener{"+c+"::"+B.string(b.outer_znp.zpp_inner_zn.options1.outer)+":"+B.string(b.outer_znp.zpp_inner_zn.options2.outer)+"}")+" precedence="+this.zpp_inner.precedence},__class__:Qb};var nf=function(){this.zpp_inner_zn=null};nf.__name__=!0;nf.__super__=Qb;nf.prototype=y(Qb.prototype,{__class__:nf});var rd=function(){this.zpp_inner=null;this.zpp_inner=new va;this.zpp_inner.outer=this};rd.__name__=!0;rd.prototype={toString:function(){return this==va.ANY_BODY?"ANY_BODY":this==va.ANY_SHAPE?"ANY_SHAPE":
this==va.ANY_COMPOUND?"ANY_COMPOUND":this==va.ANY_CONSTRAINT?"ANY_CONSTRAINT":"CbType#"+this.zpp_inner.id},__class__:rd};var sd=function(){this.zpp_inner=null};sd.__name__=!0;sd.__super__=ab;sd.prototype=y(ab.prototype,{toString:function(){var a;a="Cb:"+["WAKE","SLEEP","BREAK"][this.zpp_inner.event-g.id_CbEvent_WAKE];a+=":"+this.zpp_inner.constraint.outer.toString();return a+=" : listener: "+B.string(this.zpp_inner.listener.outer)},__class__:sd});var of=function(){this.zpp_inner_zn=null};of.__name__=
!0;of.__super__=Qb;of.prototype=y(Qb.prototype,{__class__:of});var Wc=function(){this.zpp_inner=null};Wc.__name__=!0;Wc.__super__=ab;Wc.prototype=y(ab.prototype,{toString:function(){var a;a="Cb:"+"BEGIN,END,,,,,ONGOING".split(",")[this.zpp_inner.event];a+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString();a+=" : "+this.zpp_inner.wrap_arbiters.toString();return a+=" : listener: "+B.string(this.zpp_inner.listener.outer)},__class__:Wc});var pf=function(){this.zpp_inner_zn=
null};pf.__name__=!0;pf.__super__=Qb;pf.prototype=y(Qb.prototype,{__class__:pf});var Rb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};Rb.__name__=!0;Rb.get=function(a){var b;null==Rb.zpp_pool?(Sb.internal=!0,b=new Rb,Sb.internal=!1):(b=Rb.zpp_pool,Rb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Rb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;
this.zpp_next=Rb.zpp_pool;Rb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Rb};var qf=function(){this.zpp_inner=null;this.zpp_inner=new Sb;this.zpp_inner.outer=this};qf.__name__=!0;qf.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();
this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=
!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Rb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:qf,__properties__:{get_length:"get_length"}};var ie=function(){this.zpp_inner=null};ie.__name__=!0;
ie.__super__=ab;ie.prototype=y(ab.prototype,{toString:function(){var a;a="Cb:PRE:"+(":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString());a+=" : "+this.zpp_inner.pre_arbiter.wrapper().toString();return a+=" : listnener: "+B.string(this.zpp_inner.listener.outer)},__class__:ie});var ja=function(){};ja.__name__=!0;ja.prototype={toString:function(){var a;null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);this==g.PreFlag_ACCEPT?a="ACCEPT":(null==
g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1),this==g.PreFlag_IGNORE?a="IGNORE":(null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1),this==g.PreFlag_ACCEPT_ONCE?a="ACCEPT_ONCE":(null==g.PreFlag_IGNORE_ONCE&&(g.internal=!0,g.PreFlag_IGNORE_ONCE=new ja,g.internal=!1),a=this==g.PreFlag_IGNORE_ONCE?"IGNORE_ONCE":"")));return a},__class__:ja};var rf=function(){this.zpp_inner_zn=null};rf.__name__=!0;rf.__super__=Qb;rf.prototype=y(Qb.prototype,
{__class__:rf});var Xc=function(){this.zpp_inner.insert_cbtype(va.ANY_CONSTRAINT.zpp_inner)};Xc.__name__=!0;Xc.prototype={set_space:function(a){if((null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a)null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),null!=this.zpp_inner.space&&this.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(this),null!=a?a.zpp_inner.wrap_constraints.add(this):this.zpp_inner.space=null;return null==this.zpp_inner.space?
null:this.zpp_inner.space.outer},set_active:function(a){this.zpp_inner.active!=a&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),a?(this.zpp_inner.active=a,this.zpp_inner.activate(),null!=this.zpp_inner.space&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.sleeping=!0),this.zpp_inner.space.wake_constraint(this.zpp_inner,!0))):(null!=this.zpp_inner.space&&(this.zpp_inner.wake(),this.zpp_inner.space.live_constraints.remove(this.zpp_inner)),
this.zpp_inner.active=a,this.zpp_inner.deactivate()));return this.zpp_inner.active},set_stiff:function(a){this.zpp_inner.stiff!=a&&(this.zpp_inner.stiff=a,this.zpp_inner.wake());return this.zpp_inner.stiff},toString:function(){return"{Constraint}"},__class__:Xc,__properties__:{set_stiff:"set_stiff",set_active:"set_active",set_space:"set_space"}};var kb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};kb.__name__=!0;kb.get=function(a){var b;null==kb.zpp_pool?(ub.internal=
!0,b=new kb,ub.internal=!1):(b=kb.zpp_pool,kb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};kb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=kb.zpp_pool;kb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:kb};var sf=function(){this.zpp_inner=null;this.zpp_inner=new ub;this.zpp_inner.outer=
this};sf.__name__=!0;sf.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,
this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),
this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=kb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:sf,__properties__:{get_length:"get_length"}};var ud=function(a,b,c,d){this.zpp_inner_zn=null;this.zpp_inner=this.zpp_inner_zn=new td;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;Xc.call(this);this.set_body1(a);this.set_body2(b);
null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(c);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1;null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(d);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2};ud.__name__=!0;ud.__super__=Xc;ud.prototype=y(Xc.prototype,{set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");
a=null==a?null:a.zpp_inner;if(a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&
this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)))this.zpp_inner.wake(),null!=a&&a.wake();return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");a=null==a?null:a.zpp_inner;if(a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=
this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)))this.zpp_inner.wake(),
null!=a&&a.wake();return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},get_anchor2:function(){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},__class__:ud,__properties__:y(Xc.prototype.__properties__,{get_anchor2:"get_anchor2",get_anchor1:"get_anchor1",set_body2:"set_body2",set_body1:"set_body1"})});var Yc=function(){this.zpp_inner=
null};Yc.__name__=!0;Yc.prototype={get_state:function(){var a=this.zpp_inner.immState;if(a==(g.id_ImmState_ACCEPT|g.id_ImmState_ALWAYS))return null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1),g.PreFlag_ACCEPT;switch(a){case g.id_ImmState_ACCEPT:return null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1),g.PreFlag_ACCEPT_ONCE;default:if(a==(g.id_ImmState_IGNORE|g.id_ImmState_ALWAYS))return null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=
new ja,g.internal=!1),g.PreFlag_IGNORE;null==g.PreFlag_IGNORE_ONCE&&(g.internal=!0,g.PreFlag_IGNORE_ONCE=new ja,g.internal=!1);return g.PreFlag_IGNORE_ONCE}},toString:function(){var a;a=this.zpp_inner.type==D.COL?"CollisionArbiter":this.zpp_inner.type==D.FLUID?"FluidArbiter":"SensorArbiter";return this.zpp_inner.cleared?a+"(object-pooled)":a+"("+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).toString()+"|"+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?
this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).toString()+")"+(this.zpp_inner.type==D.COL?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-"+this.get_state().toString()},__class__:Yc,__properties__:{get_state:"get_state"}};var Tb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};Tb.__name__=!0;Tb.get=function(a){var b;null==Tb.zpp_pool?(Ub.internal=!0,b=new Tb,Ub.internal=!1):(b=Tb.zpp_pool,Tb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=
!1;return b};Tb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Tb.zpp_pool;Tb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Tb};var tf=function(){this.zpp_inner=null;this.zpp_inner=new Ub;this.zpp_inner.outer=this};tf.__name__=!0;tf.prototype={zpp_gl:function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=
!1;this.zpp_inner.user_length=0;for(var a=this.zpp_inner.inner.head;null!=a;)a.elt.active&&this.zpp_inner.user_length++,a=a.next}return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},at:function(a){this.zpp_vm();this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite){this.zpp_inner.at_index=0;for(this.zpp_inner.at_ite=this.zpp_inner.inner.head;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=
a;){this.zpp_inner.at_index++;for(this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.elt.wrapper()},iterator:function(){this.zpp_vm();return Tb.get(this)},toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:tf};var Zc=function(){this.zpp_inner=
null};Zc.__name__=!0;Zc.__super__=Yc;Zc.prototype=y(Yc.prototype,{__class__:Zc});var uf=function(){this.zpp_inner=null};uf.__name__=!0;uf.prototype={toString:function(){return null==this.zpp_inner.arbiter||this.zpp_inner.arbiter.cleared?"{object-pooled}":"{Contact}"},__class__:uf};var je=function(){this.zpp_inner=null};je.__name__=!0;je.__super__=Yc;je.prototype=y(Yc.prototype,{__class__:je});var vf=function(a,b,c,d,e,f){null==f&&(f=-1);null==e&&(e=1);null==d&&(d=-1);null==c&&(c=1);null==b&&(b=-1);
null==a&&(a=1);this.zpp_inner=null;null==wa.zpp_pool?this.zpp_inner=new wa:(this.zpp_inner=wa.zpp_pool,wa.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null);null;this.zpp_inner.outer=this;this.zpp_inner.collisionGroup!=a&&(this.zpp_inner.collisionGroup=a,this.zpp_inner.invalidate());this.zpp_inner.collisionGroup;this.zpp_inner.collisionMask!=b&&(this.zpp_inner.collisionMask=b,this.zpp_inner.invalidate());this.zpp_inner.collisionMask;this.zpp_inner.sensorGroup!=c&&(this.zpp_inner.sensorGroup=c,
this.zpp_inner.invalidate());this.zpp_inner.sensorGroup;this.zpp_inner.sensorMask!=d&&(this.zpp_inner.sensorMask=d,this.zpp_inner.invalidate());this.zpp_inner.sensorMask;this.zpp_inner.fluidGroup!=e&&(this.zpp_inner.fluidGroup=e,this.zpp_inner.invalidate());this.zpp_inner.fluidGroup;this.zpp_inner.fluidMask!=f&&(this.zpp_inner.fluidMask=f,this.zpp_inner.invalidate());this.zpp_inner.fluidMask};vf.__name__=!0;vf.prototype={__class__:vf};var wf=function(){this.zpp_inner=null};wf.__name__=!0;wf.prototype=
{toString:function(){var a="GeomPoly[",b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;d!=this.zpp_inner.vertices&&(a+=",");a+="{"+d.x+","+d.y+"}";b=b.next}while(b!=c)}return a+"]"},__class__:wf};var t=function(a,b){null==b&&(b=0);null==a&&(a=0);this.zpp_inner=this.zpp_pool=null;this.zpp_inner=H.get(a,b,null);this.zpp_inner.outer=this};t.__name__=!0;t.get=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);var d;null==mc.poolVec2?d=new t:(d=mc.poolVec2,mc.poolVec2=
d.zpp_pool,d.zpp_pool=null);if(null==d.zpp_inner)d.zpp_inner=H.get(a,b,null),d.zpp_inner.outer=d;else{var e;d.zpp_inner.validate();if(e=d.zpp_inner.x==a)d.zpp_inner.validate(),e=d.zpp_inner.y==b;e||(d.zpp_inner.x=a,d.zpp_inner.y=b,d.zpp_inner.invalidate());d}d.zpp_inner.weak=c;return d};t.distance=function(a,b){var c=Math.sqrt(gb.vec_dsq(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this),function(){b.zpp_inner.validate();return b.zpp_inner.x}(this),
function(){b.zpp_inner.validate();return b.zpp_inner.y}(this)));a.zpp_inner.weak?(a.dispose(),!0):!1;b.zpp_inner.weak?(b.dispose(),!0):!1;return c};t.prototype={dispose:function(){var a=this.zpp_inner;this.zpp_inner=this.zpp_inner.outer=null;this.zpp_pool=mc.poolVec2;mc.poolVec2=this;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=H.zpp_pool;H.zpp_pool=a},get_x:function(){this.zpp_inner.validate();return this.zpp_inner.x},get_y:function(){this.zpp_inner.validate();
return this.zpp_inner.y},lsq:function(){var a;this.zpp_inner.validate();a=this.zpp_inner.x;this.zpp_inner.validate();a*=this.zpp_inner.x;var b;this.zpp_inner.validate();b=this.zpp_inner.y;this.zpp_inner.validate();return a+b*this.zpp_inner.y},set:function(a){var b=this.setxy(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this));a.zpp_inner.weak?(a.dispose(),!0):!1;return b},setxy:function(a,b){var c;this.zpp_inner.validate();if(c=
this.zpp_inner.x==a)this.zpp_inner.validate(),c=this.zpp_inner.y==b;c||(this.zpp_inner.x=a,this.zpp_inner.y=b,this.zpp_inner.invalidate());return this},toString:function(){this.zpp_inner.validate();return this.zpp_inner.toString()},__class__:t,__properties__:{get_y:"get_y",get_x:"get_x"}};var eb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};eb.__name__=!0;eb.get=function(a){var b;null==eb.zpp_pool?($c.internal=!0,b=new eb,$c.internal=!1):(b=eb.zpp_pool,eb.zpp_pool=
b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};eb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=eb.zpp_pool;eb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:eb};var ad=function(){this.zpp_inner=null;this.zpp_inner=new $c;this.zpp_inner.outer=this};ad.__name__=!0;ad.prototype={zpp_gl:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},at:function(a){this.zpp_vm();this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;
return this.zpp_inner.at_ite.elt.wrapper()},push:function(a){this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=this.empty()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&
this.zpp_inner.post_adder(a);return b},empty:function(){return 0==this.zpp_gl()},iterator:function(){this.zpp_vm();return eb.get(this)},toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:ad};var Vb=function(){this.zpp_inner_i=null};Vb.__name__=!0;Vb.prototype={toString:function(){return""},__class__:Vb};var bd=function(a,b){this.zpp_inner_i=this.zpp_inner=
null;this.zpp_inner=new bb;this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;null!=b?(b.zpp_inner.validate(),this.zpp_inner.posx=b.zpp_inner.x,b.zpp_inner.validate(),this.zpp_inner.posy=b.zpp_inner.y):(this.zpp_inner.posx=0,this.zpp_inner.posy=0);this.set_type(null==a?function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this):a);null!=b&&(b.zpp_inner.weak?(b.dispose(),!0):!1);this.zpp_inner_i.insert_cbtype(va.ANY_BODY.zpp_inner)};
bd.__name__=!0;bd.__super__=Vb;bd.prototype=y(Vb.prototype,{set_type:function(a){this.zpp_inner.immutable_midstep("Body::type");bb.types[this.zpp_inner.type]!=a&&(null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1),a==g.BodyType_DYNAMIC?a=g.id_BodyType_DYNAMIC:(null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new N,g.internal=!1),a=a==g.BodyType_KINEMATIC?g.id_BodyType_KINEMATIC:g.id_BodyType_STATIC),a==g.id_BodyType_STATIC&&null!=this.zpp_inner.space&&
(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0),this.zpp_inner.invalidate_type(),null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,a):this.zpp_inner.type=a);return bb.types[this.zpp_inner.type]},set_space:function(a){this.zpp_inner.immutable_midstep("Body::space");if((null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a){if(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))this.zpp_inner.component.woken=!1;if(null!=(null==
this.zpp_inner.space?null:this.zpp_inner.space.outer))(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(this);null!=a&&a.zpp_inner.wrap_bodies.add(this)}return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},get_position:function(){null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();return this.zpp_inner.wrap_pos},set_rotation:function(a){this.zpp_inner.immutable_midstep("Body::rotation");this.zpp_inner.rot!=a&&(this.zpp_inner.rot=a,this.zpp_inner.invalidate_rot(),
this.zpp_inner.wake());return this.zpp_inner.rot},worldPointToLocal:function(a,b){null==b&&(b=!1);this.zpp_inner.validate_axis();var c=0,d=0,e=d=0;a.zpp_inner.validate();d=a.zpp_inner.x-this.zpp_inner.posx;a.zpp_inner.validate();e=a.zpp_inner.y-this.zpp_inner.posy;c=d*this.zpp_inner.axisy+e*this.zpp_inner.axisx;d=e*this.zpp_inner.axisy-d*this.zpp_inner.axisx;a.zpp_inner.weak?(a.dispose(),!0):!1;return t.get(c,d,b)},toString:function(){return(this.zpp_inner.world?"(space::world":"("+(this.zpp_inner.type==
g.id_BodyType_DYNAMIC?"dynamic":this.zpp_inner.type==g.id_BodyType_STATIC?"static":"kinematic"))+")#"+this.zpp_inner_i.id},__class__:bd,__properties__:{set_rotation:"set_rotation",get_position:"get_position",set_space:"set_space",set_type:"set_type"}});var Db=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};Db.__name__=!0;Db.get=function(a){var b;null==Db.zpp_pool?(Eb.internal=!0,b=new Db,Eb.internal=!1):(b=Db.zpp_pool,Db.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=
a;b.zpp_critical=!1;return b};Db.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Db.zpp_pool;Db.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Db};var Gc=function(){this.zpp_inner=null;this.zpp_inner=new Eb;this.zpp_inner.outer=this};Gc.__name__=!0;Gc.prototype={get_length:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=
a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),
this.zpp_inner.invalidate());return b},iterator:function(){this.zpp_inner.valmod();return Db.get(this)},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Db.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Gc,__properties__:{get_length:"get_length"}};var N=function(){};N.__name__=!0;N.prototype={toString:function(){var a;null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new N,
g.internal=!1);this==g.BodyType_STATIC?a="STATIC":(null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1),this==g.BodyType_DYNAMIC?a="DYNAMIC":(null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new N,g.internal=!1),a=this==g.BodyType_KINEMATIC?"KINEMATIC":""));return a},__class__:N};var xf=function(){this.zpp_inner=null};xf.__name__=!0;xf.__super__=Vb;xf.prototype=y(Vb.prototype,{toString:function(){return"Compound"+this.zpp_inner_i.id},__class__:xf});var fb=
function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};fb.__name__=!0;fb.get=function(a){var b;null==fb.zpp_pool?(Wb.internal=!0,b=new fb,Wb.internal=!1):(b=fb.zpp_pool,fb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};fb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=fb.zpp_pool;fb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=
!1;return this.zpp_inner.at(this.zpp_i++)},__class__:fb};var yf=function(){this.zpp_inner=null;this.zpp_inner=new Wb;this.zpp_inner.outer=this};yf.__name__=!0;yf.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=
a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),
this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=fb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:yf,__properties__:{get_length:"get_length"}};var Fb=function(a,b,c,d,e){null==e&&(e=0.001);null==d&&(d=1);null==c&&(c=2);null==b&&(b=1);null==a&&(a=0);this.zpp_inner=null;null==K.zpp_pool?this.zpp_inner=new K:(this.zpp_inner=K.zpp_pool,K.zpp_pool=
this.zpp_inner.next,this.zpp_inner.next=null);null;this.zpp_inner.outer=this;a!=this.zpp_inner.elasticity&&(this.zpp_inner.elasticity=a/1,this.zpp_inner.invalidate(K.WAKE|K.ARBITERS));this.zpp_inner.elasticity;b!=this.zpp_inner.dynamicFriction&&(this.zpp_inner.dynamicFriction=b/1,this.zpp_inner.invalidate(K.WAKE|K.ANGDRAG|K.ARBITERS));this.zpp_inner.dynamicFriction;c!=this.zpp_inner.staticFriction&&(this.zpp_inner.staticFriction=c/1,this.zpp_inner.invalidate(K.WAKE|K.ARBITERS));this.zpp_inner.staticFriction;
d!=1E3*this.zpp_inner.density&&(this.zpp_inner.density=d/1E3,this.zpp_inner.invalidate(K.WAKE|K.PROPS));1E3*this.zpp_inner.density;e!=this.zpp_inner.rollingFriction&&(this.zpp_inner.rollingFriction=e/1,this.zpp_inner.invalidate(K.WAKE|K.ARBITERS));this.zpp_inner.rollingFriction};Fb.__name__=!0;Fb.wood=function(){return new Fb(0.4,0.2,0.38,0.7,0.005)};Fb.prototype={toString:function(){return"{ elasticity: "+this.zpp_inner.elasticity+" dynamicFriction: "+this.zpp_inner.dynamicFriction+" staticFriction: "+
this.zpp_inner.staticFriction+" density: "+1E3*this.zpp_inner.density+" rollingFriction: "+this.zpp_inner.rollingFriction+" }"},__class__:Fb};var Gb=function(){this.zpp_inner_i=this.zpp_inner=null};Gb.__name__=!0;Gb.__super__=Vb;Gb.prototype=y(Vb.prototype,{set_sensorEnabled:function(a){this.zpp_inner.immutable_midstep("Shape::sensorEnabled");this.zpp_inner.sensorEnabled=a;this.zpp_inner.wake();return this.zpp_inner.sensorEnabled},translate:function(a){this.zpp_inner.immutable_midstep("Shape::translate()");
0<a.lsq()&&(this.zpp_inner.type==g.id_ShapeType_CIRCLE?this.zpp_inner.circle.__translate(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this)):this.zpp_inner.polygon.__translate(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this)));a.zpp_inner.weak?(a.dispose(),!0):!1;return this},toString:function(){return(this.zpp_inner.type==g.id_ShapeType_CIRCLE?"Circle":
"Polygon")+"#"+this.zpp_inner_i.id},__class__:Gb,__properties__:{set_sensorEnabled:"set_sensorEnabled"}});var le=function(a,b,c,d){this.zpp_inner_zn=null;Gb.call(this);this.zpp_inner_zn=new ke;this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner_i=this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i.outer_i=this;this.zpp_inner.immutable_midstep("Circle::radius");a!=this.zpp_inner_zn.radius&&(this.zpp_inner_zn.radius=a,this.zpp_inner_zn.invalidate_radius());this.zpp_inner_zn.radius;
null==b?(this.zpp_inner.localCOMx=0,this.zpp_inner.localCOMy=0):(b.zpp_inner.validate(),this.zpp_inner.localCOMx=b.zpp_inner.x,b.zpp_inner.validate(),this.zpp_inner.localCOMy=b.zpp_inner.y,b.zpp_inner.weak?(b.dispose(),!0):!1);null==c?(null==K.zpp_pool?this.zpp_inner.material=new K:(this.zpp_inner.material=K.zpp_pool,K.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),null):(this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(c.zpp_inner),this.zpp_inner.material.wrapper());
null==d?(null==wa.zpp_pool?this.zpp_inner.filter=new wa:(this.zpp_inner.filter=wa.zpp_pool,wa.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),null):(this.zpp_inner.immutable_midstep("Shape::filter"),this.zpp_inner.setFilter(d.zpp_inner),this.zpp_inner.filter.wrapper());this.zpp_inner_i.insert_cbtype(va.ANY_SHAPE.zpp_inner)};le.__name__=!0;le.__super__=Gb;le.prototype=y(Gb.prototype,{__class__:le});var zf=function(){this.zpp_inner=null};zf.__name__=!0;zf.prototype={toString:function(){if(null==
this.zpp_inner.polygon)return"Edge(object-pooled)";if(null==this.zpp_inner.polygon.body)return this.zpp_inner.polygon.validate_laxi(),"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" }";this.zpp_inner.polygon.validate_gaxi();return"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" worldNormal : "+("{ x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" }")+" }"},__class__:zf};var pa=function(a,b,c){this.zpp_inner_zn=null;
Gb.call(this);this.zpp_inner_zn=new te;this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner_i=this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i.outer_i=this;if(a instanceof Array&&null==a.__enum__)for(var d=0;d<a.length;){var e=a[d];++d;var f=e;null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(t.get(function(){f.zpp_inner.validate();return f.zpp_inner.x}(this),function(){f.zpp_inner.validate();return f.zpp_inner.y}(this),!1))}else if(ga.__instanceof(a,
ad))for(d=a.iterator();d.hasNext();){var h;d.zpp_critical=!1;h=d.zpp_inner.at(d.zpp_i++);null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(t.get(function(){h.zpp_inner.validate();return h.zpp_inner.x}(this),function(){h.zpp_inner.validate();return h.zpp_inner.y}(this),!1))}else if(ga.__instanceof(a,wf)&&(d=a.zpp_inner.vertices,null!=d)){e=d;do{var i=t.get(e.x,e.y,null),e=e.next;null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(t.get(function(){i.zpp_inner.validate();
return i.zpp_inner.x}(this),function(){i.zpp_inner.validate();return i.zpp_inner.y}(this),!1));i.dispose()}while(e!=d)}if(a instanceof Array&&null==a.__enum__)for(d=0;d<a.length;){var e=a[d],g;if(g=e.zpp_inner.weak)e.dispose(),g=!0;g?a.splice(d,1):d++}else if(ga.__instanceof(a,ad)){null!=a.zpp_inner._validate&&a.zpp_inner._validate();a=a.zpp_inner.inner;d=null;for(e=a.head;null!=e;)g=e.elt,g.outer.zpp_inner.weak?(e=a.erase(d),g.outer.zpp_inner.weak?(g.outer.dispose(),!0):!1):(d=e,e=e.next)}null==
b?(null==K.zpp_pool?this.zpp_inner.material=new K:(this.zpp_inner.material=K.zpp_pool,K.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),null):(this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(b.zpp_inner),this.zpp_inner.material.wrapper());null==c?(null==wa.zpp_pool?this.zpp_inner.filter=new wa:(this.zpp_inner.filter=wa.zpp_pool,wa.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),null):(this.zpp_inner.immutable_midstep("Shape::filter"),
this.zpp_inner.setFilter(c.zpp_inner),this.zpp_inner.filter.wrapper());this.zpp_inner_i.insert_cbtype(va.ANY_SHAPE.zpp_inner)};pa.__name__=!0;pa.rect=function(a,b,c,d,e){null==e&&(e=!1);return[t.get(a,b,e),t.get(a+c,b,e),t.get(a+c,b+d,e),t.get(a,b+d,e)]};pa.box=function(a,b,c){null==c&&(c=!1);return pa.rect(-a/2,-b/2,a,b,c)};pa.__super__=Gb;pa.prototype=y(Gb.prototype,{__class__:pa});var vb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null};vb.__name__=!0;vb.get=
function(a){var b;null==vb.zpp_pool?(Xb.internal=!0,b=new vb,Xb.internal=!1):(b=vb.zpp_pool,vb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};vb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=vb.zpp_pool;vb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:vb};var Af=function(){this.zpp_inner=
null;this.zpp_inner=new Xb;this.zpp_inner.outer=this};Af.__name__=!0;Af.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},at:function(a){this.zpp_inner.valmod();this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);
else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),
this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-
1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&
this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=vb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},__class__:Af,__properties__:{get_length:"get_length"}};var vd=function(){};vd.__name__=!0;vd.prototype={toString:function(){var a;null==g.Broadphase_DYNAMIC_AABB_TREE&&
(g.internal=!0,g.Broadphase_DYNAMIC_AABB_TREE=new vd,g.internal=!1);this==g.Broadphase_DYNAMIC_AABB_TREE?a="DYNAMIC_AABB_TREE":(null==g.Broadphase_SWEEP_AND_PRUNE&&(g.internal=!0,g.Broadphase_SWEEP_AND_PRUNE=new vd,g.internal=!1),a=this==g.Broadphase_SWEEP_AND_PRUNE?"SWEEP_AND_PRUNE":"");return a},__class__:vd};var Cf=function(a,b){this.zpp_inner=null;this.zpp_inner=new Bf(null==a?null:a.zpp_inner,b);this.zpp_inner.outer=this;null!=a&&(a.zpp_inner.weak?(a.dispose(),!0):!1)};Cf.__name__=!0;Cf.prototype=
{step:function(a,b,c){null==c&&(c=10);null==b&&(b=10);this.zpp_inner.step(a,b,c)},bodiesUnderPoint:function(a,b,c){b=this.zpp_inner.bodiesUnderPoint(function(){a.zpp_inner.validate();return a.zpp_inner.x}(this),function(){a.zpp_inner.validate();return a.zpp_inner.y}(this),null==b?null:b.zpp_inner,c);a.zpp_inner.weak?(a.dispose(),!0):!1;return b},__class__:Cf};var aa=function(){this.root=(new ba).add(new Dc);new p(0,1200);p.addBorder(Fb.wood(),[0,0,0,1]);p.enableMouseDragging();var a=j.addImageSprite(this.root,
j.halfWidth,j.halfHeight,"bg");a.owner.add(new Hb(40));var b=j.addFillSprite(this.root,0,0,16777215,0,0,1,!1);b.y.set__(-1080);xa.tween(b,1,{y:0},0.9,null,na.backOut);var c=j.addImageSprite(this.root,0,0,"bg_tree",1,1,!1);c.y.set__(-1080);c.disablePointer();xa.tween(c,0.4,{y:0},0.9,null,na.circOut);var d=j.addFillSprite(this.root,0,0,16777215,0,0,1,!1);d.y.set__(-1080);xa.tween(d,1,{y:0},0.9,null,na.backOut);var e=new Fb(0.5,0.1,0.1,200,1),c=j.addImageSprite(b.owner,557,0,"msg1_bauble",1,1,!0).owner,
f=p.initAsCircle(c,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,135);f.zpp_inner.wrap_shapes.at(0).translate(t.get(0,104,!0));p.initPivotJoint(p.space.zpp_inner.__static,f,t.get(607,0,!0),t.get(0,-355,!0),!0,10,1);var h=j.addImageSprite(b.owner,j.halfWidth+50,-20,"msg2_bauble",1,1,!0).owner,f=p.initAsCircle(h,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),
e,!0,null,null,248);f.zpp_inner.wrap_shapes.at(0).translate(t.get(0,187,!0));p.initPivotJoint(p.space.zpp_inner.__static,f,t.get(j.halfWidth,-25,!0),t.get(0,-600,!0),!0,10,1);var f=j.addImageSprite(b.owner,1244,150,"logo_bauble",1,1,!0).owner,i=p.initAsCircle(f,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,130);i.zpp_inner.wrap_shapes.at(0).translate(t.get(0,137,!0));p.initPivotJoint(p.space.zpp_inner.__static,
i,t.get(1344,150,!0),t.get(0,-330,!0),!0,10,1);b=j.addImageSprite(b.owner,1785,327,"sound_bauble",1,1,!0).owner;i=p.initAsCircle(b,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,48);i.zpp_inner.wrap_shapes.at(0).translate(t.get(-1,96,!0));p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(1770,327,!0),t.get(0,-148,!0),!0,10,1);i=j.addImageSprite(d.owner,160,12,"bauble1",1,1,!0).owner;i=p.initAsCircle(i,function(){null==
g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,40);i.zpp_inner.wrap_shapes.at(0).translate(t.get(0,70,!0));p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(200,12,!0),t.get(0,-110,!0),!0,10,1);i=j.addImageSprite(d.owner,390,50,"bauble2",1,1,!0).owner;i=p.initAsCircle(i,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,86);i.zpp_inner.wrap_shapes.at(0).translate(t.get(0,
168,!0));p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(340,50,!0),t.get(0,-260,!0),!0,10,1);i=j.addImageSprite(d.owner,740,0,"bauble3",1,1,!0).owner;i=p.initAsCircle(i,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,105);i.zpp_inner.wrap_shapes.at(0).translate(t.get(5,65,!0));p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(790,0,!0),t.get(0,-200,!0),!0,10,1);i=j.addImageSprite(d.owner,994,46,"bauble4",
1,1,!0).owner;i=p.initAsCircle(i,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,95);i.zpp_inner.wrap_shapes.at(0).translate(t.get(0,125,!0));p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(1054,46,!0),t.get(0,-220,!0),!0,10,1);i=j.addImageSprite(d.owner,1245,0,"bauble5",1,1,!0).owner;i=p.initAsCircle(i,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),
e,!0,null,null,68);i.zpp_inner.wrap_shapes.at(0).translate(t.get(0,55,!0));p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(1285,0,!0),t.get(0,-170,!0),!0,10,1);i=j.addImageSprite(d.owner,117,230,"star1",1,1,!0).owner;i=p.initAsCircle(i,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,60);i.zpp_inner.wrap_shapes.at(0).translate(t.get(0,150,!0));p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(77,230,!0),
t.get(0,-210,!0),!0,10,1);i=j.addImageSprite(d.owner,410,55,"star2",1,1,!0).owner;i=p.initAsCircle(i,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,70);i.zpp_inner.wrap_shapes.at(0).translate(t.get(0,70,!0));p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(370,55,!0),t.get(0,-130,!0),!0,10,1);i=j.addImageSprite(d.owner,1650,50,"star3",1,1,!0).owner;i=p.initAsCircle(i,function(){null==g.BodyType_DYNAMIC&&
(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,60);i.zpp_inner.wrap_shapes.at(0).translate(t.get(0,235,!0));p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(1610,50,!0),t.get(0,-300,!0),!0,10,1);i=j.addImageSprite(d.owner,520,20,"candy",1,1,!0).owner;e=p.initAsBox(i,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,null,null,76,164);p.initPivotJoint(p.space.zpp_inner.__static,
e,t.get(500,20,!0),t.get(30,-80,!0),!0,10,1);e=new Fb(0.5,0.1,0.1,1E3,1);i=j.addImageSprite(d.owner,266,17,"ribbon1",1,1,!0);i.setAnchor(35,0);aa.ribbonSprite.push(i);i=p.initAsBox(null,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,i.x._value-20,i.y._value-100,33,220);i.zpp_inner.wrap_shapes.at(0).set_sensorEnabled(!0);aa.ribbonBody.push(i);p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(266,17,!0),t.get(17,-110,
!0),!1,2,0.2);i=j.addImageSprite(d.owner,880,160,"ribbon2",1,1,!0);i.setAnchor(40,0);aa.ribbonSprite.push(i);i=p.initAsBox(null,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,i.x._value-10,i.y._value,50,300);i.zpp_inner.wrap_shapes.at(0).set_sensorEnabled(!0);aa.ribbonBody.push(i);p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(880,160,!0),t.get(25,-150,!0),!1,2,0.2);i=j.addImageSprite(d.owner,1200,0,"ribbon3",
1,1,!0);i.setAnchor(0,0);aa.ribbonSprite.push(i);i=p.initAsBox(null,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,i.x._value+10,i.y._value-100,50,120);i.zpp_inner.wrap_shapes.at(0).set_sensorEnabled(!0);aa.ribbonBody.push(i);p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(1200,0,!0),t.get(-25,-60,!0),!1,2,0.2);i=j.addImageSprite(d.owner,1430,0,"ribbon4",1,1,!0);i.setAnchor(30,0);aa.ribbonSprite.push(i);i=p.initAsBox(null,
function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,i.x._value+10,i.y._value,40,120);i.zpp_inner.wrap_shapes.at(0).set_sensorEnabled(!0);aa.ribbonBody.push(i);p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(1430,0,!0),t.get(20,-60,!0),!1,2,0.2);i=j.addImageSprite(d.owner,1530,0,"ribbon5",1,1,!0);i.setAnchor(45,0);aa.ribbonSprite.push(i);i=p.initAsBox(null,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=
new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,i.x._value+10,i.y._value,40,220);i.zpp_inner.wrap_shapes.at(0).set_sensorEnabled(!0);aa.ribbonBody.push(i);p.initPivotJoint(p.space.zpp_inner.__static,i,t.get(1530,0,!0),t.get(20,-110,!0),!1,2,0.2);d=j.addImageSprite(d.owner,1870,200,"ribbon6",1,1,!0);d.setAnchor(25,0);aa.ribbonSprite.push(d);d=p.initAsBox(null,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),e,!0,
d.x._value+10,d.y._value,60,320);d.zpp_inner.wrap_shapes.at(0).set_sensorEnabled(!0);aa.ribbonBody.push(d);p.initPivotJoint(p.space.zpp_inner.__static,d,t.get(1870,200,!0),t.get(0,-160,!0),!1,2,0.2);d=b._compMap.Sprite_1.getNaturalWidth()/2;e=b._compMap.Sprite_1.getNaturalHeight()/2+95;j.addMuteButton(b,d,e,"btn_sound_on","btn_sound_off",I.isMuted);j.switchPack(1);d=f._compMap.Sprite_1.getNaturalWidth()/2;b=f._compMap.Sprite_1.getNaturalHeight()/2+140;j.addButton(f,d,b,"logo",function(){j.openUrl(U.xmlData.node.resolve("url").get_innerData())});
I.soundsFolder="";I.playSoundtrack("soundtrack",1);j.switchPack(0);f=c._compMap.Sprite_1.getNaturalWidth()/2-5;d=c._compMap.Sprite_1.getNaturalHeight()/2+98;b=U.xmlData.node.resolve("principal").get_innerData();c=j.addLabel(c,f,d,b,1,1,!1,"fonts/princ_msg_font_80px");c.setAlign(yb.Center);c.setWrapWidth(240);c.lineSpacing.set__(-15);c.letterSpacing.set__(-1.5);c.centerAnchor();this.wrapLabelInHeight(c,"fonts/princ_msg_font",200,80,20,20,!0);c=h._compMap.Sprite_1.getNaturalWidth()/2-4;f=h._compMap.Sprite_1.getNaturalHeight()/
2+170;d=U.xmlData.node.resolve("message").get_innerData();c=j.addLabel(h,c,f,d,1,1,!1,"fonts/msg_font_23px");c.setAlign(yb.Center);c.setWrapWidth(440);c.lineSpacing.set__(-8);c.letterSpacing.set__(-1);c.centerAnchor();c.setAlpha(0);j.addDelay(this.root,1.2,function(){var a=(new E(j.assets,"fx/msg_fx")).createEmitter();a.disablePointer();var b=h._compMap.Sprite_1.getNaturalWidth()/2,c=h._compMap.Sprite_1.getNaturalHeight()/2+190;a.setXY(b,c);b=new ba;b.add(a);h.addChild(b)});xa.tween(c,2.5,{alpha:1},
1.4,null,na.cubeIn);c=j.addImageSprite(this.root,0,0,"fr_tree1",1,1,!1);c.owner.add(new Hb(25));c.disablePointer();f=c.y;f.set__(f._value-400);xa.tween(c,0.7,{y:0},0.2,null,na.circOut);f=j.addImageSprite(this.root,0,0,"fr_tree2",1,1,!1);f.owner.add(new Hb(25));f.disablePointer();f.y.set__(1100);xa.tween(f,0.7,{y:770},0.2,null,na.circOut);f=new Fb(0,1,1,200,1);c=j.addImageSprite(c.owner,1470,35,"bell",1,1,!0).owner;c=p.initAsCircle(c,function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=
new N,g.internal=!1);return g.BodyType_DYNAMIC}(this),f,!0,null,null,70);c.zpp_inner.wrap_shapes.at(0).translate(t.get(-6,-10,!0));p.initPivotJoint(p.space.zpp_inner.__static,c,t.get(1500,35,!0),t.get(0,-30,!0),!0,10,1);c=(new E(j.assets,"fx/fx3")).createEmitter();c.disablePointer();c.setXY(j.halfWidth,j.halfHeight);f=new ba;f.add(c);f.add(new Hb(10));a.owner.addChild(f);a=(new E(j.assets,"fx/fx4")).createEmitter();a.disablePointer();a.setXY(j.halfWidth,j.halfHeight);c=new ba;c.add(a);c.add(new Hb(5));
this.root.addChild(c);this.root.add(new ue)};aa.__name__=!0;aa.prototype={wrapLabelInHeight:function(a,b,c,d,e,f,h){for(null==h&&(h=!1);a.getNaturalHeight()>c;){d-=f;if(d<e)break;a.set_font(new xb(j.assets,b+"_"+d+"px"));h&&a.centerAnchor()}null},__class__:aa};var ue=function(){A.call(this)};ue.__name__=!0;ue.__super__=A;ue.prototype=y(A.prototype,{get_name:function(){return"MainSceneComp_0"},onAdded:function(){},onUpdate:function(){for(var a=aa.ribbonSprite,b=aa.ribbonBody,c=0,d=0,e=a.length;d<e;){var f=
d++,c=t.distance(t.get(a[f].x._value,a[f].y._value,!0),b[f].get_position());2>=c/(a[f].getNaturalHeight()/2)&&a[f].scaleY.set__(c/(a[f].getNaturalHeight()/2));a[f].rotation.set__(180*b[f].zpp_inner.rot/3.141592653589793)}},__class__:ue});var Je=function(){this.root=(new ba).add(new Dc);j.addButton(this.root,j.halfWidth,j.halfHeight,"btn_play",function(){j.goToScene((new aa).root)})};Je.__name__=!0;Je.prototype={__class__:Je};var I=function(){};I.__name__=!0;I.playSfx=function(a,b){null==b&&(b=1);
return I.isMuted?null:j.assets.getSound(I.soundsFolder+""+a).play(b)};I.playSoundtrack=function(a,b){null==b&&(b=1);var c=j.assets.getSound(I.soundsFolder+""+a);null!=I.cSoundtrackPlayback?I.cSoundtrackPlayback.get_sound()!=c&&(I.cSoundtrackVolume=b,I.cSoundtrackPlayback=c.loop(b)):(I.cSoundtrackVolume=b,I.cSoundtrackPlayback=c.loop(b));return I.cSoundtrackPlayback};I.muteSoundtrack=function(){null!=I.cSoundtrackPlayback&&(I.cSoundtrackPlayback.volume.animateTo(0,1),j.addDelay(null,0.8,function(){I.cSoundtrackPlayback.set_paused(!0)},
!1))};I.unmuteSoundtrack=function(){null!=I.cSoundtrackPlayback&&!I.isMuted&&(I.cSoundtrackPlayback.set_paused(!1),I.cSoundtrackPlayback.volume.animateTo(I.cSoundtrackVolume,1))};I.muteAll=function(){I.isMuted?(I.isMuted=!1,I.unmuteSoundtrack(),u.volume.animateTo(1,0)):(I.isMuted=!0,I.muteSoundtrack(),u.volume.animateTo(0,1))};var xa=function(){};xa.__name__=!0;xa.tween=function(a,b,c,d,e,f){null==d&&(d=0);var h=new qd;0>d&&(d=0);if(0==b&&0==d)xa.apply(a,c,e);else{if(0==b&&0<d){var i=new ba;0!=d&&
h.add(new ua(d));h.add(new Pb(function(){xa.apply(a,c,e);i.dispose()}));b=new Fc;u.root.addChild(i.add(b))}else{0<d&&h.add(new ua(d));for(var d=[],g=0,n=ma.fields(c);g<n.length;){var l=n[g];++g;var j=ma.getProperty(a,l);d.push(new Ld(j,ma.field(c,l),b,f))}f=new Md(d);h.add(f);var m=new ba;h.add(new ua(b));h.add(new Pb(function(){null!=e&&e();m.dispose()}));b=new Fc;u.root.addChild(m.add(b))}b.run(h)}};xa.apply=function(a,b,c){for(var d=0,e=ma.fields(b);d<e.length;){var f=e[d];++d;var h=ma.getProperty(a,
f);ga.__cast(h,C).set__(ma.field(b,f))}null!=c&&c()};var j=function(a,b){this.init=new kc;var c=this;j.width=a;j.height=b;j.halfWidth=a/2|0;j.halfHeight=b/2|0;j.director=(new ba).add(new M).add((new fe).setSize(j.width,j.height));u.root.addChild(j.director);j.systemBg=j.initFillSpriteComp(0,0,j.systemBgColor,0,0,1,!1);u.root.add(j.systemBg);u.loadAssetPack(Ba.fromAssets("boot")).get(function(a){j.assets=a;j.rotPhonePrompt=j.addFillSprite(u.root,0,0,1118481,u._platform.getStage().get_width(),u._platform.getStage().get_height(),
1,!1);a=j.addImageSprite(j.rotPhonePrompt.owner,0,0,"rot_phone");j.defaultOrientation==Ma.Landscape&&a.setRotation(90);(j.defaultOrientation==u._platform.getStage().orientation._value||null==u._platform.getStage().orientation._value)&&j.rotPhonePrompt.set_visible(!1);u._platform.getStage().lockOrientation(j.defaultOrientation);u._platform.getStage().requestFullscreen(!0);u._platform.getStage().orientation.get_changed().connect(G(c,c.onOrientationChange));u._platform.getStage().resize.connect(G(c,
c.onResize));c.onResize();c.initPreloaderScene()})};j.__name__=!0;j.onResizeCallback=function(){};j.onOrientationChangeCallback=function(){};j.goToScene=function(a,b){null==b&&(b=new pd(0.5,na.quadOut));j.director._compMap.Director_10.unwindToScene(a,b)};j.switchPack=function(a){0==a?j.assets=j.mainAssets:1==a&&(j.assets=j.extAssets)};j.initFillSpriteComp=function(a,b,c,d,e,f,h){null==h&&(h=!0);null==f&&(f=1);c=new $d(c,d,e);c.setXY(a,b);c.setAlpha(f);h&&c.centerAnchor();return c};j.initImageSpriteComp=
function(a,b,c,d,e,f,h){null==f&&(f=!0);null==e&&(e=1);null==d&&(d=1);var i=null;""!=c&&(i=j.assets.getTexture(c));null!=h&&(i=i.subTexture(h.x|0,h.y|0,h.width|0,h.height|0));c=new ic(i);c.setXY(a,b);c.setScale(d);c.setAlpha(e);f&&c.centerAnchor();return c};j.initTextSpriteComp=function(a,b,c,d,e,f,h){null==h&&(h="");null==f&&(f=!1);null==e&&(e=1);null==d&&(d=1);null==c&&(c="Label");""==h&&(h=j.defaultFont);c=new ae(new xb(j.assets,h),c);c.disablePointer();c.setXY(a,b);c.setScale(d);c.setAlpha(e);
f&&c.centerAnchor();return c};j.addFillSprite=function(a,b,c,d,e,f,h,i){null==i&&(i=!0);null==h&&(h=1);var g=new ba;g.add(new fc);b=j.initFillSpriteComp(b,c,d,e,f,h,i);g.add(b);null!=a&&a.addChild(g);return b};j.addImageSprite=function(a,b,c,d,e,f,h,i){null==h&&(h=!0);null==f&&(f=1);null==e&&(e=1);var g=new ba;g.add(new fc);b=j.initImageSpriteComp(b,c,d,e,f,h,i);g.add(b);null!=a&&a.addChild(g);return b};j.addLabel=function(a,b,c,d,e,f,h,i){null==i&&(i="");null==h&&(h=!1);null==f&&(f=1);null==e&&(e=
1);null==d&&(d="Label");var g=new ba;g.add(new fc);b=j.initTextSpriteComp(b,c,d,e,f,h,i);g.add(b);null!=a&&a.addChild(g);return b};j.addButton=function(a,b,c,d,e,f,h,i){null==i&&(i=1);null==h&&(h=1);null==f&&(f="");var g=new ba;a.addChild(g);var n=j.addImageSprite(g,b,c,d,h,i,!0).owner;j.useMouseHandCursor&&n.add(new nc);n.add(new Fc);var l=null;""!=f&&(l=j.addImageSprite(g,b,c,f,1,1,!0).owner,j.useMouseHandCursor&&l.add(new nc),l._compMap.Sprite_1.set_visible(!1));var m=h+0.15,r=new qd;r.add(new Pb(function(){n._compMap.Sprite_1.scaleX.animateTo(m,
0.2,na.backOut);n._compMap.Sprite_1.scaleY.animateTo(m,0.2,na.backOut)}));r.add(new ua(0.2));r.add(new Pb(function(){n._compMap.Sprite_1.scaleX.animateTo(h,0.1,na.quadIn);n._compMap.Sprite_1.scaleY.animateTo(h,0.1,na.quadIn)}));a=function(){n._compMap.Script_13.run(r)};b=function(){null!=l&&(0==(l._compMap.Sprite_1._flags&2)?(n._compMap.Sprite_1.set_visible(!1),l._compMap.Sprite_1.set_visible(!0)):(n._compMap.Sprite_1.set_visible(!0),l._compMap.Sprite_1.set_visible(!1)));""!=j.buttonClickSfx&&I.playSfx(j.buttonClickSfx);
null!=e&&e()};n._compMap.Disposer_12.connect1(n._compMap.Sprite_1.get_pointerDown(),a);n._compMap.Disposer_12.connect1(n._compMap.Sprite_1.get_pointerUp(),b);null!=l&&(l._compMap.Disposer_12.connect1(l._compMap.Sprite_1.get_pointerDown(),a),l._compMap.Disposer_12.connect1(l._compMap.Sprite_1.get_pointerUp(),b));return B.instance(n._compMap.Sprite_1,ic)};j.addMuteButton=function(a,b,c,d,e,f,h,i){null==i&&(i=1);null==h&&(h=1);return j.addButton(a,b,c,d,function(){I.muteAll()},e,h,i)};j.addDelay=function(a,
b,c,d,e){null==e&&(e=-1);null==d&&(d=!1);var f=new ba,h=new qd;h.add(new ua(b));h.add(new Pb(function(){null!=c&&c();d||f.dispose()}));b=new Fc;f.add(new fc);f.add(b);null!=a&&a.addChild(f);d?b.run(new ge(h,e)):b.run(h);return f};j.openUrl=function(a){u._platform.getWeb().openBrowser("http://"+a)};j.localPointerX=function(){return(u._platform.getPointer().get_x()-(u._platform.getStage().get_width()-j.width*j.scale)/2)/j.scale};j.localPointerY=function(){var a=0;"top"==j.rootContYAlign?a=u._platform.getPointer().get_y():
"middle"==j.rootContYAlign?a=u._platform.getPointer().get_y()-(u._platform.getStage().get_height()-j.height*j.scale)/2:"bottom"==j.rootContYAlign&&(a=u._platform.getPointer().get_y()-(u._platform.getStage().get_height()-j.height*j.scale));return a/j.scale};j.prototype={onResize:function(){var a=u._platform.getStage().get_width(),b=u._platform.getStage().get_height();j.scale=Math.min(a/j.width,b/j.height);var c=0;"top"==j.rootContYAlign?c=0:"middle"==j.rootContYAlign?c=0.5*b-0.5*j.scale*j.height:"bottom"==
j.rootContYAlign&&(c=b-j.scale*j.height);j.director._compMap.Sprite_1.setXY(0.5*a-0.5*j.scale*j.width,c);j.director._compMap.Sprite_1.setScale(j.scale);j.maskRootCont&&(j.director._compMap.Sprite_1.scissor=new Tc(0,0,j.width,j.height));j.systemBg.setXY(0,0);j.systemBg.setSize(a,b);j.onResizeCallback();j.rotPhonePrompt.setXY(0,0);j.rotPhonePrompt.setSize(u._platform.getStage().get_width(),u._platform.getStage().get_height());j.rotPhonePrompt.owner.firstChild._compMap.Sprite_1.setXY(j.rotPhonePrompt.width._value/
2,j.rotPhonePrompt.height._value/2);j.rotPhonePrompt.owner.firstChild._compMap.Sprite_1.setScale(j.scale)},onOrientationChange:function(a){j.onOrientationChangeCallback();j.defaultOrientation!=a?j.rotPhonePrompt.set_visible(!0):j.rotPhonePrompt.set_visible(!1)},initPreloaderScene:function(){var a=this,b=(new ba).add(new Dc),c=j.addFillSprite(b,0,0,j.systemBgColor,j.width,j.height,1,!1),d=j.addImageSprite(c.owner,j.halfWidth,j.halfHeight,"preloader"),e=u.loadAssetPack(Ba.fromAssets(j.mainAssetsFolder));
e.get(function(e){j.mainAssets=e;j.assets=j.mainAssets;j.settings=Vc.parse(e.getFile("settings.ini").toString());null!=j.extManifest?(e=u._platform.loadAssetPack(j.extManifest),e.get(function(d){j.extAssets=d;b.removeChild(c.owner);a.init.emit()}),e.progressChanged.connect(function(){var a=d.rotation;a.set__(a._value+50)})):(b.removeChild(c.owner),a.init.emit())});e.progressChanged.connect(function(){var a=d.rotation;a.set__(a._value+50)});j.goToScene(b)},__class__:j};var nc=function(){A.call(this)};
nc.__name__=!0;nc.__super__=A;nc.prototype=y(A.prototype,{get_name:function(){return"ButtonCursorComp_9"},onAdded:function(){this.owner._compMap.Disposer_12.connect1(this.owner._compMap.Sprite_1.get_pointerIn(),G(this,this.onPointerIn));this.owner._compMap.Disposer_12.connect1(this.owner._compMap.Sprite_1.get_pointerMove(),G(this,this.onPointerMove));this.owner._compMap.Disposer_12.connect1(this.owner._compMap.Sprite_1.get_pointerOut(),G(this,this.onPointerOut))},onPointerIn:function(){u._platform.getMouse().set_cursor(Ja.Button)},
onPointerMove:function(a){a.hit==this.owner._compMap.Sprite_1&&u._platform.getMouse().set_cursor(Ja.Button)},onPointerOut:function(){u._platform.getMouse().set_cursor(Ja.Default)},__class__:nc});var Hb=function(a,b){null==b&&(b=0.3);A.call(this);this.speed=a;this.tweenTime=b};Hb.__name__=!0;Hb.__super__=A;Hb.prototype=y(A.prototype,{get_name:function(){return"ParallaxMouseComp_7"},onAdded:function(){this.ownerSprite=this.owner._compMap.Sprite_1;this.sX=this.ownerSprite.x._value;this.prevPointerX=
u._platform.getPointer().get_x()},onUpdate:function(){u._platform.getPointer().get_x()!=this.prevPointerX&&this.ownerSprite.x.animateTo(this.sX-(u._platform.getPointer().get_x()-u._platform.getStage().get_width()/2)/this.speed,this.tweenTime);this.prevPointerX=u._platform.getPointer().get_x()},__class__:Hb});var Pd=function(a){A.call(this);this.body=a};Pd.__name__=!0;Pd.__super__=A;Pd.prototype=y(A.prototype,{get_name:function(){return"BodyComp_6"},onUpdate:function(){var a=bb.types[this.body.zpp_inner.type];
null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new N,g.internal=!1);a!=g.BodyType_STATIC&&(a=this.owner._compMap.Sprite_1,a.x.set__(this.body.get_position().get_x()),a.y.set__(this.body.get_position().get_y()),a.rotation.set__(180*this.body.zpp_inner.rot/3.141592653589793))},onRemoved:function(){this.body.set_space(null)},__class__:Pd});var ve=function(){this.dragging=this.foundBody=!1;A.call(this)};ve.__name__=!0;ve.__super__=A;ve.prototype=y(A.prototype,{get_name:function(){return"MouseJointComp_3"},
onAdded:function(){this.pivotJoint=new ud(p.space.zpp_inner.__static,null,t.get(0,0,!0),t.get(0,0,!0));this.pivotJoint.set_space(p.space);this.pivotJoint.set_active(!1);this.pivotJoint.set_stiff(!1)},onUpdate:function(){if(!this.dragging){var a=t.get(j.localPointerX(),j.localPointerY(),null);this.foundBody=!1;for(var b=p.space.bodiesUnderPoint(a).iterator();b.hasNext();)if(b.zpp_critical=!1,b.zpp_inner.at(b.zpp_i++).zpp_inner.type==g.id_BodyType_DYNAMIC){this.foundBody=!0;break}this.foundBody?u._platform.getMouse().set_cursor(Ja.Button):
u._platform.getMouse().set_cursor(Ja.Default);a.dispose()}if(u._platform.getPointer().isDown()&&!this.dragging){this.dragging=!0;a=t.get(j.localPointerX(),j.localPointerY(),null);for(b=p.space.bodiesUnderPoint(a).iterator();b.hasNext();){var c;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);if(c.zpp_inner.type==g.id_BodyType_DYNAMIC){this.pivotJoint.set_body2(c);this.pivotJoint.get_anchor2().set(c.worldPointToLocal(a,!0));this.pivotJoint.set_active(!0);break}}a.dispose()}else!u._platform.getPointer().isDown()&&
this.dragging&&(this.dragging=!1,this.pivotJoint.set_active(!1));this.pivotJoint.zpp_inner.active&&this.pivotJoint.get_anchor1().setxy(j.localPointerX(),j.localPointerY())},onRemoved:function(){this.pivotJoint.set_space(null)},__class__:ve});var p=function(a,b){null==b&&(b=400);null==a&&(a=0);var c=new we(a,b);p.space=c.space;u.root.addChild((new ba).add(c))};p.__name__=!0;p.enableMouseDragging=function(){u.root.add(new ve)};p.addBorder=function(a,b,c){null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=
new N,g.internal=!1);var d=new bd(g.BodyType_STATIC),e=c;null==e&&(e=new Tc(0,0,j.width,j.height));c=[];c.push(new pa(pa.rect(e.x,e.y,-10,e.height),a));c.push(new pa(pa.rect(e.x+e.width,e.y,10,e.height),a));c.push(new pa(pa.rect(e.x,e.y,e.width,-10),a));c.push(new pa(pa.rect(e.x,e.y+e.height,e.width,10),a));if(null==b){b=0;for(a=c.length;b<a;)e=b++,d.zpp_inner.wrap_shapes.add(c[e])}else{a=0;for(e=b.length;a<e;){var f=a++;1==b[f]&&d.zpp_inner.wrap_shapes.add(c[f])}}d.set_space(p.space)};p.initAsBox=
function(a,b,c,d,e,f,h,i){null==d&&(d=!0);var g=null;null!=a&&(g=a._compMap.Sprite_1);null!=g?(null==e&&(e=g.x._value),null==f&&(f=g.y._value),null==h&&(h=g.getNaturalWidth()),null==i&&(i=g.getNaturalHeight())):(null==e&&(e=50),null==f&&(f=50),null==h&&(h=100),null==i&&(i=100));b=new bd(b,t.get(e,f,!0));b.zpp_inner.wrap_shapes.add(new pa(pa.box(h,i),c));null!=g&&b.set_rotation(3.141592653589793*g.rotation._value/180);d&&b.set_space(p.space);null!=a&&a.add(new Pd(b));return b};p.initAsCircle=function(a,
b,c,d,e,f,h){null==d&&(d=!0);var i=null;null!=a&&(i=a._compMap.Sprite_1);null!=i?(null==e&&(e=i.x._value),null==f&&(f=i.y._value),null==h&&(h=i.getNaturalWidth()/2)):(null==e&&(e=50),null==f&&(f=50),null==h&&(h=50));b=new bd(b,t.get(e,f,!0));b.zpp_inner.wrap_shapes.add(new le(h,null,c));null!=i&&b.set_rotation(3.141592653589793*i.rotation._value/180);d&&b.set_space(p.space);null!=a&&a.add(new Pd(b));return b};p.initPivotJoint=function(a,b,c,d,e,f,h){a=new ud(a,b,c,d);null!=e&&(a.zpp_inner.stiff!=
e&&(a.zpp_inner.stiff=e,a.zpp_inner.wake()),a.zpp_inner.stiff);null!=f&&(a.zpp_inner.frequency!=f&&(a.zpp_inner.frequency=f,a.zpp_inner.stiff||a.zpp_inner.wake()),a.zpp_inner.frequency);null!=h&&(a.zpp_inner.damping!=h&&(a.zpp_inner.damping=h,a.zpp_inner.stiff||a.zpp_inner.wake()),a.zpp_inner.damping);a.set_space(p.space);return a};p.prototype={__class__:p};var we=function(a,b){A.call(this);this.space=new Cf(new t(a,b))};we.__name__=!0;we.__super__=A;we.prototype=y(A.prototype,{get_name:function(){return"SpaceComp_4"},
onUpdate:function(a){this.space.step(a,10,10)},__class__:we});var Sf=function(){};Sf.__name__=!0;Sf.parseQueryString=function(a,b){for(var c=a.split("&"),d,e=0,f=c.length;e<f;)if(d=e++,d=c[d].split("="),d[0]==b)return d[1];return""};var V=function(){};V.__name__=!0;V.Constraint=function(){return V._Constraint++};V.Interactor=function(){return V._Interactor++};V.CbType=function(){return V._CbType++};V.CbSet=function(){return V._CbSet++};var Yb=function(){this.body=this.constraint=null;this.pre_swapped=
!1;this.int1=this.int2=this.set=this.wrap_arbiters=this.pre_arbiter=null;this.length=0;this.listener=this.next=this.prev=null;this.event=0;this.outer_body=this.outer_con=this.outer_int=null;this.length=0};Yb.__name__=!0;Yb.prototype={wrapper_body:function(){null==this.outer_body&&(this.outer_body=new he,this.outer_body.zpp_inner=this);return this.outer_body},wrapper_con:function(){null==this.outer_con&&(this.outer_con=new sd,this.outer_con.zpp_inner=this);return this.outer_con},wrapper_int:function(){null==
this.outer_int&&(this.outer_int=new Wc,this.outer_int.zpp_inner=this);null==this.wrap_arbiters?this.wrap_arbiters=Ub.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters;this.wrap_arbiters.zpp_inner.zip_length=!0;this.wrap_arbiters.zpp_inner.at_ite=null;return this.outer_int},push:function(a){null!=this.prev?this.prev.next=a:this.next=a;a.prev=this.prev;a.next=null;this.prev=a;this.length++},pop:function(){var a=this.next;this.next=a.next;null==this.next?this.prev=null:this.next.prev=
null;this.length--;return a},empty:function(){return null==this.next},__class__:Yb};var T=function(){this.interactors=this.constraints=null;this.zip_conlisteners=!1;this.conlisteners=null;this.zip_bodylisteners=!1;this.bodylisteners=null;this.zip_listeners=!1;this.manager=this.cbpairs=this.listeners=null;this.id=0;this.next=null;this.count=0;this.cbTypes=null;this.cbTypes=new Zb;this.listeners=new wd;this.zip_listeners=!0;this.bodylisteners=new xe;this.zip_bodylisteners=!0;this.conlisteners=new ye;
this.zip_conlisteners=!0;this.constraints=new Hc;this.interactors=new Ic;this.id=V.CbSet();this.cbpairs=new Df};T.__name__=!0;T.setlt=function(a,b){for(var c=a.cbTypes.head,d=b.cbTypes.head;null!=c&&null!=d;){var e=c.elt,f=d.elt;if(e.id<f.id)return!0;if(f.id<e.id)return!1;c=c.next;d=d.next}return null!=d&&null==c};T.get=function(a){var b;null==T.zpp_pool?b=new T:(b=T.zpp_pool,T.zpp_pool=b.next,b.next=null);null;for(var c=null,a=a.head;null!=a;){var d=a.elt,c=b.cbTypes.insert(c,d);d.cbsets.add(b);
a=a.next}return b};T.single_intersection=function(a,b,c){return a.manager.pair(a,b).single_intersection(c)};T.find_all=function(a,b,c,d){a.manager.pair(a,b).forall(c,d)};T.prototype={invalidate_pairs:function(){for(var a=this.cbpairs.head;null!=a;)a.elt.zip_listeners=!0,a=a.next},realvalidate_listeners:function(){this.listeners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.listeners.head,d=a.elt.listeners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==
c||ka.setlt(e,c.elt)?(e.space==this.manager.space&&(b=this.listeners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},realvalidate_bodylisteners:function(){this.bodylisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.bodylisteners.head,d=a.elt.bodylisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||ka.setlt(e,c.elt)?(!e.options.excluded(this.cbTypes)&&e.space==this.manager.space&&(b=this.bodylisteners.inlined_insert(b,e)),d=d.next):
(b=c,c=c.next)}a=a.next}},realvalidate_conlisteners:function(){this.conlisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.conlisteners.head,d=a.elt.conlisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||ka.setlt(e,c.elt)?(!e.options.excluded(this.cbTypes)&&e.space==this.manager.space&&(b=this.conlisteners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners());
this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners());this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},free:function(){this.listeners.clear();this.zip_listeners=!0;this.bodylisteners.clear();this.zip_bodylisteners=!0;this.conlisteners.clear();for(this.zip_conlisteners=!0;null!=this.cbTypes.head;)this.cbTypes.pop_unsafe().cbsets.remove(this)},__class__:T};var Ca=function(){this.listeners=null;this.zip_listeners=!1;this.a=this.b=this.next=
null;this.listeners=new wd};Ca.__name__=!0;Ca.get=function(a,b){var c;null==Ca.zpp_pool?c=new Ca:(c=Ca.zpp_pool,Ca.zpp_pool=c.next,c.next=null);c.zip_listeners=!0;T.setlt(a,b)?(c.a=a,c.b=b):(c.a=b,c.b=a);return c};Ca.setlt=function(a,b){return T.setlt(a.a,b.a)||a.a==b.a&&T.setlt(a.b,b.b)};Ca.prototype={__validate:function(){this.listeners.clear();for(var a=this.a.listeners.head,b=this.b.listeners.head;null!=a&&null!=b;){var c=a.elt,d=b.elt;c==d?((c.options1.compatible(this.a.cbTypes)&&c.options2.compatible(this.b.cbTypes)||
c.options2.compatible(this.a.cbTypes)&&c.options1.compatible(this.b.cbTypes))&&this.listeners.add(c),a=a.next,b=b.next):c.precedence>d.precedence||c.precedence==d.precedence&&c.id>d.id?a=a.next:b=b.next}},empty_intersection:function(){return null==this.listeners.head},single_intersection:function(a){var b=this.listeners.head;return null!=b&&b.elt==a&&null==b.next},forall:function(a,b){for(var c=this.listeners.head;null!=c;){var d=c.elt;d.event==a&&b(d);c=c.next}},__class__:Ca};var wd=function(){this.length=
0;this.modified=this.pushmod=!1;this.head=null};wd.__name__=!0;wd.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Da.zpp_pool?b=new Da:(b=Da.zpp_pool,Da.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_insert:function(a,b){var c;null==Da.zpp_pool?c=new Da:(c=Da.zpp_pool,Da.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=
this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Da.zpp_pool;Da.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=
!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Da.zpp_pool;Da.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:wd};var xe=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};xe.__name__=!0;xe.prototype={inlined_insert:function(a,b){var c;null==ib.zpp_pool?c=new ib:
(c=ib.zpp_pool,ib.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=ib.zpp_pool;ib.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=
!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ib.zpp_pool;ib.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:xe};var ye=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};ye.__name__=!0;ye.prototype={inlined_insert:function(a,
b){var c;null==Ib.zpp_pool?c=new Ib:(c=Ib.zpp_pool,Ib.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ib.zpp_pool;Ib.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==
a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ib.zpp_pool;Ib.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},__class__:ye};var Hc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Hc.__name__=
!0;Hc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==ha.zpp_pool?b=new ha:(b=ha.zpp_pool,ha.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==ha.zpp_pool?c=new ha:(c=ha.zpp_pool,ha.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=
this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=ha.zpp_pool;ha.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},
erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ha.zpp_pool;ha.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Hc};var Ic=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ic.__name__=
!0;Ic.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==$b.zpp_pool?b=new $b:(b=$b.zpp_pool,$b.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=$b.zpp_pool;$b.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=$b.zpp_pool;$b.zpp_pool=a;this.modified=!0;this.length--;
this.pushmod=!0;return c},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Ic};var Jc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Jc.__name__=!0;Jc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Na.zpp_pool?b=new Na:(b=Na.zpp_pool,Na.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Na.zpp_pool;Na.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);
d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Na.zpp_pool;Na.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Jc};var va=function(){this.cbsets=this.listeners=this.bodylisteners=this.conlisteners=null;this.id=0;this.outer=null;this.id=V.CbType();this.listeners=new wd;this.bodylisteners=new xe;this.conlisteners=
new ye;this.constraints=new Hc;this.interactors=new Ic;this.cbsets=new Jc};va.__name__=!0;va.prototype={addint:function(a){for(var b=null,c=this.listeners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.listeners.inlined_insert(b,a);this.invalidateint()},invalidateint:function(){for(var a=this.cbsets.head;null!=a;){var b=a.elt;b.zip_listeners=!0;b.invalidate_pairs();a=a.next}},addbody:function(a){for(var b=null,c=this.bodylisteners.head;null!=
c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.bodylisteners.inlined_insert(b,a);this.invalidatebody()},invalidatebody:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_bodylisteners=!0,a=a.next},addconstraint:function(a){for(var b=null,c=this.conlisteners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.conlisteners.inlined_insert(b,a);this.invalidateconstraint()},
invalidateconstraint:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_conlisteners=!0,a=a.next},__class__:va};var g=function(){};g.__name__=!0;var ka=function(){this.body=this.constraint=this.interaction=this.space=null;this.id=this.type=this.event=this.precedence=0;this.outer=null};ka.__name__=!0;ka.setlt=function(a,b){return a.precedence>b.precedence||a.precedence==b.precedence&&a.id>b.id};ka.prototype={addedToSpace:function(){},removedFromSpace:function(){},__class__:ka};var Ef=function(){this.outer_zn=
this.options=this.handler=null};Ef.__name__=!0;Ef.__super__=ka;Ef.prototype=y(ka.prototype,{addedToSpace:function(){this.options.handler=G(this,this.cbtype_change);for(var a=this.options.includes.head;null!=a;)a.elt.addbody(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=a;){var b=a.elt;b.bodylisteners.remove(this);b.invalidatebody();a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();this.options.effect_change(a,b,c);this.addedToSpace()},
__class__:Ef});var Ff=function(){this.outer_zn=this.options=this.handler=null};Ff.__name__=!0;Ff.__super__=ka;Ff.prototype=y(ka.prototype,{addedToSpace:function(){this.options.handler=G(this,this.cbtype_change);for(var a=this.options.includes.head;null!=a;)a.elt.addconstraint(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=a;){var b=a.elt;b.conlisteners.remove(this);b.invalidateconstraint();a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();
this.options.effect_change(a,b,c);this.addedToSpace()},__class__:Ff});var Zb=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Zb.__name__=!0;Zb.prototype={inlined_add:function(a){var b;null==Ta.zpp_pool?b=new Ta:(b=Ta.zpp_pool,Ta.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Ta.zpp_pool?c=new Ta:(c=Ta.zpp_pool,Ta.zpp_pool=
c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ta.zpp_pool;Ta.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ta.zpp_pool;Ta.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},has:function(a){return this.inlined_has(a)},
inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Zb};var Ua=function(){this.handlerp=null;this.allowSleepingCallbacks=this.pure=!1;this.options1=this.options2=this.handleri=null;this.itype=0;this.outer_zni=this.outer_znp=null};Ua.__name__=!0;Ua.__super__=ka;Ua.prototype=y(ka.prototype,{CbSetset:function(a,b,c){for(var d=Ua.UCbSet,e=Ua.VCbSet,f=Ua.WCbSet,
a=a.head,h=b.head;null!=a&&null!=h;){var i=a.elt,g=h.elt;i==g?(f.inlined_add(i),a=a.next,h=h.next):T.setlt(i,g)?(d.inlined_add(i),a=a.next):(e.inlined_add(g),h=h.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=h;)e.inlined_add(h.elt),h=h.next;for(;null!=d.head;){a=d.pop_unsafe();for(h=b.head;null!=h;)c(a,h.elt),h=h.next}for(;null!=e.head;){b=e.pop_unsafe();for(d=f.head;null!=d;)c(b,d.elt),d=d.next}for(;null!=f.head;){e=f.pop_unsafe();c(e,e);for(b=f.head;null!=b;)c(e,b.elt),b=b.next}},
CbTypeset:function(a,b,c){for(var d=Ua.UCbType,e=Ua.VCbType,f=Ua.WCbType,a=a.head,h=b.head;null!=a&&null!=h;){var i=a.elt,g=h.elt;i==g?(f.inlined_add(i),a=a.next,h=h.next):i.id<g.id?(d.inlined_add(i),a=a.next):(e.inlined_add(g),h=h.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=h;)e.inlined_add(h.elt),h=h.next;for(;null!=d.head;){a=d.pop_unsafe();for(h=b.head;null!=h;)c(a,h.elt),h=h.next}for(;null!=e.head;){b=e.pop_unsafe();for(d=f.head;null!=d;)c(b,d.elt),d=d.next}for(;null!=f.head;){e=
f.pop_unsafe();c(e,e);for(b=f.head;null!=b;)c(e,b.elt),b=b.next}},with_uniquesets:function(a){var b=this,c;null==W.zpp_pool?c=new W:(c=W.zpp_pool,W.zpp_pool=c.next,c.next=null);null;c.lt=Ca.setlt;this.CbTypeset(this.options1.includes,this.options2.includes,function(a,d){b.CbSetset(a.cbsets,d.cbsets,function(a,d){a.validate();d.validate();T.single_intersection(a,d,b)&&c.try_insert(Ca.get(a,d))})});c.clear_with(function(c){a?b.space.freshListenerType(c.a,c.b):b.space.nullListenerType(c.a,c.b);c.a=c.b=
null;c.listeners.clear();c.next=Ca.zpp_pool;Ca.zpp_pool=c});var d=c;d.data=null;d.lt=null;d.swapped=null;d.next=W.zpp_pool;W.zpp_pool=d},with_union:function(a){for(var b=this.options1.includes.head,c=this.options2.includes.head;null!=b&&null!=c;){var d=b.elt,e=c.elt;d==e?(a(d),b=b.next,c=c.next):d.id<e.id?(a(d),b=b.next):(a(e),c=c.next)}for(;null!=b;)a(b.elt),b=b.next;for(;null!=c;)a(c.elt),c=c.next},addedToSpace:function(){var a=this,b=this.type==g.id_ListenerType_PRE;this.with_union(function(c){c.addint(a);
if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next});this.options1.handler=G(this,this.cbtype_change1);this.options2.handler=G(this,this.cbtype_change2);this.with_uniquesets(!0)},removedFromSpace:function(){var a=this;this.with_uniquesets(!1);var b=this.type==g.id_ListenerType_PRE;this.with_union(function(c){c.listeners.remove(a);c.invalidateint();if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next});this.options1.handler=null;this.options2.handler=null},cbtype_change1:function(a,
b,c){this.cbtype_change(this.options1,a,b,c)},cbtype_change2:function(a,b,c){this.cbtype_change(this.options2,a,b,c)},cbtype_change:function(a,b,c,d){this.removedFromSpace();a.effect_change(b,c,d);this.addedToSpace();null},__class__:Ua});var oc=function(){this.pre_dt=0;this.cbTypes=this.cbSet=null;this.ignore=this.__velocity=!1;this.component=null;this.breakUnderForce=this.breakUnderError=this.removeOnBreak=!1;this.frequency=this.damping=this.maxForce=this.maxError=0;this.active=this.stiff=!1;this.compound=
this.space=null;this.id=0;this.outer=null;this.__velocity=!1;this.id=V.Constraint();this.active=this.stiff=!0;this.ignore=!1;this.frequency=10;this.damping=1;this.maxError=this.maxForce=Math.POSITIVE_INFINITY;this.breakUnderForce=!1;this.removeOnBreak=!0;this.pre_dt=-1;this.cbTypes=new Zb};oc.__name__=!0;oc.prototype={immutable_midstep:function(){},insert_cbtype:function(a){if(!this.cbTypes.has(a)){null!=this.space&&(this.dealloc_cbSet(),a.constraints.add(this));for(var b=null,c=this.cbTypes.head;null!=
c&&!(a.id<c.elt.id);){b=c;c=c.next}this.cbTypes.inlined_insert(b,a);null!=this.space&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){if(null!=(this.cbSet=this.space.cbsets.get(this.cbTypes)))this.cbSet.count++,this.cbSet.constraints.add(this)},dealloc_cbSet:function(){if(null!=this.cbSet){this.cbSet.constraints.remove(this);if(0==--this.cbSet.count){this.space.cbsets.remove(this.cbSet);var a=this.cbSet;a.free();a.next=T.zpp_pool;T.zpp_pool=a}this.cbSet=null}},activate:function(){null!=
this.space&&this.activeInSpace()},deactivate:function(){null!=this.space&&this.inactiveOrOutSpace()},addedToSpace:function(){this.active&&this.activeInSpace();this.activeBodies();for(var a=this.cbTypes.head;null!=a;)a.elt.constraints.add(this),a=a.next},removedFromSpace:function(){this.active&&this.inactiveOrOutSpace();this.inactiveBodies();for(var a=this.cbTypes.head;null!=a;)a.elt.constraints.remove(this),a=a.next},activeInSpace:function(){this.alloc_cbSet();null==Z.zpp_pool?this.component=new Z:
(this.component=Z.zpp_pool,Z.zpp_pool=this.component.next,this.component.next=null);null;this.component.isBody=!1;this.component.constraint=this},inactiveOrOutSpace:function(){this.dealloc_cbSet();var a=this.component;a.body=null;a.constraint=null;null;a.next=Z.zpp_pool;Z.zpp_pool=a;this.component=null},activeBodies:function(){},inactiveBodies:function(){},clearcache:function(){},wake_connected:function(){},forest:function(){},pair_exists:function(){return!1},broken:function(){},warmStart:function(){},
preStep:function(){return!1},applyImpulseVel:function(){return!1},applyImpulsePos:function(){return!1},wake:function(){null!=this.space&&this.space.wake_constraint(this)},__class__:oc};var td=function(){this.stepped=!1;this.kMassa=this.kMassb=this.kMassc=this.jAccx=this.jAccy=this.jMax=this.gamma=this.biasx=this.biasy=0;this.wrap_a2=null;this.a2localx=this.a2localy=this.a2relx=this.a2rely=0;this.wrap_a1=this.b2=null;this.a1localx=this.a1localy=this.a1relx=this.a1rely=0;this.outer_zn=this.b1=null;
oc.call(this);this.stepped=!1;this.jAccy=this.jAccx=0;this.jMax=Math.POSITIVE_INFINITY;this.a2rely=this.a2relx=this.a2localy=this.a2localx=this.a1rely=this.a1relx=this.a1localy=this.a1localx=0};td.__name__=!0;td.__super__=oc;td.prototype=y(oc.prototype,{activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},
validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(a){this.immutable_midstep("Constraint::a1");this.a1localx=a.x;this.a1localy=a.y;this.wake()},setup_a1:function(){this.wrap_a1=t.get(this.a1localx,this.a1localy,null);this.wrap_a1.zpp_inner._inuse=!0;this.wrap_a1.zpp_inner._validate=G(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=G(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx;
this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(a){this.immutable_midstep("Constraint::a2");this.a2localx=a.x;this.a2localy=a.y;this.wake()},setup_a2:function(){this.wrap_a2=t.get(this.a2localx,this.a2localy,null);this.wrap_a2.zpp_inner._inuse=!0;this.wrap_a2.zpp_inner._validate=G(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=G(this,this.invalidate_a2)},wake_connected:function(){null!=this.b1&&this.b1.type==g.id_BodyType_DYNAMIC&&this.b1.wake();null!=this.b2&&this.b2.type==
g.id_BodyType_DYNAMIC&&this.b2.wake()},forest:function(){if(this.b1.type==g.id_BodyType_DYNAMIC){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;else{a=this.b1.component;for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=
b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(this.b2.type==g.id_BodyType_DYNAMIC){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=
a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&this.b2.id==b||this.b1.id==b&&this.b2.id==a},clearcache:function(){this.jAccy=this.jAccx=0;this.pre_dt=-1},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.stepped=!0;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=
this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var c=this.b1.smass+this.b2.smass;this.kMassa=c;this.kMassb=0;this.kMassc=c;if(0!=this.b1.sinertia){var c=this.a1relx*this.b1.sinertia,d=this.a1rely*this.b1.sinertia;this.kMassa+=d*this.a1rely;this.kMassb+=-d*this.a1relx;this.kMassc+=c*this.a1relx}0!=this.b2.sinertia&&(c=this.a2relx*this.b2.sinertia,d=this.a2rely*this.b2.sinertia,this.kMassa+=d*this.a2rely,this.kMassb+=-d*this.a2relx,this.kMassc+=c*this.a2relx);c=this.kMassa*this.kMassc-this.kMassb*
this.kMassb;c!=c?(this.kMassa=this.kMassb=this.kMassc=0,c=3):0==c?(c=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,c|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,c|=2),this.kMassb=0):(c=1/c,d=this.kMassc*c,this.kMassc=this.kMassa*c,this.kMassa=d,this.kMassb*=-c,c=0);0!=(c&1)&&(this.jAccx=0);0!=(c&2)&&(this.jAccy=0);if(this.stiff)this.gamma=this.biasy=this.biasx=0;else{d=2*Math.PI*this.frequency;this.gamma=1/(a*d*(2*this.damping+d*a));c=1/(1+this.gamma);d=a*d*d*this.gamma;
this.gamma*=c;this.kMassa*=c;this.kMassb*=c;this.kMassc*=c;this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);if(this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy>this.maxError*this.maxError)return!0;c=-d;this.biasx*=c;this.biasy*=c;c=this.maxError;d=this.biasx*this.biasx+this.biasy*this.biasy;d>c*c&&(c*=1/Math.sqrt(d),this.biasx*=c,this.biasy*=c)}this.jAccx*=b;this.jAccy*=b;this.jMax=this.maxForce*a;return!1},
warmStart:function(){var a=this.b1.imass;this.b1.velx-=this.jAccx*a;this.b1.vely-=this.jAccy*a;a=this.b2.imass;this.b2.velx+=this.jAccx*a;this.b2.vely+=this.jAccy*a;this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely)*this.b1.iinertia;this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely)*this.b2.iinertia},applyImpulseVel:function(){var a=0,b=0,a=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+
this.b1.kinangvel)),b=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel)),c=0,d=0,c=this.biasx-a,d=this.biasy-b,a=this.kMassa*c+this.kMassb*d,d=this.kMassb*c+this.kMassc*d,b=this.gamma,c=a-this.jAccx*b,d=d-this.jAccy*b,b=a=0,a=this.jAccx,b=this.jAccy;this.jAccx+=1*c;this.jAccy+=1*d;if(this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else this.stiff||
(c=this.jMax,d=this.jAccx*this.jAccx+this.jAccy*this.jAccy,d>c*c&&(c*=1/Math.sqrt(d),this.jAccx*=c,this.jAccy*=c));c=this.jAccx-a;d=this.jAccy-b;a=this.b1.imass;this.b1.velx-=c*a;this.b1.vely-=d*a;a=this.b2.imass;this.b2.velx+=c*a;this.b2.vely+=d*a;this.b1.angvel-=(d*this.a1relx-c*this.a1rely)*this.b1.iinertia;this.b2.angvel+=(d*this.a2relx-c*this.a2rely)*this.b2.iinertia;return!1},applyImpulsePos:function(){var a=0,b=0,a=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,b=this.a1localx*this.b1.axisx+
this.a1localy*this.b1.axisy,c=0,d=0,c=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,d=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,e=0,f=0,e=this.b2.posx+c-(this.b1.posx+a),f=this.b2.posy+d-(this.b1.posy+b);if(this.breakUnderError&&e*e+f*f>this.maxError*this.maxError)return!0;if(e*e+f*f<m.constraintLinearSlop*m.constraintLinearSlop)return!1;var e=0.5*e,f=0.5*f,h=0,i=0;if(6<e*e+f*f&&(i=this.b1.smass+this.b2.smass,i>m.epsilon)){var i=0.75/i,h=-e*i,i=-f*i,g=h*h+i*i;400<g&&(g=20*
(1/Math.sqrt(g)),h*=g,i*=g);g=this.b1.imass;this.b1.posx-=h*g;this.b1.posy-=i*g;g=this.b2.imass;this.b2.posx+=h*g;this.b2.posy+=i*g;e=this.b2.posx+c-(this.b1.posx+a);f=this.b2.posy+d-(this.b1.posy+b);e*=0.5;f*=0.5}var n=g=0,l=0,g=h=this.b1.smass+this.b2.smass,n=0,l=h;0!=this.b1.sinertia&&(h=a*this.b1.sinertia,i=b*this.b1.sinertia,g+=i*b,n+=-i*a,l+=h*a);0!=this.b2.sinertia&&(h=c*this.b2.sinertia,i=d*this.b2.sinertia,g+=i*d,n+=-i*c,l+=h*c);h=-e;i=-f;e=h*h+i*i;36<e&&(e=6*(1/Math.sqrt(e)),h*=e,i*=e);
e=g*l-n*n;e!=e?h=i=0:0==e?(h=0!=g?h/g:0,i=0!=l?i/l:0):(e=1/e,l=e*(l*h-n*i),i=e*(g*i-n*h),h=l);g=this.b1.imass;this.b1.posx-=h*g;this.b1.posy-=i*g;g=this.b2.imass;this.b2.posx+=h*g;this.b2.posy+=i*g;this.b1.delta_rot(-(i*a-h*b)*this.b1.iinertia);this.b2.delta_rot((i*c-h*d)*this.b2.iinertia);return!1},__class__:td});var D=function(){this.colarb=this.fluidarb=this.sensorarb=null;this.type=0;this.b1=this.b2=this.ws1=this.ws2=this.pair=null;this.invalidated=!1;this.immState=0;this.intchange=this.presentable=
this.continuous=this.fresh=!1;this.present=0;this.active=this.cleared=this.sleeping=!1;this.id=this.di=this.stamp=this.up_stamp=this.sleep_stamp=this.endGenerated=0;this.outer=null};D.__name__=!0;D.prototype={wrapper:function(){null==this.outer&&(D.internal=!0,this.type==D.COL?(this.colarb.outer_zn=new Zc,this.outer=this.colarb.outer_zn):this.type==D.FLUID?(this.fluidarb.outer_zn=new je,this.outer=this.fluidarb.outer_zn):this.outer=new Yc,this.outer.zpp_inner=this,D.internal=!1);return this.outer},
__class__:D};var Va=function(){this.next=null;D.call(this);this.type=D.SENSOR;this.sensorarb=this};Va.__name__=!0;Va.__super__=D;Va.prototype=y(D.prototype,{retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=Va.zpp_pool;Va.zpp_pool=this},__class__:Va});var ya=function(){this.wMass=this.adamp=this.agamma=this.vMassa=this.vMassb=
this.vMassc=this.dampx=this.dampy=this.lgamma=this.nx=this.ny=this.buoyx=this.buoyy=this.pre_dt=0;this.nodrag=!1;this.centroidx=this.centroidy=this.overlap=this.r1x=this.r1y=this.r2x=this.r2y=0;this.outer_zn=this.next=null;D.call(this);this.type=D.FLUID;this.fluidarb=this;this.buoyy=this.buoyx=0;this.pre_dt=-1};ya.__name__=!0;ya.__super__=D;ya.prototype=y(D.prototype,{retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&
(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=ya.zpp_pool;ya.zpp_pool=this;this.pre_dt=-1},preStep:function(a,b){-1==this.pre_dt&&(this.pre_dt=b);var c=b/this.pre_dt;this.pre_dt=b;this.r1x=this.centroidx-this.b1.posx;this.r1y=this.centroidy-this.b1.posy;this.r2x=this.centroidx-this.b2.posx;this.r2y=this.centroidy-this.b2.posy;var d=0,e=0;this.ws1.fluidEnabled&&null!=this.ws1.fluidProperties.wrap_gravity?(d=this.ws1.fluidProperties.gravityx,e=this.ws1.fluidProperties.gravityy):
(d=a.gravityx,e=a.gravityy);var f=0,h=0;this.ws2.fluidEnabled&&null!=this.ws2.fluidProperties.wrap_gravity?(f=this.ws2.fluidProperties.gravityx,h=this.ws2.fluidProperties.gravityy):(f=a.gravityx,h=a.gravityy);var i=0,k=0;if(this.ws1.fluidEnabled&&this.ws2.fluidEnabled){var n=this.overlap*this.ws1.fluidProperties.density,l=this.overlap*this.ws2.fluidProperties.density;if(n>l)f=n+l,i-=d*f,k-=e*f;else if(n<l)d=n+l,i+=f*d,k+=h*d;else{var j=0,r=0,j=0.5*(d+f),r=0.5*(e+h);this.ws1.worldCOMx*j+this.ws1.worldCOMy*
r>this.ws2.worldCOMx*j+this.ws2.worldCOMy*r?(d=n+l,i-=j*d,k-=r*d):(d=n+l,i+=j*d,k+=r*d)}}else this.ws1.fluidEnabled?(f=this.overlap*this.ws1.fluidProperties.density,i-=d*f,k-=e*f):this.ws2.fluidEnabled&&(d=this.overlap*this.ws2.fluidProperties.density,i+=f*d,k+=h*d);i*=b;k*=b;this.buoyx=i;this.buoyy=k;this.b1.type==g.id_BodyType_DYNAMIC&&(d=this.b1.imass,this.b1.velx-=i*d,this.b1.vely-=k*d,this.b1.angvel-=(k*this.r1x-i*this.r1y)*this.b1.iinertia);this.b2.type==g.id_BodyType_DYNAMIC&&(d=this.b2.imass,
this.b2.velx+=i*d,this.b2.vely+=k*d,this.b2.angvel+=(k*this.r2x-i*this.r2y)*this.b2.iinertia);if((!this.ws1.fluidEnabled||0==this.ws1.fluidProperties.viscosity)&&(!this.ws2.fluidEnabled||0==this.ws2.fluidProperties.viscosity))this.nodrag=!0,this.adamp=this.dampy=this.dampx=0;else{this.nodrag=!1;i=0;this.ws1.fluidEnabled&&(this.ws2.validate_angDrag(),i+=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area);this.ws2.fluidEnabled&&(this.ws1.validate_angDrag(),i+=this.ws2.fluidProperties.viscosity*
this.ws1.angDrag*this.overlap/this.ws1.area);0!=i?(k=this.b1.sinertia+this.b2.sinertia,this.wMass=0!=k?1/k:0,i=2*Math.PI*4.0E-4*i,this.agamma=1/(b*i*(2+i*b)),i=1/(1+this.agamma),this.agamma*=i,this.wMass*=i):this.agamma=this.wMass=0;i=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel));k=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+
this.b1.kinangvel));i*i+k*k<m.epsilon*m.epsilon||(d=1/Math.sqrt(i*i+k*k),this.nx=i*d,this.ny=k*d);i=0;if(this.ws1.fluidEnabled)if(k=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area,this.ws2.type==g.id_ShapeType_CIRCLE)i-=k*this.ws2.circle.radius*m.fluidLinearDrag/(2*this.ws2.circle.radius*Math.PI);else{e=d=0;for(f=this.ws2.polygon.edges.head;null!=f;)h=f.elt,d+=h.length,h=k*h.length*(h.gnormx*this.nx+h.gnormy*this.ny),0<h&&(h=h*=-m.fluidVacuumDrag),e-=0.5*h*m.fluidLinearDrag,f=f.next;
i+=e/d}if(this.ws2.fluidEnabled)if(k=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area,this.ws1.type==g.id_ShapeType_CIRCLE)i-=k*this.ws1.circle.radius*m.fluidLinearDrag/(2*this.ws1.circle.radius*Math.PI);else{e=d=0;for(f=this.ws1.polygon.edges.head;null!=f;)h=f.elt,d+=h.length,h=k*h.length*(h.gnormx*this.nx+h.gnormy*this.ny),0<h&&(h=h*=-m.fluidVacuumDrag),e-=0.5*h*m.fluidLinearDrag,f=f.next;i+=e/d}0!=i?(f=this.b1.smass+this.b2.smass,e=d=k=0,k=f,d=0,e=f,0!=this.b1.sinertia&&(f=this.r1x*
this.b1.sinertia,h=this.r1y*this.b1.sinertia,k+=h*this.r1y,d+=-h*this.r1x,e+=f*this.r1x),0!=this.b2.sinertia&&(f=this.r2x*this.b2.sinertia,h=this.r2y*this.b2.sinertia,k+=h*this.r2y,d+=-h*this.r2x,e+=f*this.r2x),f=k*e-d*d,f!=f?(k=d=e=0,3):0==f?(f=0,0!=k?k=1/k:(k=0,f|=1),0!=e?e=1/e:(e=0,f|=2),d=0,f):(f=1/f,h=e*f,e=k*f,k=h,d*=-f,0),this.vMassa=k,this.vMassb=d,this.vMassc=e,i*=2*Math.PI,this.lgamma=1/(b*i*(2+i*b)),i=1/(1+this.lgamma),this.lgamma*=i,this.vMassa*=i,this.vMassb*=i,this.vMassc*=i):this.lgamma=
this.vMassc=this.vMassb=this.vMassa=0}this.dampx*=c;this.dampy*=c;this.adamp*=c},warmStart:function(){var a=this.b1.imass;this.b1.velx-=this.dampx*a;this.b1.vely-=this.dampy*a;a=this.b2.imass;this.b2.velx+=this.dampx*a;this.b2.vely+=this.dampy*a;this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-this.dampx*this.r1y);this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y);this.b1.angvel-=this.adamp*this.b1.iinertia;this.b2.angvel+=this.adamp*this.b2.iinertia},applyImpulseVel:function(){if(!this.nodrag){var a=
this.b1.angvel+this.b1.kinangvel,b=this.b2.angvel+this.b2.kinangvel,c=this.b1.velx+this.b1.kinvelx-this.r1y*a-(this.b2.velx+this.b2.kinvelx-this.r2y*b),d=this.b1.vely+this.b1.kinvely+this.r1x*a-(this.b2.vely+this.b2.kinvely+this.r2x*b),e=this.vMassa*c+this.vMassb*d,d=this.vMassb*c+this.vMassc*d,f=this.lgamma,c=e-this.dampx*f,d=d-this.dampy*f;this.dampx+=1*c;this.dampy+=1*d;e=this.b1.imass;this.b1.velx-=c*e;this.b1.vely-=d*e;e=this.b2.imass;this.b2.velx+=c*e;this.b2.vely+=d*e;this.b1.angvel-=this.b1.iinertia*
(d*this.r1x-c*this.r1y);this.b2.angvel+=this.b2.iinertia*(d*this.r2x-c*this.r2y);a=(a-b)*this.wMass-this.adamp*this.agamma;this.adamp+=a;this.b1.angvel-=a*this.b1.iinertia;this.b2.angvel+=a*this.b2.iinertia}},__class__:ya});var Ea=function(){this.pre_dt=0;this.stat=!1;this.next=null;this.hc2=this.hpc2=!1;this.c1=this.oc1=this.c2=this.oc2=null;this.__ref_vertex=0;this.__ref_edge1=this.__ref_edge2=null;this.biasCoef=0;this.rev=!1;this.nx=this.ny=this.kMassa=this.kMassb=this.kMassc=this.Ka=this.Kb=this.Kc=
this.rMass=this.jrAcc=this.rn1a=this.rt1a=this.rn1b=this.rt1b=this.rn2a=this.rt2a=this.rn2b=this.rt2b=this.k1x=this.k1y=this.k2x=this.k2y=this.surfacex=this.surfacey=this.lnormx=this.lnormy=this.lproj=this.radius=0;this.s1=this.s2=this.contacts=this.innards=null;this.userdef_dyn_fric=this.userdef_stat_fric=this.userdef_restitution=this.userdef_rfric=!1;this.dyn_fric=this.stat_fric=this.restitution=this.rfric=0;this.outer_zn=null;D.call(this);this.pre_dt=-1;this.contacts=new O;this.innards=new ze;
this.type=D.COL;this.colarb=this};Ea.__name__=!0;Ea.__super__=D;Ea.prototype=y(D.prototype,{injectContact:function(a,b,c,d,e,f,h){null==h&&(h=!1);for(var i=null,g=this.contacts.next;null!=g;){var n=g;if(f==n.hash){i=n;break}g=g.next}null==i?(null==O.zpp_pool?i=new O:(i=O.zpp_pool,O.zpp_pool=i.next,i.next=null),null,g=i.inner,g.jnAcc=g.jtAcc=0,i.hash=f,i.fresh=!0,i.arbiter=this,this.jrAcc=0,this.contacts.inlined_add(i),this.innards.add(g)):i.fresh=!1;i.px=a;i.py=b;this.nx=c;this.ny=d;i.dist=e;i.stamp=
this.stamp;i.posOnly=h;return i},retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;for(this.intchange=this.active=!1;null!=this.contacts.next;){var a=this.contacts.inlined_pop_unsafe();a.arbiter=null;a.next=O.zpp_pool;O.zpp_pool=a;this.innards.inlined_pop()}this.userdef_rfric=this.userdef_restitution=this.userdef_stat_fric=this.userdef_dyn_fric=!1;this.__ref_edge1=
this.__ref_edge2=null;this.next=Ea.zpp_pool;Ea.zpp_pool=this;this.pre_dt=-1},cleanupContacts:function(){var a=!0,b=null,c=null,d=this.innards.next;this.hc2=!1;for(var e=this.contacts.next;null!=e;){var f=e;f.stamp+m.arbiterExpirationDelay<this.stamp?(e=this.contacts.inlined_erase(b),d=this.innards.inlined_erase(c),f.arbiter=null,f.next=O.zpp_pool,O.zpp_pool=f):(b=f.inner,c=f.active,f.active=f.stamp==this.stamp,f.active&&(a?(a=!1,this.c1=b,this.oc1=f):(this.hc2=!0,this.c2=b,this.oc2=f)),c!=f.active&&
(this.contacts.modified=!0),b=e,c=d,d=d.next,e=e.next)}this.hc2?(this.hpc2=!0,this.oc1.posOnly?(d=this.c1,this.c1=this.c2,this.c2=d,d=this.oc1,this.oc1=this.oc2,this.oc2=d,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;return a},preStep:function(a){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.restitution=this.s1.material.elasticity<=Math.NEGATIVE_INFINITY||this.s2.material.elasticity<=Math.NEGATIVE_INFINITY?0:this.s1.material.elasticity>=
Math.POSITIVE_INFINITY||this.s2.material.elasticity>=Math.POSITIVE_INFINITY?1:(this.s1.material.elasticity+this.s2.material.elasticity)/2,0>this.restitution&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*
this.s2.material.rollingFriction)));-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;var c=this.b1.smass+this.b2.smass;this.hc2=!1;a=!0;this.biasCoef=this.b1.type!=g.id_BodyType_DYNAMIC||this.b2.type!=g.id_BodyType_DYNAMIC?this.continuous?m.contactContinuousStaticBiasCoef:m.contactStaticBiasCoef:this.continuous?m.contactContinuousBiasCoef:m.contactBiasCoef;this.continuous=!1;for(var d=null,e=null,f=this.innards.next,h=this.contacts.next;null!=h;){var i=h;if(i.stamp+m.arbiterExpirationDelay<
this.stamp)h=this.contacts.inlined_erase(d),f=this.innards.inlined_erase(e),i.arbiter=null,i.next=O.zpp_pool,O.zpp_pool=i;else{d=i.inner;e=i.active;i.active=i.stamp==this.stamp;if(i.active){a?(a=!1,this.c1=d,this.oc1=i):(this.hc2=!0,this.c2=d,this.oc2=i);d.r2x=i.px-this.b2.posx;d.r2y=i.py-this.b2.posy;d.r1x=i.px-this.b1.posx;d.r1y=i.py-this.b1.posy;var k=c+this.b2.sinertia*Qd.sqr(d.r2x*this.nx+d.r2y*this.ny),k=k+this.b1.sinertia*Qd.sqr(d.r1x*this.nx+d.r1y*this.ny);d.tMass=k<m.epsilon*m.epsilon?0:
1/k;k=c+this.b2.sinertia*Qd.sqr(this.ny*d.r2x-this.nx*d.r2y);k+=this.b1.sinertia*Qd.sqr(this.ny*d.r1x-this.nx*d.r1y);d.nMass=k<m.epsilon*m.epsilon?0:1/k;var n=k=0,l=this.b2.angvel+this.b2.kinangvel,k=this.b2.velx+this.b2.kinvelx-d.r2y*l,n=this.b2.vely+this.b2.kinvely+d.r2x*l,l=this.b1.angvel+this.b1.kinangvel,k=k-(this.b1.velx+this.b1.kinvelx-d.r1y*l),n=n-(this.b1.vely+this.b1.kinvely+d.r1x*l),l=this.nx*k+this.ny*n;i.elasticity=this.restitution;d.bounce=l*i.elasticity;d.bounce>-m.elasticThreshold&&
(d.bounce=0);l=n*this.nx-k*this.ny;k=m.staticFrictionThreshold;d.friction=l*l>k*k?this.dyn_fric:this.stat_fric;d.jnAcc*=b;d.jtAcc*=b}e!=i.active&&(this.contacts.modified=!0);d=h;e=f;f=f.next;h=h.next}}this.hc2?(this.hpc2=!0,this.oc1.posOnly?(f=this.c1,this.c1=this.c2,this.c2=f,f=this.oc1,this.oc1=this.oc2,this.oc2=f,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;this.jrAcc*=b;a||(this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y,this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*
this.ny,this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y,this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny,this.k1x=this.b2.kinvelx-this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel),this.k1y=this.b2.kinvely+this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel));this.hc2&&(this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y,this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny,this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y,this.rt2b=this.c2.r2x*this.nx+
this.c2.r2y*this.ny,this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel),this.k2y=this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*this.b1.kinangvel),this.kMassa=c+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b,this.kMassb=c+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b,this.kMassc=c+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b,this.kMassa*
this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<m.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)?(this.Ka=this.kMassa,this.Kb=this.kMassb,this.Kc=this.kMassc,b=this.kMassa*this.kMassc-this.kMassb*this.kMassb,b!=b?(this.kMassa=this.kMassb=this.kMassc=0,3):0==b?(b=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,b|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,b|=2),this.kMassb=0,b):(b=1/b,c=this.kMassc*b,this.kMassc=this.kMassa*b,this.kMassa=
c,this.kMassb*=-b,0)):(this.hc2=!1,this.oc2.dist<this.oc1.dist&&(b=this.c1,this.c1=this.c2,this.c2=b),this.oc2.active=!1,this.contacts.modified=!0));this.surfacex=this.b2.svelx;this.surfacey=this.b2.svely;this.surfacex+=1*this.b1.svelx;this.surfacey+=1*this.b1.svely;this.surfacex=-this.surfacex;this.surfacey=-this.surfacey;this.rMass=this.b1.sinertia+this.b2.sinertia;0!=this.rMass&&(this.rMass=1/this.rMass);return a},warmStart:function(){var a=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc,b=this.ny*
this.c1.jnAcc+this.nx*this.c1.jtAcc,c=this.b1.imass;this.b1.velx-=a*c;this.b1.vely-=b*c;this.b1.angvel-=this.b1.iinertia*(b*this.c1.r1x-a*this.c1.r1y);c=this.b2.imass;this.b2.velx+=a*c;this.b2.vely+=b*c;this.b2.angvel+=this.b2.iinertia*(b*this.c1.r2x-a*this.c1.r2y);this.hc2&&(a=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc,b=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc,c=this.b1.imass,this.b1.velx-=a*c,this.b1.vely-=b*c,this.b1.angvel-=this.b1.iinertia*(b*this.c2.r1x-a*this.c2.r1y),c=this.b2.imass,this.b2.velx+=
a*c,this.b2.vely+=b*c,this.b2.angvel+=this.b2.iinertia*(b*this.c2.r2x-a*this.c2.r2y));this.b2.angvel+=this.jrAcc*this.b2.iinertia;this.b1.angvel-=this.jrAcc*this.b1.iinertia},applyImpulseVel:function(){var a,b,c,d,e;d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel);var f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);c=(f*this.nx-d*this.ny+this.surfacex)*this.c1.tMass;d=this.c1.friction*this.c1.jnAcc;a=this.c1.jtAcc;
e=a-c;e>d?e=d:e<-d&&(e=-d);c=e-a;this.c1.jtAcc=e;a=-this.ny*c;b=this.nx*c;this.b2.velx+=a*this.b2.imass;this.b2.vely+=b*this.b2.imass;this.b1.velx-=a*this.b1.imass;this.b1.vely-=b*this.b1.imass;this.b2.angvel+=this.rt1b*c*this.b2.iinertia;this.b1.angvel-=this.rt1a*c*this.b1.iinertia;this.hc2?(e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),c=(b*this.nx-e*this.ny+
this.surfacex)*this.c2.tMass,d=this.c2.friction*this.c2.jnAcc,a=this.c2.jtAcc,e=a-c,e>d?e=d:e<-d&&(e=-d),c=e-a,this.c2.jtAcc=e,a=-this.ny*c,b=this.nx*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=this.rt2b*c*this.b2.iinertia,this.b1.angvel-=this.rt2a*c*this.b1.iinertia,d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-
(this.b1.vely+this.c1.r1x*this.b1.angvel),e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),c=this.c1.jnAcc,a=this.c2.jnAcc,d=d*this.nx+f*this.ny+this.surfacey+this.c1.bounce-(this.Ka*c+this.Kb*a),e=e*this.nx+b*this.ny+this.surfacey+this.c2.bounce-(this.Kb*c+this.Kc*a),b=-(this.kMassa*d+this.kMassb*e),f=-(this.kMassb*d+this.kMassc*e),0<=b&&0<=f?(d=b-c,e=f-a,this.c1.jnAcc=
b,this.c2.jnAcc=f):(b=-this.c1.nMass*d,0<=b&&0<=this.Kb*b+e?(d=b-c,e=-a,this.c1.jnAcc=b,this.c2.jnAcc=0):(f=-this.c2.nMass*e,0<=f&&0<=this.Kb*f+d?(d=-c,e=f-a,this.c1.jnAcc=0,this.c2.jnAcc=f):0<=d&&0<=e?(d=-c,e=-a,this.c1.jnAcc=this.c2.jnAcc=0):e=d=0)),c=d+e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=(this.rn1b*d+this.rn2b*e)*this.b2.iinertia,this.b1.angvel-=(this.rn1a*d+this.rn2a*e)*
this.b1.iinertia):(0!=this.radius&&(c=(this.b2.angvel-this.b1.angvel)*this.rMass,d=this.rfric*this.c1.jnAcc,a=this.jrAcc,this.jrAcc-=c,this.jrAcc>d?this.jrAcc=d:this.jrAcc<-d&&(this.jrAcc=-d),c=this.jrAcc-a,this.b2.angvel+=c*this.b2.iinertia,this.b1.angvel-=c*this.b1.iinertia),d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),f=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),c=(this.c1.bounce+(this.nx*d+this.ny*
f)+this.surfacey)*this.c1.nMass,a=this.c1.jnAcc,e=a-c,0>e&&(e=0),c=e-a,this.c1.jnAcc=e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=this.rn1b*c*this.b2.iinertia,this.b1.angvel-=this.rn1a*c*this.b1.iinertia)},applyImpulsePos:function(){if(2==this.ptype){var a=this.c1,b=0,c=0,b=this.b2.axisy*a.lr2x-this.b2.axisx*a.lr2y,c=a.lr2x*this.b2.axisx+a.lr2y*this.b2.axisy,b=b+1*this.b2.posx,c=c+
1*this.b2.posy,d=0,e=0,d=this.b1.axisy*a.lr1x-this.b1.axisx*a.lr1y,e=a.lr1x*this.b1.axisx+a.lr1y*this.b1.axisy,d=d+1*this.b1.posx,e=e+1*this.b1.posy,f=a=0,a=b-d,f=c-e,h=Math.sqrt(a*a+f*f),i=this.radius-m.collisionSlop,g=h-i;0>a*this.nx+f*this.ny&&(a=-a,f=-f,g-=this.radius);0>g&&(h<m.epsilon?0!=this.b1.smass?this.b1.posx+=10*m.epsilon:this.b2.posx+=10*m.epsilon:(g=1/h,a*=g,f*=g,b=0.5*(d+b),c=0.5*(e+c),d=b-this.b1.posx,e=c-this.b1.posy,b-=this.b2.posx,c-=this.b2.posy,d=f*d-a*e,b=f*b-a*c,c=this.b2.smass+
b*b*this.b2.sinertia+this.b1.smass+d*d*this.b1.sinertia,0!=c&&(h=-this.biasCoef*(h-i)/c,c=i=0,i=a*h,c=f*h,a=this.b1.imass,this.b1.posx-=i*a,this.b1.posy-=c*a,this.b1.delta_rot(-d*this.b1.iinertia*h),a=this.b2.imass,this.b2.posx+=i*a,this.b2.posy+=c*a,this.b2.delta_rot(b*this.b2.iinertia*h))))}else{var n=g=f=a=0,e=b=0;0==this.ptype?(a=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy,f=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy,i=this.lproj+(a*this.b1.posx+f*this.b1.posy),g=this.b2.axisy*
this.c1.lr1x-this.b2.axisx*this.c1.lr1y,n=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy,g+=1*this.b2.posx,n+=1*this.b2.posy,this.hpc2&&(b=this.b2.axisy*this.c2.lr1x-this.b2.axisx*this.c2.lr1y,e=this.c2.lr1x*this.b2.axisx+this.c2.lr1y*this.b2.axisy,b+=1*this.b2.posx,e+=1*this.b2.posy)):(a=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy,f=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy,i=this.lproj+(a*this.b2.posx+f*this.b2.posy),g=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y,
n=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy,g+=1*this.b1.posx,n+=1*this.b1.posy,this.hpc2&&(b=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y,e=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy,b+=1*this.b1.posx,e+=1*this.b1.posy));h=g*a+n*f-i-this.radius;h+=m.collisionSlop;c=0;this.hpc2&&(c=b*a+e*f-i-this.radius,c+=m.collisionSlop);if(0>h||0>c){this.rev&&(a=-a,f=-f);var l=0,j=0,l=g-this.b1.posx,j=n-this.b1.posy,d=i=0,i=g-this.b2.posx,d=n-this.b2.posy,r=0,L=0,n=g=0;if(this.hpc2){r=
b-this.b1.posx;L=e-this.b1.posy;g=b-this.b2.posx;n=e-this.b2.posy;b=f*l-a*j;i=f*i-a*d;e=f*r-a*L;d=f*g-a*n;g=this.b1.smass+this.b2.smass;this.kMassa=g+this.b1.sinertia*b*b+this.b2.sinertia*i*i;this.kMassb=g+this.b1.sinertia*b*e+this.b2.sinertia*i*d;this.kMassc=g+this.b1.sinertia*e*e+this.b2.sinertia*d*d;l=n=g=0;g=this.kMassa;n=this.kMassb;l=this.kMassc;j=h*this.biasCoef;r=c*this.biasCoef;c=h=0;h=-j;c=-r;L=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(L!=L)h=c=0;else if(0==L)h=0!=this.kMassa?h/
this.kMassa:0,c=0!=this.kMassc?c/this.kMassc:0;else var L=1/L,o=L*(this.kMassc*h-this.kMassb*c),c=L*(this.kMassa*c-this.kMassb*h),h=o;0<=h&&0<=c?(g=(h+c)*this.b1.imass,this.b1.posx-=a*g,this.b1.posy-=f*g,this.b1.delta_rot(-this.b1.iinertia*(b*h+e*c)),b=(h+c)*this.b2.imass,this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(i*h+d*c))):(h=-j/g,c=0,0<=h&&0<=n*h+r?(g=(h+c)*this.b1.imass,this.b1.posx-=a*g,this.b1.posy-=f*g,this.b1.delta_rot(-this.b1.iinertia*(b*h+e*c)),b=(h+c)*this.b2.imass,
this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(i*h+d*c))):(h=0,c=-r/l,0<=c&&0<=n*c+j&&(g=(h+c)*this.b1.imass,this.b1.posx-=a*g,this.b1.posy-=f*g,this.b1.delta_rot(-this.b1.iinertia*(b*h+e*c)),b=(h+c)*this.b2.imass,this.b2.posx+=a*b,this.b2.posy+=f*b,this.b2.delta_rot(this.b2.iinertia*(i*h+d*c)))))}else b=f*l-a*j,i=f*i-a*d,c=this.b2.smass+i*i*this.b2.sinertia+this.b1.smass+b*b*this.b1.sinertia,0!=c&&(h=-this.biasCoef*h/c,d=c=0,c=a*h,d=f*h,a=this.b1.imass,this.b1.posx-=c*a,
this.b1.posy-=d*a,this.b1.delta_rot(-b*this.b1.iinertia*h),a=this.b2.imass,this.b2.posx+=c*a,this.b2.posy+=d*a,this.b2.delta_rot(i*this.b2.iinertia*h))}}},__class__:Ea});var O=function(){this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.dist=this.elasticity=0;this.fresh=!1;this.stamp=this.hash=0;this.active=this.posOnly=!1;this.arbiter=this.inner=null;this.px=this.py=0;this.outer=null;this.inner=new ze};O.__name__=!0;O.prototype={wrapper:function(){null==this.outer&&(O.internal=
!0,this.outer=new uf,O.internal=!1,this.outer.zpp_inner=this);return this.outer},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==
this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:O};var ze=function(){this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.r1x=this.r1y=this.r2x=this.r2y=this.nMass=this.tMass=this.bounce=this.friction=this.jnAcc=this.jtAcc=this.lr1x=this.lr1y=this.lr2x=this.lr2y=0};ze.__name__=!0;ze.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=
!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:ze};var wa=function(){this.collisionGroup=this.collisionMask=
this.sensorGroup=this.sensorMask=this.fluidGroup=this.fluidMask=0;this.next=this.outer=this.shapes=null;this.shapes=new Kc;this.collisionGroup=this.sensorGroup=this.fluidGroup=1;this.collisionMask=this.sensorMask=this.fluidMask=-1};wa.__name__=!0;wa.prototype={wrapper:function(){if(null==this.outer){this.outer=new vf;var a=this.outer.zpp_inner;a.outer=null;a.next=wa.zpp_pool;wa.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},shouldCollide:function(a){return 0!=(this.collisionMask&a.collisionGroup)&&
0!=(a.collisionMask&this.collisionGroup)},shouldSense:function(a){return 0!=(this.sensorMask&a.sensorGroup)&&0!=(a.sensorMask&this.sensorGroup)},shouldFlow:function(a){return 0!=(this.fluidMask&a.fluidGroup)&&0!=(a.fluidMask&this.fluidGroup)},invalidate:function(){for(var a=this.shapes.head;null!=a;)a.elt.invalidate_filter(),a=a.next},__class__:wa};var qa=function(){this.wrap_max=null;this.maxx=this.maxy=0;this.wrap_min=null;this.minx=this.miny=0;this.outer=this.next=null;this._immutable=!1;this._invalidate=
this._validate=null};qa.__name__=!0;qa.get=function(a,b,c,d){var e;null==qa.zpp_pool?e=new qa:(e=qa.zpp_pool,qa.zpp_pool=e.next,e.next=null);null;e.minx=a;e.miny=b;e.maxx=c;e.maxy=d;return e};qa.prototype={validate:function(){null!=this._validate&&this._validate()},perimeter:function(){return 2*(this.maxx-this.minx+(this.maxy-this.miny))},intersectY:function(a){return!(a.miny>this.maxy||this.miny>a.maxy)},intersect:function(a){return a.miny<=this.maxy&&this.miny<=a.maxy&&a.minx<=this.maxx&&this.minx<=
a.maxx},combine:function(a){a.minx<this.minx&&(this.minx=a.minx);a.maxx>this.maxx&&(this.maxx=a.maxx);a.miny<this.miny&&(this.miny=a.miny);a.maxy>this.maxy&&(this.maxy=a.maxy)},contains:function(a){return a.minx>=this.minx&&a.miny>=this.miny&&a.maxx<=this.maxx&&a.maxy<=this.maxy},containsPoint:function(a){return a.x>=this.minx&&a.x<=this.maxx&&a.y>=this.miny&&a.y<=this.maxy},setCombine:function(a,b){this.minx=a.minx<b.minx?a.minx:b.minx;this.miny=a.miny<b.miny?a.miny:b.miny;this.maxx=a.maxx>b.maxx?
a.maxx:b.maxx;this.maxy=a.maxy>b.maxy?a.maxy:b.maxy},setExpand:function(a,b){this.minx=a.minx-b;this.miny=a.miny-b;this.maxx=a.maxx+b;this.maxy=a.maxy+b},toString:function(){return"{ x: "+this.minx+" y: "+this.miny+" w: "+(this.maxx-this.minx)+" h: "+(this.maxy-this.miny)+" }"},__class__:qa};var Lc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Lc.__name__=!0;Lc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Oa.zpp_pool?b=new Oa:
(b=Oa.zpp_pool,Oa.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Oa.zpp_pool?c=new Oa:(c=Oa.zpp_pool,Oa.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=
a.next;a.elt=null;a.next=Oa.zpp_pool;Oa.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Oa.zpp_pool;Oa.zpp_pool=
a;this.modified=!0;this.length--;this.pushmod=!0;return c},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Lc};var o=function(){};o.__name__=!0;o.circleContains=function(a,b){var c=0,d=0,c=b.x-a.worldCOMx,d=b.y-a.worldCOMy;return c*c+d*d<a.radius*a.radius};o.polyContains=function(a,b){var c;c=!0;for(var d=a.edges.head;null!=d;){var e=d.elt;if(e.gnormx*b.x+e.gnormy*b.y<=e.gprojection)d=
d.next;else{c=!1;break}}return c};o.contactCollide=function(a,b,c,d){if(b.type==g.id_ShapeType_POLYGON)if(a.type==g.id_ShapeType_POLYGON){for(var e=!0,f=-1.0E100,h=-1,i=null,k=null,n=a.polygon.edges.head;null!=n;){for(var l=n.elt,j=1.0E100,r=b.polygon.gverts.next;null!=r;){var L=r,L=l.gnormx*L.x+l.gnormy*L.y;L<j&&(j=L);if(j-l.gprojection<=f)break;r=r.next}j-=l.gprojection;if(0<=j){e=!1;break}j>f&&(f=j,i=l,h=1);n=n.next}if(e){for(n=b.polygon.edges.head;null!=n;){l=n.elt;j=1.0E100;for(r=a.polygon.gverts.next;null!=
r;){L=r;L=l.gnormx*L.x+l.gnormy*L.y;L<j&&(j=L);if(j-l.gprojection<=f)break;r=r.next}j-=l.gprojection;if(0<=j){e=!1;break}j>f&&(f=j,k=l,h=2);n=n.next}if(e){1==h?(a=b.polygon,b=i,k=1):(a=a.polygon,b=k,k=-1);i=null;e=1.0E100;for(f=a.edges.head;null!=f;)n=f.elt,l=b.gnormx*n.gnormx+b.gnormy*n.gnormy,l<e&&(e=l,i=n),f=f.next;var f=e=0,e=i.gp0.x,f=i.gp0.y,l=n=0,n=i.gp1.x,l=i.gp1.y,r=j=0,j=n-e,r=l-f,o=b.gnormy*e-b.gnormx*f,L=b.gnormy*n-b.gnormx*l,t=1/(L-o),o=(-b.tp1-o)*t;o>m.epsilon&&(e+=j*o,f+=r*o);L=(-b.tp0-
L)*t;L<-m.epsilon&&(n+=j*L,l+=r*L);r=j=0;r=k;j=b.gnormx*r;r*=b.gnormy;c.lnormx=b.lnormx;c.lnormy=b.lnormy;c.lproj=b.lprojection;c.radius=0;c.rev=d!=(-1==k);c.ptype=c.rev?1:0;L=e*b.gnormx+f*b.gnormy-b.gprojection;k=n*b.gnormx+l*b.gnormy-b.gprojection;if(0<L&&0<k)return!1;d&&(j=-j,r=-r);d=c.injectContact(e-0.5*b.gnormx*L,f-0.5*b.gnormy*L,j,r,L,c.rev?1:0,0<L);e-=1*a.body.posx;f-=1*a.body.posy;d.inner.lr1x=e*a.body.axisy+f*a.body.axisx;d.inner.lr1y=f*a.body.axisy-e*a.body.axisx;d=c.injectContact(n-0.5*
b.gnormx*k,l-0.5*b.gnormy*k,j,r,k,c.rev?0:1,0<k);n-=1*a.body.posx;l-=1*a.body.posy;d.inner.lr1x=n*a.body.axisy+l*a.body.axisx;d.inner.lr1y=l*a.body.axisy-n*a.body.axisx;1==h?(c.__ref_edge1=b,c.__ref_edge2=i):(c.__ref_edge2=b,c.__ref_edge1=i);return!0}}}else{k=-1.0E100;i=!0;e=h=null;f=b.polygon.gverts.next;for(n=b.polygon.edges.head;null!=n;){l=n.elt;j=l.gnormx*a.circle.worldCOMx+l.gnormy*a.circle.worldCOMy-l.gprojection-a.circle.radius;if(0<j){i=!1;break}j>k&&(k=j,h=l,e=f);f=f.next;n=n.next}if(i){i=
e;e=null==e.next?b.polygon.gverts.next:e.next;f=a.circle.worldCOMy*h.gnormx-a.circle.worldCOMx*h.gnormy;if(f<=i.y*h.gnormx-i.x*h.gnormy)return k=a.circle.radius,f=e=0,e=i.x-a.circle.worldCOMx,f=i.y-a.circle.worldCOMy,n=e*e+f*f,n>k*k?k=null:n<m.epsilon*m.epsilon?k=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-k,0,null):(n=1/Math.sqrt(n),l=n<m.epsilon?1.0E100:1/n,j=0.5+(a.circle.radius-0.5*k)*n,k=d?c.injectContact(a.circle.worldCOMx+e*j,a.circle.worldCOMy+f*j,-e*n,-f*n,l-k,0,null):c.injectContact(a.circle.worldCOMx+
e*j,a.circle.worldCOMy+f*j,e*n,f*n,l-k,0,null)),null!=k&&(e=k.inner,c.ptype=2,n=f=0,f=i.x-b.polygon.body.posx,n=i.y-b.polygon.body.posy,c.__ref_edge1=h,c.__ref_vertex=-1,d?(e.lr1x=f*b.polygon.body.axisy+n*b.polygon.body.axisx,e.lr1y=n*b.polygon.body.axisy-f*b.polygon.body.axisx,e.lr2x=a.circle.localCOMx,e.lr2y=a.circle.localCOMy):(e.lr2x=f*b.polygon.body.axisy+n*b.polygon.body.axisx,e.lr2y=n*b.polygon.body.axisy-f*b.polygon.body.axisx,e.lr1x=a.circle.localCOMx,e.lr1y=a.circle.localCOMy),c.radius=
a.circle.radius),null!=k;if(f>=e.y*h.gnormx-e.x*h.gnormy)return i=a.circle.radius,f=k=0,k=e.x-a.circle.worldCOMx,f=e.y-a.circle.worldCOMy,n=k*k+f*f,n>i*i?i=null:n<m.epsilon*m.epsilon?i=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-i,0,null):(n=1/Math.sqrt(n),l=n<m.epsilon?1.0E100:1/n,j=0.5+(a.circle.radius-0.5*i)*n,i=d?c.injectContact(a.circle.worldCOMx+k*j,a.circle.worldCOMy+f*j,-k*n,-f*n,l-i,0,null):c.injectContact(a.circle.worldCOMx+k*j,a.circle.worldCOMy+f*j,k*n,f*n,l-i,0,null)),
null!=i&&(k=i.inner,c.ptype=2,n=f=0,f=e.x-b.polygon.body.posx,n=e.y-b.polygon.body.posy,c.__ref_edge1=h,c.__ref_vertex=1,d?(k.lr1x=f*b.polygon.body.axisy+n*b.polygon.body.axisx,k.lr1y=n*b.polygon.body.axisy-f*b.polygon.body.axisx,k.lr2x=a.circle.localCOMx,k.lr2y=a.circle.localCOMy):(k.lr2x=f*b.polygon.body.axisy+n*b.polygon.body.axisx,k.lr2y=n*b.polygon.body.axisy-f*b.polygon.body.axisx,k.lr1x=a.circle.localCOMx,k.lr1y=a.circle.localCOMy),c.radius=a.circle.radius),null!=i;i=b=0;i=a.circle.radius+
0.5*k;b=h.gnormx*i;i*=h.gnormy;f=e=0;e=a.circle.worldCOMx-b;f=a.circle.worldCOMy-i;b=d?c.injectContact(e,f,h.gnormx,h.gnormy,k,0,null):c.injectContact(e,f,-h.gnormx,-h.gnormy,k,0,null);c.ptype=d?0:1;c.lnormx=h.lnormx;c.lnormy=h.lnormy;c.rev=!d;c.lproj=h.lprojection;c.radius=a.circle.radius;b.inner.lr1x=a.circle.localCOMx;b.inner.lr1y=a.circle.localCOMy;c.__ref_edge1=h;c.__ref_vertex=0;return!0}}else if(h=a.circle.radius+b.circle.radius,k=i=0,i=b.circle.worldCOMx-a.circle.worldCOMx,k=b.circle.worldCOMy-
a.circle.worldCOMy,e=i*i+k*k,e>h*h?h=null:e<m.epsilon*m.epsilon?h=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-h,0,null):(e=1/Math.sqrt(e),f=e<m.epsilon?1.0E100:1/e,n=0.5+(a.circle.radius-0.5*h)*e,h=d?c.injectContact(a.circle.worldCOMx+i*n,a.circle.worldCOMy+k*n,-i*e,-k*e,f-h,0,null):c.injectContact(a.circle.worldCOMx+i*n,a.circle.worldCOMy+k*n,i*e,k*e,f-h,0,null)),null!=h)return h=h.inner,d?(h.lr1x=b.circle.localCOMx,h.lr1y=b.circle.localCOMy,h.lr2x=a.circle.localCOMx,h.lr2y=a.circle.localCOMy):
(h.lr1x=a.circle.localCOMx,h.lr1y=a.circle.localCOMy,h.lr2x=b.circle.localCOMx,h.lr2y=b.circle.localCOMy),c.radius=a.circle.radius+b.circle.radius,c.ptype=2,!0;return!1};o.testCollide_safe=function(a,b){if(b.type==g.id_ShapeType_CIRCLE)var c=a,a=b,b=c;return o.testCollide(a,b)};o.testCollide=function(a,b){if(b.type==g.id_ShapeType_POLYGON){if(a.type==g.id_ShapeType_POLYGON){for(var c=!0,d=a.polygon.edges.head;null!=d;){for(var e=d.elt,f=1.0E100,h=b.polygon.gverts.next;null!=h;){var i=h,i=e.gnormx*
i.x+e.gnormy*i.y;i<f&&(f=i);h=h.next}f-=e.gprojection;if(0<f){c=!1;break}d=d.next}if(c){for(d=b.polygon.edges.head;null!=d;){e=d.elt;f=1.0E100;for(h=a.polygon.gverts.next;null!=h;)i=h,i=e.gnormx*i.x+e.gnormy*i.y,i<f&&(f=i),h=h.next;f-=e.gprojection;if(0<f){c=!1;break}d=d.next}return c}}else{d=c=null;e=!0;f=-1.0E100;h=b.polygon.gverts.next;for(i=b.polygon.edges.head;null!=i;){var k=i.elt,n=k.gnormx*a.circle.worldCOMx+k.gnormy*a.circle.worldCOMy-k.gprojection-a.circle.radius;if(0<n){e=!1;break}n>f&&
(f=n,c=k,d=h);h=h.next;i=i.next}if(e){e=d;d=null==d.next?b.polygon.gverts.next:d.next;f=a.circle.worldCOMy*c.gnormx-a.circle.worldCOMx*c.gnormy;if(f<=e.y*c.gnormx-e.x*c.gnormy)return c=a.circle.radius,f=d=0,d=e.x-a.circle.worldCOMx,f=e.y-a.circle.worldCOMy,d*d+f*f<=c*c;return f>=d.y*c.gnormx-d.x*c.gnormy?(c=a.circle.radius,f=e=0,e=d.x-a.circle.worldCOMx,f=d.y-a.circle.worldCOMy,e*e+f*f<=c*c):!0}}return!1}c=a.circle.radius+b.circle.radius;e=d=0;d=b.circle.worldCOMx-a.circle.worldCOMx;e=b.circle.worldCOMy-
a.circle.worldCOMy;return d*d+e*e<=c*c};o.flowCollide=function(a,b,c){if(b.type==g.id_ShapeType_POLYGON){if(a.type==g.id_ShapeType_POLYGON){for(var d=[],e=[],f=!0,h=!0,i=a.polygon.edges.head;null!=i;){for(var k=i.elt,n=1.0E100,l=0,j=b.polygon.gverts.next;null!=j;){var r=j,L=k.gnormx*r.x+k.gnormy*r.y;L<n&&(n=L);L>=k.gprojection+m.epsilon&&(e[l]=!0,h=!1);l++;j=j.next}n-=k.gprojection;if(0<n){f=!1;break}i=i.next}if(h)return b.polygon.validate_worldCOM(),c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,
c.centroidy=b.polygon.worldCOMy,null,!0;if(f){for(var h=!0,t=b.polygon.edges.head;null!=t;){for(var p=t.elt,u=1.0E100,y=0,s=a.polygon.gverts.next;null!=s;){var z=s,v=p.gnormx*z.x+p.gnormy*z.y;v<u&&(u=v);v>=p.gprojection+m.epsilon&&(d[y]=!0,h=!1);y++;s=s.next}u-=p.gprojection;if(0<u){f=!1;break}t=t.next}if(h)return a.polygon.validate_worldCOM(),c.overlap=a.polygon.area,c.centroidx=a.polygon.worldCOMx,c.centroidy=a.polygon.worldCOMy,null,!0;if(f){for(;null!=o.flowpoly.head;){var C=o.flowpoly.pop_unsafe();
if(!C._inuse){var F=C;null!=F.outer&&(F.outer.zpp_inner=null,F.outer=null);F._isimmutable=null;F._validate=null;F._invalidate=null;F.next=H.zpp_pool;H.zpp_pool=F}}for(var w=null,E=!1,A=a.polygon.gverts.next,G=0,B=b.polygon.gverts.next,pc=0,M=0,D=b.polygon.edgeCnt;M<D;){var K=M++;if(e[K])B=B.next;else{pc=K;break}}if(null==B){for(var B=b.polygon.gverts.next,E=!0,I=0,N=a.polygon.edgeCnt;I<N;){var P=I++;if(d[P])A=A.next;else{G=P;break}}null==A?A=a.polygon.gverts.next:(o.flowpoly.add(A),w=o.flowpoly.head.elt)}else o.flowpoly.add(B),
w=o.flowpoly.head.elt;var J=1;if(null==o.flowpoly.head){for(var T=!0,$=a.polygon.gverts.next,cb=$,Y=$.next;null!=Y;){for(var X=Y,Pa=2,R=b.polygon.gverts.next,S=R,W=R.next;null!=W;){var aa=W,ga=0;(function(){var a=0,b=0,a=cb.x-S.x,b=cb.y-S.y,c=0,d=0,c=X.x-cb.x,d=X.y-cb.y,e=0,f=0,e=aa.x-S.x,f=aa.y-S.y,h=d*e-c*f;h*h>m.epsilon*m.epsilon?(h=1/h,e=(f*a-e*b)*h,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*h,a>m.epsilon&&a<1-m.epsilon?(ga=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&ga<Pa&&(Pa=ga,B=R);R=W;S=aa;W=
W.next}var ba=W=b.polygon.gverts.next,Zf=0;(function(){var a=0,b=0,a=cb.x-S.x,b=cb.y-S.y,c=0,d=0,c=X.x-cb.x,d=X.y-cb.y,e=0,f=0,e=ba.x-S.x,f=ba.y-S.y,h=d*e-c*f;h*h>m.epsilon*m.epsilon?(h=1/h,e=(f*a-e*b)*h,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*h,a>m.epsilon&&a<1-m.epsilon?(Zf=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&Zf<Pa&&(Pa=Zf,B=R);if(2!=Pa){var fa=0,qa=0,na=Pa,fa=cb.x+(X.x-cb.x)*na,qa=cb.y+(X.y-cb.y)*na,w=H.get(fa,qa,null);o.flowpoly.add(w);E=!0;A=$;T=!1;break}$=Y;cb=X;Y=Y.next}if(T){for(var ja=
Y=a.polygon.gverts.next,q=2,U=b.polygon.gverts.next,ca=U,oa=U.next;null!=oa;){var ma=oa,da=0;(function(){var a=0,b=0,a=cb.x-ca.x,b=cb.y-ca.y,c=0,d=0,c=ja.x-cb.x,d=ja.y-cb.y,e=0,f=0,e=ma.x-ca.x,f=ma.y-ca.y,h=d*e-c*f;h*h>m.epsilon*m.epsilon?(h=1/h,e=(f*a-e*b)*h,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*h,a>m.epsilon&&a<1-m.epsilon?(da=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&da<q&&(q=da,B=U);U=oa;ca=ma;oa=oa.next}var ia=oa=b.polygon.gverts.next,Sa=0;(function(){var a=0,b=0,a=cb.x-ca.x,b=cb.y-ca.y,c=
0,d=0,c=ja.x-cb.x,d=ja.y-cb.y,e=0,f=0,e=ia.x-ca.x,f=ia.y-ca.y,h=d*e-c*f;h*h>m.epsilon*m.epsilon?(h=1/h,e=(f*a-e*b)*h,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*h,a>m.epsilon&&a<1-m.epsilon?(Sa=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&Sa<q&&(q=Sa,B=U);if(2!=q){var wa=0,pa=0,Qa=q,wa=cb.x+(ja.x-cb.x)*Qa,pa=cb.y+(ja.y-cb.y)*Qa,w=H.get(wa,pa,null);o.flowpoly.add(w);E=!0;A=$}}J=2}for(;;)if(E)if(A=A.next,G++,null==A&&(A=a.polygon.gverts.next,G=0),d[G]){var V=o.flowpoly.head.elt,lb=A,xd=B,mb=B.next;null==
mb&&(mb=b.polygon.gverts.next);var ne=-1,se=null,O=0,Ka=0,la=mb,Jb=mb;do{var Ga=Jb,Ba=0;if(function(){var a=0,b=0,a=xd.x-V.x,b=xd.y-V.y,c=0,d=0,c=Ga.x-xd.x,d=Ga.y-xd.y,e=0,f=0,e=lb.x-V.x,f=lb.y-V.y,h=d*e-c*f;h*h>m.epsilon*m.epsilon?(h=1/h,e=(f*a-e*b)*h,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*h,a>m.epsilon&&a<1-m.epsilon?(Ba=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Ba>=ne)if(se=B,O=pc,++Ka==J){ne=Ba;Jb=la;break}else ne=Ba;xd=Ga;B=Jb;pc++;pc>=b.polygon.edgeCnt&&(pc=0);Jb=Jb.next;null==Jb&&(Jb=b.polygon.gverts.next)}while(0);
for(;Jb!=la;){var ea=Jb,Gf=0;if(function(){var a=0,b=0,a=xd.x-V.x,b=xd.y-V.y,c=0,d=0,c=ea.x-xd.x,d=ea.y-xd.y,e=0,f=0,e=lb.x-V.x,f=lb.y-V.y,h=d*e-c*f;h*h>m.epsilon*m.epsilon?(h=1/h,e=(f*a-e*b)*h,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*h,a>m.epsilon&&a<1-m.epsilon?(Gf=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Gf>=ne)if(se=B,O=pc,++Ka==J){ne=Gf;Jb=la;break}else ne=Gf;xd=ea;B=Jb;pc++;pc>=b.polygon.edgeCnt&&(pc=0);Jb=Jb.next;null==Jb&&(Jb=b.polygon.gverts.next)}if(null==se)break;var Hf=se,sa=se.next;null==
sa&&(sa=b.polygon.gverts.next);var va=sa,Ca=0,oe=0,Ua=ne,Ca=Hf.x+(va.x-Hf.x)*Ua,oe=Hf.y+(va.y-Hf.y)*Ua;if(null!=w&&gb.vec_dsq(Ca,oe,w.x,w.y)<m.epsilon)break;o.flowpoly.add(H.get(Ca,oe,null));null==w&&(w=o.flowpoly.head.elt);B=se;pc=O;E=!E;J=2}else{var Va=A;if(null!=w&&gb.vec_dsq(Va.x,Va.y,w.x,w.y)<m.epsilon)break;o.flowpoly.add(Va);null==w&&(w=o.flowpoly.head.elt);J=1}else if(B=B.next,pc++,null==B&&(B=b.polygon.gverts.next,pc=0),e[pc]){var ya=o.flowpoly.head.elt,Ea=B,x=A,ta=A.next;null==ta&&(ta=a.polygon.gverts.next);
var Da=-1,ha=null,Ta=0,Z=0,Oa=ta,hb=ta;do{var Xa=hb,La=0;if(function(){var a=0,b=0,a=x.x-ya.x,b=x.y-ya.y,c=0,d=0,c=Xa.x-x.x,d=Xa.y-x.y,e=0,f=0,e=Ea.x-ya.x,f=Ea.y-ya.y,h=d*e-c*f;h*h>m.epsilon*m.epsilon?(h=1/h,e=(f*a-e*b)*h,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*h,a>m.epsilon&&a<1-m.epsilon?(La=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&La>=Da)if(ha=A,Ta=G,++Z==J){Da=La;hb=Oa;break}else Da=La;x=Xa;A=hb;G++;G>=a.polygon.edgeCnt&&(G=0);hb=hb.next;null==hb&&(hb=a.polygon.gverts.next)}while(0);for(;hb!=
Oa;){var Fa=hb,Za=0;if(function(){var a=0,b=0,a=x.x-ya.x,b=x.y-ya.y,c=0,d=0,c=Fa.x-x.x,d=Fa.y-x.y,e=0,f=0,e=Ea.x-ya.x,f=Ea.y-ya.y,h=d*e-c*f;h*h>m.epsilon*m.epsilon?(h=1/h,e=(f*a-e*b)*h,e>m.epsilon&&e<1-m.epsilon?(a=(d*a-c*b)*h,a>m.epsilon&&a<1-m.epsilon?(Za=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Za>=Da)if(ha=A,Ta=G,++Z==J){Da=Za;hb=Oa;break}else Da=Za;x=Fa;A=hb;G++;G>=a.polygon.edgeCnt&&(G=0);hb=hb.next;null==hb&&(hb=a.polygon.gverts.next)}if(null==ha)break;var ra=ha,Ja=ha.next;null==Ja&&(Ja=a.polygon.gverts.next);
var Aa=Ja,$f=0,ag=0,Ya=Da,$f=ra.x+(Aa.x-ra.x)*Ya,ag=ra.y+(Aa.y-ra.y)*Ya;if(null!=w&&gb.vec_dsq($f,ag,w.x,w.y)<m.epsilon)break;o.flowpoly.add(H.get($f,ag,null));null==w&&(w=o.flowpoly.head.elt);A=ha;G=Ta;E=!E;J=2}else{var $a=B;if(null!=w&&gb.vec_dsq($a.x,$a.y,w.x,w.y)<m.epsilon)break;o.flowpoly.add($a);null==w&&(w=o.flowpoly.head.elt);J=1}if(null!=o.flowpoly.head&&null!=o.flowpoly.head.next&&null!=o.flowpoly.head.next.next){for(var pb=0,yd=0,zb=0,pb=zb=yd=0,nb=o.flowpoly.head,ka=nb.elt,nb=nb.next,
za=nb.elt,nb=nb.next;null!=nb;)var Ab=nb.elt,pb=pb+za.x*(Ab.y-ka.y),jb=Ab.y*za.x-Ab.x*za.y,yd=yd+(za.x+Ab.x)*jb,zb=zb+(za.y+Ab.y)*jb,ka=za,za=Ab,nb=nb.next;var nb=o.flowpoly.head,zd=nb.elt,pb=pb+za.x*(zd.y-ka.y),Ae=zd.y*za.x-zd.x*za.y,yd=yd+(za.x+zd.x)*Ae,zb=zb+(za.y+zd.y)*Ae,ka=za,za=zd,nb=nb.next,Wa=nb.elt,pb=pb+za.x*(Wa.y-ka.y),yb=Wa.y*za.x-Wa.x*za.y,yd=yd+(za.x+Wa.x)*yb,zb=zb+(za.y+Wa.y)*yb,pb=0.5*pb,Db=1/(6*pb),yd=yd*Db,zb=zb*Db;c.overlap=-pb;c.centroidx=yd;c.centroidy=zb;null;return!0}}}return!1}for(var ob=
[],Mb=!0,Ra=null,ab=null,Qb=-1.0E100,Rb=!0,kb=b.polygon.gverts.next,Tb=0,eb=b.polygon.edges.head;null!=eb;){var bb=eb.elt,fb=bb.gnormx*a.circle.worldCOMx+bb.gnormy*a.circle.worldCOMy;if(fb>bb.gprojection+a.circle.radius){Rb=!1;break}else fb+a.circle.radius>bb.gprojection+m.epsilon&&(Mb=!1,ob[Tb]=!0);fb-=bb.gprojection+a.circle.radius;fb>Qb&&(Qb=fb,Ra=bb,ab=kb);kb=kb.next;Tb++;eb=eb.next}if(Rb){if(Mb)return c.overlap=a.circle.area,c.centroidx=a.circle.worldCOMx,c.centroidy=a.circle.worldCOMy,null,
!0;var vb=ab,xa;xa=null==ab.next?b.polygon.gverts.next:ab.next;var Yb=a.circle.worldCOMy*Ra.gnormx-a.circle.worldCOMx*Ra.gnormy;if(Yb<=vb.y*Ra.gnormx-vb.x*Ra.gnormy?function(){var b=a.circle.radius,c=0,d=0,c=vb.x-a.circle.worldCOMx,d=vb.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):Yb>=xa.y*Ra.gnormx-xa.x*Ra.gnormy?function(){var b=a.circle.radius,c=0,d=0,c=xa.x-a.circle.worldCOMx,d=xa.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):1){for(var ib=[],Ib=0,$b=!0,Cb=null,Na=0,Ha=b.polygon.gverts.next;null!=
Ha;){var ac=Ha,sc=gb.vec_dsq(ac.x,ac.y,a.circle.worldCOMx,a.circle.worldCOMy);(ib[Ib]=sc<=a.circle.radius*a.circle.radius)?(Na=Ib,Cb=Ha):$b=!1;Ib++;Ha=Ha.next}if($b)return b.polygon.validate_worldCOM(),c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,c.centroidy=b.polygon.worldCOMy,null,!0;for(;null!=o.flowpoly.head;){var ec=o.flowpoly.pop_unsafe();if(!ec._inuse){var Ma=ec;null!=Ma.outer&&(Ma.outer.zpp_inner=null,Ma.outer=null);Ma._isimmutable=null;Ma._validate=null;Ma._invalidate=null;Ma.next=
H.zpp_pool;H.zpp_pool=Ma}}o.flowsegs.clear();var qb=null,Mc=1;null==Cb?(Cb=b.polygon.gverts.next,Mc=2):o.flowpoly.add(qb=Cb);for(;0!=Mc;)if(1==Mc)if(Cb=Cb.next,null==Cb&&(Cb=b.polygon.gverts.next),Na++,Na>=b.polygon.edgeCnt&&(Na=0),ib[Na]){if(gb.vec_dsq(qb.x,qb.y,Cb.x,Cb.y)<m.epsilon)break;o.flowpoly.add(Cb)}else{var Ia=o.flowpoly.head.elt,ub=Cb,Eb=0,Fb=0,Eb=ub.x-Ia.x,Fb=ub.y-Ia.y,Gb=0,Lb=0,Gb=Ia.x-a.circle.worldCOMx,Lb=Ia.y-a.circle.worldCOMy,wb=Eb*Eb+Fb*Fb,Nb=2*(Gb*Eb+Lb*Fb),xc=Math.sqrt(Nb*Nb-
4*wb*(Gb*Gb+Lb*Lb-a.circle.radius*a.circle.radius)),wb=1/(2*wb),Cc=(-Nb-xc)*wb,kc=0,lc=0,Ec=Cc<m.epsilon?(-Nb+xc)*wb:Cc,kc=Ia.x+(ub.x-Ia.x)*Ec,lc=Ia.y+(ub.y-Ia.y)*Ec;if(gb.vec_dsq(qb.x,qb.y,kc,lc)<m.epsilon)break;o.flowpoly.add(H.get(kc,lc,null));Mc=2}else if(2==Mc){var Pb=Cb.next;null==Pb&&(Pb=b.polygon.gverts.next);var Q=Cb,Mc=0,ua=Pb,rb=Pb;do{var cd=rb,Sb=Na+1;Sb==b.polygon.edgeCnt&&(Sb=0);if(ob[Na])if(ib[Sb]){var Ub=0,Vb=0,Ub=cd.x-Q.x,Vb=cd.y-Q.y,Wb=0,Xb=0,Wb=Q.x-a.circle.worldCOMx,Xb=Q.y-a.circle.worldCOMy,
Hb=Ub*Ub+Vb*Vb,Zb=2*(Wb*Ub+Xb*Vb),Hc=Math.sqrt(Zb*Zb-4*Hb*(Wb*Wb+Xb*Xb-a.circle.radius*a.circle.radius)),Hb=1/(2*Hb),Ic=(-Zb-Hc)*Hb,qc=0,rc=0,Oc=Ic<m.epsilon?(-Zb+Hc)*Hb:Ic,qc=Q.x+(cd.x-Q.x)*Oc,rc=Q.y+(cd.y-Q.y)*Oc;if(gb.vec_dsq(qb.x,qb.y,qc,rc)<m.epsilon){Mc=0;rb=ua;break}var Pc=H.get(qc,rc,null);o.flowsegs.add(o.flowpoly.head.elt);o.flowsegs.add(Pc);o.flowpoly.add(Pc);Mc=1;rb=ua;break}else{var bc=0,cc=0,tc,dc=0,fc=0,dc=cd.x-Q.x,fc=cd.y-Q.y,gc=0,hc=0,gc=Q.x-a.circle.worldCOMx,hc=Q.y-a.circle.worldCOMy,
xb=dc*dc+fc*fc,Ob=2*(gc*dc+hc*fc),db=Ob*Ob-4*xb*(gc*gc+hc*hc-a.circle.radius*a.circle.radius);db*db<m.epsilon?(bc=0>db?10:cc=-Ob/(2*xb),tc=!1):(db=Math.sqrt(db),xb=1/(2*xb),bc=(-Ob-db)*xb,cc=(-Ob+db)*xb,tc=!0);if(bc<1-m.epsilon&&cc>m.epsilon){var Ac=0,Fc=0,Yc=bc,Ac=Q.x+(cd.x-Q.x)*Yc,Fc=Q.y+(cd.y-Q.y)*Yc;if(null!=qb&&gb.vec_dsq(qb.x,qb.y,Ac,Fc)<m.epsilon){Mc=0;rb=ua;break}var ad=H.get(Ac,Fc,null);null!=o.flowpoly.head&&(o.flowsegs.add(o.flowpoly.head.elt),o.flowsegs.add(ad));o.flowpoly.add(ad);null==
qb&&(qb=o.flowpoly.head.elt);if(tc){var bd=0,fd=0,hd=cc,bd=Q.x+(cd.x-Q.x)*hd,fd=Q.y+(cd.y-Q.y)*hd;o.flowpoly.add(H.get(bd,fd,null))}}}Q=cd;Cb=rb;Na=Sb;rb=rb.next;null==rb&&(rb=b.polygon.gverts.next)}while(0);for(;rb!=ua;){var dd=rb,uc=Na+1;uc==b.polygon.edgeCnt&&(uc=0);if(ob[Na])if(ib[uc]){var vc=0,wc=0,vc=dd.x-Q.x,wc=dd.y-Q.y,yc=0,Bc=0,yc=Q.x-a.circle.worldCOMx,Bc=Q.y-a.circle.worldCOMy,jc=vc*vc+wc*wc,Dc=2*(yc*vc+Bc*wc),qd=Math.sqrt(Dc*Dc-4*jc*(yc*yc+Bc*Bc-a.circle.radius*a.circle.radius)),jc=1/
(2*jc),rd=(-Dc-qd)*jc,Xc=0,$c=0,vd=rd<m.epsilon?(-Dc+qd)*jc:rd,Xc=Q.x+(dd.x-Q.x)*vd,$c=Q.y+(dd.y-Q.y)*vd;if(gb.vec_dsq(qb.x,qb.y,Xc,$c)<m.epsilon){Mc=0;rb=ua;break}var wd=H.get(Xc,$c,null);o.flowsegs.add(o.flowpoly.head.elt);o.flowsegs.add(wd);o.flowpoly.add(wd);Mc=1;rb=ua;break}else{var Jc=0,Kc=0,ed,Qc=0,Rc=0,Qc=dd.x-Q.x,Rc=dd.y-Q.y,Sc=0,Tc=0,Sc=Q.x-a.circle.worldCOMx,Tc=Q.y-a.circle.worldCOMy,ic=Qc*Qc+Rc*Rc,zc=2*(Sc*Qc+Tc*Rc),pe=zc*zc-4*ic*(Sc*Sc+Tc*Tc-a.circle.radius*a.circle.radius);pe*pe<m.epsilon?
(Jc=0>pe?10:Kc=-zc/(2*ic),ed=!1):(pe=Math.sqrt(pe),ic=1/(2*ic),Jc=(-zc-pe)*ic,Kc=(-zc+pe)*ic,ed=!0);if(Jc<1-m.epsilon&&Kc>m.epsilon){var kd=0,ld=0,Gd=Jc,kd=Q.x+(dd.x-Q.x)*Gd,ld=Q.y+(dd.y-Q.y)*Gd;if(null!=qb&&gb.vec_dsq(qb.x,qb.y,kd,ld)<m.epsilon){Mc=0;rb=ua;break}var Hd=H.get(kd,ld,null);null!=o.flowpoly.head&&(o.flowsegs.add(o.flowpoly.head.elt),o.flowsegs.add(Hd));o.flowpoly.add(Hd);null==qb&&(qb=o.flowpoly.head.elt);if(ed){var Id=0,Jd=0,Kd=Kc,Id=Q.x+(dd.x-Q.x)*Kd,Jd=Q.y+(dd.y-Q.y)*Kd;o.flowpoly.add(H.get(Id,
Jd,null))}}}Q=dd;Cb=rb;Na=uc;rb=rb.next;null==rb&&(rb=b.polygon.gverts.next)}}if(null==o.flowpoly.head)return!1;if(null==o.flowpoly.head.next){for(var Od=!0,Vc=b.polygon.edges.head;null!=Vc;){var ud=Vc.elt;if(ud.gnormx*a.circle.worldCOMx+ud.gnormy*a.circle.worldCOMy>ud.gprojection){Od=!1;break}Vc=Vc.next}return Od?(c.overlap=a.circle.area,c.centroidx=a.circle.worldCOMx,c.centroidy=a.circle.worldCOMy,null,!0):!1}var qe=0,re=0,mc=0;if(null!=o.flowpoly.head.next.next){for(var Nc=0,Ad=0,Bd=0,Nc=Bd=Ad=
0,Kb=o.flowpoly.head,Gc=Kb.elt,Kb=Kb.next,sb=Kb.elt,Kb=Kb.next;null!=Kb;)var nc=Kb.elt,Nc=Nc+sb.x*(nc.y-Gc.y),Pd=nc.y*sb.x-nc.x*sb.y,Ad=Ad+(sb.x+nc.x)*Pd,Bd=Bd+(sb.y+nc.y)*Pd,Gc=sb,sb=nc,Kb=Kb.next;var Kb=o.flowpoly.head,oc=Kb.elt,Nc=Nc+sb.x*(oc.y-Gc.y),Qd=oc.y*sb.x-oc.x*sb.y,Ad=Ad+(sb.x+oc.x)*Qd,Bd=Bd+(sb.y+oc.y)*Qd,Gc=sb,sb=oc,Kb=Kb.next,Lc=Kb.elt,Nc=Nc+sb.x*(Lc.y-Gc.y),Td=Lc.y*sb.x-Lc.x*sb.y,Ad=Ad+(sb.x+Lc.x)*Td,Bd=Bd+(sb.y+Lc.y)*Td,Nc=0.5*Nc,Ud=1/(6*Nc),Ad=Ad*Ud,Bd=Bd*Ud,Vd=-Nc,qe=qe+Ad*Vd,re=
re+Bd*Vd,mc=mc-Nc}else o.flowsegs.add(o.flowpoly.head.elt),o.flowsegs.add(o.flowpoly.head.next.elt);for(;null!=o.flowsegs.head;)var gd=o.flowsegs.pop_unsafe(),id=o.flowsegs.pop_unsafe(),Wd=0,Xd=0,Wd=id.x-gd.x,Xd=id.y-gd.y,Rd=0,Sd=0,Rd=Wd,Sd=Xd,Yd=1/Math.sqrt(Rd*Rd+Sd*Sd),Rd=Rd*Yd,Sd=Sd*Yd,me=Rd,Rd=-Sd,Sd=me,Cd=0,Dd=0,Cd=gd.x+id.x,Dd=gd.y+id.y,Cd=0.5*Cd,Dd=0.5*Dd,Cd=Cd-1*a.circle.worldCOMx,Dd=Dd-1*a.circle.worldCOMy,Ed=0,Zd=0,$d=Rd*Cd+Sd*Dd,jd=$d/a.circle.radius,Uc=Math.sqrt(1-jd*jd),ae=Math.acos(jd),
Ed=a.circle.radius*(a.circle.radius*ae-$d*Uc),Zd=0.6666666666666666*a.circle.radius*Uc*Uc*Uc/(ae-jd*Uc),Cd=a.circle.worldCOMx,Dd=a.circle.worldCOMy,be=Zd,Cd=Cd+Rd*be,Dd=Dd+Sd*be,ce=Ed,qe=qe+Cd*ce,re=re+Dd*ce,mc=mc+Ed;var de=1/mc,qe=qe*de,re=re*de;c.overlap=mc;c.centroidx=qe;c.centroidy=re;null;return!0}}return!1}var tb=a.circle,Bb=b.circle,md=0,nd=0,md=Bb.worldCOMx-tb.worldCOMx,nd=Bb.worldCOMy-tb.worldCOMy,ee=tb.radius+Bb.radius,Fd=md*md+nd*nd;if(Fd>ee*ee)return!1;if(Fd<m.epsilon*m.epsilon)tb.radius<
Bb.radius?(c.overlap=tb.area,c.centroidx=tb.worldCOMx,c.centroidy=tb.worldCOMy):(c.overlap=Bb.area,c.centroidx=Bb.worldCOMx,c.centroidy=Bb.worldCOMy);else{var od=Math.sqrt(Fd),fe=1/od,pd=0.5*(od-(Bb.radius*Bb.radius-tb.radius*tb.radius)*fe);if(pd<=-tb.radius)c.overlap=tb.area,c.centroidx=tb.worldCOMx,c.centroidy=tb.worldCOMy;else{var Ld=od-pd;if(Ld<=-Bb.radius)c.overlap=Bb.area,c.centroidx=Bb.worldCOMx,c.centroidy=Bb.worldCOMy;else{var Md=0,ge=0,Nd=0,he=0,sd=pd/tb.radius,Wc=Math.sqrt(1-sd*sd),ie=
Math.acos(sd),Md=tb.radius*(tb.radius*ie-pd*Wc),ge=0.6666666666666666*tb.radius*Wc*Wc*Wc/(ie-sd*Wc),td=Ld/Bb.radius,Zc=Math.sqrt(1-td*td),je=Math.acos(td),Nd=Bb.radius*(Bb.radius*je-Ld*Zc),he=0.6666666666666666*Bb.radius*Zc*Zc*Zc/(je-td*Zc),ke=Md+Nd,le=(ge*Md+(od-he)*Nd)/ke*fe;c.overlap=ke;c.centroidx=tb.worldCOMx+md*le;c.centroidy=tb.worldCOMy+nd*le}}}null;return!0};var Ka=function(){this.slipped=this.failed=this.kinematic=!1;this.c1=this.c2=this.axis=null;this.frozen1=this.frozen2=!1;this.s1=this.s2=
this.arbiter=null;this.toi=0;this.next=null;this.c1=new H;this.c2=new H;this.axis=new H};Ka.__name__=!0;Ka.prototype={__class__:Ka};var ob=function(){};ob.__name__=!0;ob.dynamicSweep=function(a,b,c,d,e){null==e&&(e=!1);var f=a.s1,h=a.s2,g=f.body,k=h.body,n=0,l=0,n=k.velx-g.velx,l=k.vely-g.vely,j=g.angvel;0>j&&(j=-j);var r=k.angvel;0>r&&(r=-r);var L=f.sweepCoef*j+h.sweepCoef*r;if(!e&&!a.kinematic&&n*n+l*l<m.dynamicSweepLinearThreshold*m.dynamicSweepLinearThreshold&&L<m.dynamicSweepAngularThreshold)a.toi=
-1,a.failed=!0;else{for(var o=a.c1,j=a.c2,r=a.axis,t=0;;){g.sweepIntegrate(c*b);g.sweepValidate(f);k.sweepIntegrate(c*b);k.sweepValidate(h);var u=ob.distance(f,h,o,j,r,null)+d,p=n*r.x+l*r.y;if(u<m.distanceThresholdCCD){if(e)break;var s=0,y=0,s=o.x-g.posx,y=o.y-g.posy,w=0,v=0,w=j.x-k.posx,v=j.y-k.posy,s=p-g.sweep_angvel*(r.y*s-r.x*y)+k.sweep_angvel*(r.y*w-r.x*v);0<s&&(a.slipped=!0);if(0>=s||u<0.5*m.distanceThresholdCCD)break}p=(L-p)*b;if(0>=p){c=-1;break}p=u/p;1.0E-6>p&&(p=1.0E-6);c+=p;if(1<=c){c=
1;g.sweepIntegrate(c*b);g.sweepValidate(f);k.sweepIntegrate(c*b);k.sweepValidate(h);b=ob.distance(f,h,o,j,r,null)+d;n=n*r.x+l*r.y;if(b<m.distanceThresholdCCD){if(e)break;l=e=0;e=o.x-g.posx;l=o.y-g.posy;d=o=0;o=j.x-k.posx;d=j.y-k.posy;g=n-g.sweep_angvel*(r.y*e-r.x*l)+k.sweep_angvel*(r.y*o-r.x*d);0<g&&(a.slipped=!0);if(0>=g||b<0.5*m.distanceThresholdCCD)break}c=-1;break}if(40<=++t){u>d&&(a.failed=!0);break}}a.toi=c}};ob.staticSweep=function(a,b,c,d){var e=a.s1,f=a.s2,h=e.body,g=0,k=0,g=-h.velx,k=-h.vely,
n=h.sweep_angvel;0>n&&(n=-n);for(var l=e.sweepCoef*n,n=a.c1,j=a.c2,r=a.axis,o=0;;){h.sweepIntegrate(c*b);h.sweepValidate(e);var p=ob.distance(e,f,n,j,r,null)+d,t=g*r.x+k*r.y;if(p<m.distanceThresholdCCD){var u=0,y=0,u=n.x-h.posx,y=n.y-h.posy,u=t-h.sweep_angvel*(r.y*u-r.x*y);0<u&&(a.slipped=!0);if(0>=u||p<0.5*m.distanceThresholdCCD)break}t=(l-t)*b;if(0>=t){c=-1;break}t=p/t;1.0E-6>t&&(t=1.0E-6);c+=t;if(1<=c){c=1;h.sweepIntegrate(c*b);h.sweepValidate(e);b=ob.distance(e,f,n,j,r,null)+d;g=g*r.x+k*r.y;if(b<
m.distanceThresholdCCD&&(d=k=0,k=n.x-h.posx,d=n.y-h.posy,h=g-h.sweep_angvel*(r.y*k-r.x*d),0<h&&(a.slipped=!0),0>=h||b<0.5*m.distanceThresholdCCD))break;c=-1;break}if(40<=++o){p>d&&(a.failed=!0);break}}a.toi=c};ob.distance=function(a,b,c,d,e,f){null==f&&(f=1.0E100);if(a.type==g.id_ShapeType_CIRCLE&&b.type==g.id_ShapeType_CIRCLE){var h=a.circle,i=b.circle,k,n=0,l=0,n=i.worldCOMx-h.worldCOMx,l=i.worldCOMy-h.worldCOMy,j=Math.sqrt(n*n+l*l);k=j-(h.radius+i.radius);if(k<f){if(0==j)n=1,l=0;else var r=1/j,
n=n*r,l=l*r;var o=h.radius;c.x=h.worldCOMx+n*o;c.y=h.worldCOMy+l*o;var t=-i.radius;d.x=i.worldCOMx+n*t;d.y=i.worldCOMy+l*t;e.x=n;e.y=l}return k}var p=!1;if(a.type==g.id_ShapeType_CIRCLE&&b.type==g.id_ShapeType_POLYGON)var u=a,a=b,b=u,y=c,c=d,d=y,p=!0;if(a.type==g.id_ShapeType_POLYGON&&b.type==g.id_ShapeType_CIRCLE){for(var s=b.circle,w=-1.0E100,v=null,z=a.polygon.edges.head;null!=z;){var A=z.elt,B=A.gnormx*s.worldCOMx+A.gnormy*s.worldCOMy-A.gprojection-s.radius;if(B>f){w=B;break}0<B?B>w&&(w=B,v=A):
0>w&&B>w&&(w=B,v=A);z=z.next}if(w<f){var C=v.gp0,F=v.gp1,G=s.worldCOMy*v.gnormx-s.worldCOMx*v.gnormy;if(G<=C.y*v.gnormx-C.x*v.gnormy){var E=0,H=0,E=s.worldCOMx-C.x,H=s.worldCOMy-C.y,J=Math.sqrt(E*E+H*H),w=J-s.radius;if(w<f){if(0==J)E=1,H=0;else var M=1/J,E=E*M,H=H*M;c.x=C.x+0*E;c.y=C.y+0*H;var K=-s.radius;d.x=s.worldCOMx+E*K;d.y=s.worldCOMy+H*K;e.x=E;e.y=H}}else if(G>=F.y*v.gnormx-F.x*v.gnormy){var D=0,I=0,D=s.worldCOMx-F.x,I=s.worldCOMy-F.y,N=Math.sqrt(D*D+I*I),w=N-s.radius;if(w<f){if(0==N)D=1,I=
0;else var P=1/N,D=D*P,I=I*P;c.x=F.x+0*D;c.y=F.y+0*I;var $=-s.radius;d.x=s.worldCOMx+D*$;d.y=s.worldCOMy+I*$;e.x=D;e.y=I}}else{var S=-s.radius;d.x=s.worldCOMx+v.gnormx*S;d.y=s.worldCOMy+v.gnormy*S;var Y=-w;c.x=d.x+v.gnormx*Y;c.y=d.y+v.gnormy*Y;e.x=v.gnormx;e.y=v.gnormy}}p&&(e.x=-e.x,e.y=-e.y);return w}for(var X=a.polygon,T=b.polygon,Pa=-1.0E100,W=null,R=null,ca=0,ja=X.edges.head;null!=ja;){for(var V=ja.elt,U=1.0E100,aa=T.gverts.next;null!=aa;){var ga=aa,oa=V.gnormx*ga.x+V.gnormy*ga.y;oa<U&&(U=oa);
aa=aa.next}U-=V.gprojection;if(U>f){Pa=U;break}0<U?U>Pa&&(Pa=U,W=V,ca=1):0>Pa&&U>Pa&&(Pa=U,W=V,ca=1);ja=ja.next}if(Pa<f){for(var ya=T.edges.head;null!=ya;){for(var ba=ya.elt,q=1.0E100,fa=X.gverts.next;null!=fa;){var qa=fa,na=ba.gnormx*qa.x+ba.gnormy*qa.y;na<q&&(q=na);fa=fa.next}q-=ba.gprojection;if(q>f){Pa=q;break}0<q?q>Pa&&(Pa=q,R=ba,ca=2):0>Pa&&q>Pa&&(Pa=q,R=ba,ca=2);ya=ya.next}if(Pa<f){var Da,da;if(1==ca)Da=T,da=W;else{Da=X;da=R;var Na=c,c=d,d=Na,p=!p}for(var ha=null,Ba=1.0E100,ma=Da.edges.head;null!=
ma;){var Qa=ma.elt,Sa=da.gnormx*Qa.gnormx+da.gnormy*Qa.gnormy;Sa<Ba&&(Ba=Sa,ha=Qa);ma=ma.next}p?(e.x=-da.gnormx,e.y=-da.gnormy):(e.x=da.gnormx,e.y=da.gnormy);if(0<=Pa){var lb=da.gp0,O=da.gp1,mb=ha.gp0,Ea=ha.gp1,la=0,Ga=0,ia=0,ea=0,la=O.x-lb.x,Ga=O.y-lb.y,ia=Ea.x-mb.x,ea=Ea.y-mb.y,sa=1/(la*la+Ga*Ga),ta=1/(ia*ia+ea*ea),wa=-(la*(lb.x-mb.x)+Ga*(lb.y-mb.y))*sa,pa=-(la*(lb.x-Ea.x)+Ga*(lb.y-Ea.y))*sa,Ca=-(ia*(mb.x-lb.x)+ea*(mb.y-lb.y))*ta,Va=-(ia*(mb.x-O.x)+ea*(mb.y-O.y))*ta;0>wa?wa=0:1<wa&&(wa=1);0>pa?
pa=0:1<pa&&(pa=1);0>Ca?Ca=0:1<Ca&&(Ca=1);0>Va?Va=0:1<Va&&(Va=1);var Ka=0,La=0,Ma=wa,Ka=lb.x+la*Ma,La=lb.y+Ga*Ma,oe=0,Za=0,Ra=pa,oe=lb.x+la*Ra,Za=lb.y+Ga*Ra,Ia=0,ra=0,x=Ca,Ia=mb.x+ia*x,ra=mb.y+ea*x,va=0,ka=0,Ta=Va,va=mb.x+ia*Ta,ka=mb.y+ea*Ta,Ua=gb.vec_dsq(Ka,La,mb.x,mb.y),Oa=gb.vec_dsq(oe,Za,Ea.x,Ea.y),Wa=gb.vec_dsq(Ia,ra,lb.x,lb.y),hb=gb.vec_dsq(va,ka,O.x,O.y),Xa=0,Ja=0,Fa=null;Ua<Oa?(Xa=Ka,Ja=La,Fa=mb):(Xa=oe,Ja=Za,Fa=Ea,Ua=Oa);var bb=0,fb=0,Z=null;Wa<hb?(bb=Ia,fb=ra,Z=lb):(bb=va,fb=ka,Z=O,Wa=hb);
Ua<Wa?(c.x=Xa,c.y=Ja,d.x=Fa.x,d.y=Fa.y,Pa=Math.sqrt(Ua)):(d.x=bb,d.y=fb,c.x=Z.x,c.y=Z.y,Pa=Math.sqrt(Wa));if(0!=Pa){e.x=d.x-c.x;e.y=d.y-c.y;var $a=1/Pa;e.x*=$a;e.y*=$a;p&&(e.x=-e.x,e.y=-e.y)}return Pa}var ua=0,xa=0,ua=ha.gp0.x,xa=ha.gp0.y,Aa=0,Ha=0,Aa=ha.gp1.x,Ha=ha.gp1.y,pb=0,Ya=0,pb=Aa-ua,Ya=Ha-xa,zb=da.gnormy*ua-da.gnormx*xa,nb=da.gnormy*Aa-da.gnormx*Ha,db=1/(nb-zb),za=(-da.tp1-zb)*db;za>m.epsilon&&(ua+=pb*za,xa+=Ya*za);var Ab=(-da.tp0-nb)*db;Ab<-m.epsilon&&(Aa+=pb*Ab,Ha+=Ya*Ab);var ab=ua*da.gnormx+
xa*da.gnormy-da.gprojection,zd=Aa*da.gnormx+Ha*da.gnormy-da.gprojection;if(ab<zd){d.x=ua;d.y=xa;var Ae=-ab;c.x=d.x+da.gnormx*Ae;c.y=d.y+da.gnormy*Ae;return ab}d.x=Aa;d.y=Ha;var eb=-zd;c.x=d.x+da.gnormx*eb;c.y=d.y+da.gnormy*eb;return zd}}return f};var H=function(){this.length=this.x=this.y=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.weak=!1;this._isimmutable=this.outer=null;this._immutable=!1;this._invalidate=this._validate=null};H.__name__=!0;H.get=function(a,b,c){null==c&&(c=
!1);var d;null==H.zpp_pool?d=new H:(d=H.zpp_pool,H.zpp_pool=d.next,d.next=null);d.weak=!1;d._immutable=c;d.x=a;d.y=b;return d};H.prototype={validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},wrapper:function(){if(null==this.outer){this.outer=new t;var a=this.outer.zpp_inner;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=H.zpp_pool;H.zpp_pool=a;this.outer.zpp_inner=
this}return this.outer},add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;this.length++;return b},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=
b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},reverse:function(){for(var a=this.next,b=null;null!=a;){var c=a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},iterator_at:function(a){for(var b=this.next;0<a--&&null!=b;)b=b.next;return b},toString:function(){return"{ x: "+this.x+" y: "+this.y+" }"},__class__:H};var gb=function(){};gb.__name__=!0;gb.vec_dsq=function(a,
b,c,d){var e=0,f=0,e=a-c,f=b-d;return e*e+f*f};var $=function(){this.ishape=this.ibody=this.icompound=this.cbsets=this.group=this.cbTypes=this.cbSet=null;this.id=0;this.outer_i=null;this.id=V.Interactor();this.cbsets=new If;this.cbTypes=new Zb};$.__name__=!0;$.get=function(a,b){var c;c=a.id<b.id?a.id:b.id;var d;d=a.id<b.id?b.id:a.id;for(var e=null,f=(a.cbsets.length<b.cbsets.length?a.cbsets:b.cbsets).head;null!=f;){var h=f.elt;if(h.id==c&&h.di==d){e=h;break}f=f.next}return e};$.int_callback=function(a,
b,c){var d=a.int1,a=a.int2;b.options1.compatible(d.cbTypes)&&b.options2.compatible(a.cbTypes)?(c.int1=d,c.int2=a):(c.int1=a,c.int2=d)};$.prototype={__iaddedToSpace:function(){null!=this.group&&this.group.interactors.add(this);for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.add(this),a=a.next;this.alloc_cbSet()},__iremovedFromSpace:function(){null!=this.group&&this.group.interactors.remove(this);for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.remove(this),a=a.next;this.dealloc_cbSet()},
wake:function(){if(null!=this.ishape){var a=this.ishape.body;null!=a&&null!=a.space&&a.space.non_inlined_wake(a);!0}else null!=this.ibody?null!=this.ibody.space?this.ibody.space.non_inlined_wake(this.ibody):!1:(null!=this.icompound.space&&this.icompound.space.wakeCompound(this.icompound),!0)},insert_cbtype:function(a){if(!this.cbTypes.has(a)){var b;b=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=b&&(this.dealloc_cbSet(),
a.interactors.add(this));for(var c=null,d=this.cbTypes.head;null!=d&&!(a.id<d.elt.id);){c=d;d=d.next}this.cbTypes.inlined_insert(c,a);null!=b&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){var a;a=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;if(null!=(this.cbSet=a.cbsets.get(this.cbTypes)))this.cbSet.count++,this.cbSet.interactors.add(this),this.cbSet.validate(),a.freshInteractorType(this)},dealloc_cbSet:function(){var a;
a=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=this.cbSet&&(this.cbSet.interactors.remove(this),a.nullInteractorType(this),0==--this.cbSet.count&&(a.cbsets.remove(this.cbSet),a=this.cbSet,a.free(),a.next=T.zpp_pool,T.zpp_pool=a),this.cbSet=null)},immutable_midstep:function(a){null!=this.ibody?null:null!=this.ishape?this.ishape.__immutable_midstep(a):this.icompound.__imutable_midstep(a)},lookup_group:function(){for(var a=
this;null!=a&&null==a.group;)a=null!=a.ishape?a.ishape.body:null!=a.icompound?a.icompound.compound:a.ibody.compound;return null==a?null:a.group},__class__:$};var bb=function(){this.wrap_localCOM=this.wrap_worldCOM=null;this.zip_worldCOM=!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_aabb=!1;this.aabb=null;this.norotate=!1;this.cinertia=this.iinertia=this.sinertia=0;this.zip_inertia=!1;this.inertiaMode=this.inertia=0;this.zip_gravMassScale=!1;this.gravMassMode=
this.gravMassScale=0;this.zip_gravMass=!1;this.gravMass=0;this.nomove=!1;this.massMode=this.imass=this.smass=this.cmass=0;this.zip_mass=!1;this.mass=0;this.zip_axis=!1;this.velx=this.vely=this.forcex=this.forcey=this.kinvelx=this.kinvely=this.svelx=this.svely=this.angvel=this.torque=this.kinangvel=this.pre_rot=this.rot=this.axisx=this.axisy=0;this.wrap_pos=null;this.pre_posx=this.pre_posy=this.posx=this.posy=0;this.bullet=this.bulletEnabled=this.disableCCD=!1;this.sweepRadius=0;this.sweepFrozen=!1;
this.sweepTime=this.sweep_angvel=0;this.compound=this.shapes=this.wrap_shapes=this.space=this.arbiters=this.constraints=this.component=null;this.type=0;this.world=!1;this.outer=null;$.call(this);this.ibody=this;this.bulletEnabled=this.world=!1;this.sweep_angvel=this.sweepTime=0;this.disableCCD=this.norotate=this.nomove=!1;this.axisx=this.rot=this.posy=this.posx=0;this.axisy=1;this.torque=this.angvel=this.kinangvel=this.forcey=this.forcex=this.kinvely=this.kinvelx=this.vely=this.velx=this.svely=this.svelx=
0;this.pre_rot=this.pre_posy=this.pre_posx=Math.POSITIVE_INFINITY;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.zip_aabb=!0;this.aabb=qa.get(0,0,0,0);this.aabb._immutable=!0;this.aabb._validate=G(this,this.aabb_validate);this.massMode=g.id_MassMode_DEFAULT;this.gravMassMode=g.id_GravMassMode_DEFAULT;this.gravMassScale=1;this.inertiaMode=g.id_InertiaMode_DEFAULT;this.arbiters=new Td;this.constraints=new Hc;this.shapes=new Kc;this.wrap_shapes=Xb.get(this.shapes);this.wrap_shapes.zpp_inner.adder=
G(this,this.shapes_adder);this.wrap_shapes.zpp_inner.subber=G(this,this.shapes_subber);this.wrap_shapes.zpp_inner._invalidate=G(this,this.shapes_invalidate);this.kinematicDelaySleep=!1};bb.__name__=!0;bb.__static=function(){null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new N,g.internal=!1);var a=new bd(g.BodyType_STATIC),b=a.zpp_inner;b.world=!0;b.wrap_shapes.zpp_inner.immutable=!0;b.smass=b.imass=b.cmass=b.mass=b.gravMass=0;b.sinertia=b.iinertia=b.cinertia=b.inertia=0;b.cbTypes.clear();
return a};bb.__super__=$;bb.prototype=y($.prototype,{invalidate_type:function(){this.invalidate_mass();this.invalidate_inertia()},invalidate_shapes:function(){this.zip_worldCOM=this.zip_localCOM=this.zip_aabb=!0;this.invalidate_mass();this.invalidate_inertia()},atRest:function(a){if(this.type!=g.id_BodyType_DYNAMIC)return this.component.sleeping;var b=m.linearSleepThreshold,b=b*b;if(this.velx*this.velx+this.vely*this.vely>b)a=!1;else if(gb.vec_dsq(this.posx,this.posy,this.pre_posx,this.pre_posy)>
0.25*b*a*a)a=!1;else{var c=b=0,b=this.aabb.maxx-this.aabb.minx,c=this.aabb.maxy-this.aabb.miny,b=b*b+c*c,c=m.angularSleepThreshold,c=c*c;if(4*this.angvel*this.angvel*b>c)a=!1;else var d=this.rot-this.pre_rot,a=d*d*b>c*a*a?!1:!0}a||(this.component.waket=this.space.stamp);return this.component.waket+m.sleepDelay<this.space.stamp},refreshArbiters:function(){for(var a=this.arbiters.head;null!=a;)a.elt.invalidated=!0,a=a.next},sweepIntegrate:function(a){var b=a-this.sweepTime;0!=b&&(this.sweepTime=a,this.posx+=
this.velx*b,this.posy+=this.vely*b,0!=this.angvel&&this.delta_rot(this.sweep_angvel*b))},sweepValidate:function(a){if(a.type==g.id_ShapeType_CIRCLE)a.worldCOMx=this.posx+(this.axisy*a.localCOMx-this.axisx*a.localCOMy),a.worldCOMy=this.posy+(a.localCOMx*this.axisx+a.localCOMy*this.axisy);else{for(var a=a.polygon,b=a.lverts.next,c=a.gverts.next;null!=c;){var d=c,e=b,b=b.next;d.x=this.posx+(this.axisy*e.x-this.axisx*e.y);d.y=this.posy+(e.x*this.axisx+e.y*this.axisy);c=c.next}c=a.edges.head;b=d=a.gverts.next;
for(d=d.next;null!=d;){var e=d,f=c.elt,c=c.next;f.gnormx=this.axisy*f.lnormx-this.axisx*f.lnormy;f.gnormy=f.lnormx*this.axisx+f.lnormy*this.axisy;f.gprojection=this.posx*f.gnormx+this.posy*f.gnormy+f.lprojection;f.tp0=b.y*f.gnormx-b.x*f.gnormy;f.tp1=e.y*f.gnormx-e.x*f.gnormy;b=e;d=d.next}a=a.gverts.next;c=c.elt;c.gnormx=this.axisy*c.lnormx-this.axisx*c.lnormy;c.gnormy=c.lnormx*this.axisx+c.lnormy*this.axisy;c.gprojection=this.posx*c.gnormx+this.posy*c.gnormy+c.lprojection;c.tp0=b.y*c.gnormx-b.x*c.gnormy;
c.tp1=a.y*c.gnormx-a.x*c.gnormy}},invalidate_pos:function(){for(var a=this.shapes.head;null!=a;){var b=a.elt;b.type==g.id_ShapeType_POLYGON&&(b.polygon.invalidate_gverts(),b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=a.next}this.zip_worldCOM=!0},pos_invalidate:function(a){this.immutable_midstep("Body::position");this.posx==a.x&&this.posy==a.y||(this.posx=a.x,this.posy=a.y,this.invalidate_pos(),this.wake())},pos_validate:function(){this.wrap_pos.zpp_inner.x=this.posx;this.wrap_pos.zpp_inner.y=
this.posy},setupPosition:function(){this.wrap_pos=t.get(this.posx,this.posy,null);this.wrap_pos.zpp_inner._inuse=!0;this.world?this.wrap_pos.zpp_inner._immutable=!0:(this.wrap_pos.zpp_inner._invalidate=G(this,this.pos_invalidate),this.wrap_pos.zpp_inner._validate=G(this,this.pos_validate))},invalidate_rot:function(){this.zip_axis=!0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.type==g.id_ShapeType_POLYGON&&(b.polygon.invalidate_gverts(),b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=
a.next}this.zip_worldCOM=!0},validate_axis:function(){this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null)},delta_rot:function(a){this.rot+=a;if(1.0E-4<a*a)this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null;else{var b=a*a,c=1-0.5*b,b=1-b*b/8,d=(c*this.axisx+a*this.axisy)*b;this.axisy=(c*this.axisy-a*this.axisx)*b;this.axisx=d}},invalidate_mass:function(){this.zip_mass=!0;this.invalidate_gravMass()},validate_mass:function(){if(this.zip_mass){this.zip_mass=
!1;if(this.massMode==g.id_MassMode_DEFAULT){this.cmass=0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;b.validate_area_inertia();this.cmass+=b.area*b.material.density;a=a.next}}this.type==g.id_BodyType_DYNAMIC&&!this.nomove?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=Math.POSITIVE_INFINITY,this.imass=this.smass=0)}},invalidate_gravMass:function(){this.gravMassMode!=g.id_GravMassMode_FIXED&&(this.zip_gravMass=!0);this.gravMassMode!=
g.id_GravMassMode_SCALED&&(this.zip_gravMassScale=!0);this.wake()},validate_gravMass:function(){this.zip_gravMass&&(this.zip_gravMass=!1,this.validate_mass(),this.gravMassMode==g.id_GravMassMode_DEFAULT?(this.validate_mass(),this.gravMass=this.cmass):this.gravMassMode==g.id_GravMassMode_SCALED&&(this.validate_mass(),this.gravMass=this.cmass*this.gravMassScale))},invalidate_inertia:function(){this.zip_inertia=!0;this.wake()},validate_inertia:function(){if(this.zip_inertia){this.zip_inertia=!1;if(this.inertiaMode==
g.id_InertiaMode_DEFAULT){this.cinertia=0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;b.validate_area_inertia();this.cinertia+=b.inertia*b.area*b.material.density;a=a.next}}this.type==g.id_BodyType_DYNAMIC&&!this.norotate?(this.inertia=this.cinertia,this.sinertia=this.iinertia=1/this.inertia):(this.inertia=Math.POSITIVE_INFINITY,this.sinertia=this.iinertia=0)}},validate_aabb:function(){if(this.zip_aabb){this.zip_aabb=!1;this.aabb.minx=Math.POSITIVE_INFINITY;
this.aabb.miny=Math.POSITIVE_INFINITY;this.aabb.maxx=Math.NEGATIVE_INFINITY;this.aabb.maxy=Math.NEGATIVE_INFINITY;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,b.type==g.id_ShapeType_CIRCLE?b.circle.__validate_aabb():b.polygon.__validate_aabb());this.aabb.combine(b.aabb);a=a.next}}},invalidate_localCOM:function(){this.zip_worldCOM=this.zip_localCOM=!0},validate_localCOM:function(){if(this.zip_localCOM){this.zip_localCOM=!1;for(var a=0,b=0,c=0,d=this.shapes.head;null!=
d;){var e=d.elt;e.zip_localCOM&&(e.zip_localCOM=!1,e.type==g.id_ShapeType_POLYGON&&e.polygon.__validate_localCOM(),null!=e.wrap_localCOM&&(e.wrap_localCOM.zpp_inner.x=e.localCOMx,e.wrap_localCOM.zpp_inner.y=e.localCOMy));e.validate_area_inertia();var f=e.area*e.material.density,a=a+e.localCOMx*f,b=b+e.localCOMy*f,c=c+e.area*e.material.density,d=d.next}0!=c&&(d=1/c,this.localCOMx=a*d,this.localCOMy=b*d);null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=
this.localCOMy);this.zip_mass&&this.massMode==g.id_MassMode_DEFAULT&&(this.zip_mass=!1,this.cmass=c,this.type==g.id_BodyType_DYNAMIC?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=Math.POSITIVE_INFINITY,this.imass=this.smass=0))}},validate_worldCOM:function(){this.zip_worldCOM&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null),this.worldCOMx=this.posx+(this.axisy*this.localCOMx-this.axisx*
this.localCOMy),this.worldCOMy=this.posy+(this.localCOMx*this.axisx+this.localCOMy*this.axisy),null!=this.wrap_worldCOM&&(this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy))},aabb_validate:function(){this.validate_aabb()},shapes_adder:function(a){return a.zpp_inner.body!=this?(null!=a.zpp_inner.body&&a.zpp_inner.body.wrap_shapes.remove(a),a.zpp_inner.body=this,a.zpp_inner.addedToBody(),null!=this.space&&this.space.added_shape(a.zpp_inner,null),a.zpp_inner.type==
g.id_ShapeType_POLYGON&&(a.zpp_inner.polygon.invalidate_gaxi(),a.zpp_inner.polygon.invalidate_gverts()),!0):!1},shapes_subber:function(a){null!=this.space&&this.space.removed_shape(a.zpp_inner);a.zpp_inner.body=null;a.zpp_inner.removedFromBody()},shapes_invalidate:function(){this.invalidate_shapes()},addedToSpace:function(){null==Z.zpp_pool?this.component=new Z:(this.component=Z.zpp_pool,Z.zpp_pool=this.component.next,this.component.next=null);null;this.component.isBody=!0;this.component.body=this;
this.__iaddedToSpace()},removedFromSpace:function(){for(;null!=this.arbiters.head;){var a=this.arbiters.pop_unsafe();a.cleared=!0;a.b2==this&&a.b1.arbiters.inlined_try_remove(a);a.b1==this&&a.b2.arbiters.inlined_try_remove(a);null!=a.pair&&(a.pair.arb=null,a.pair=null);a.active=!1;this.space.f_arbiters.modified=!0}a=this.component;a.body=null;a.constraint=null;null;a.next=Z.zpp_pool;Z.zpp_pool=a;this.component=null;this.__iremovedFromSpace()},__class__:bb});var Jf=function(){this.compound=this.space=
null;this.depth=0;this.outer=this.bodies=this.constraints=this.compounds=this.wrap_constraints=null};Jf.__name__=!0;Jf.__super__=$;Jf.prototype=y($.prototype,{__imutable_midstep:function(){},addedToSpace:function(){this.__iaddedToSpace()},removedFromSpace:function(){this.__iremovedFromSpace()},__class__:Jf});var K=function(){this.dynamicFriction=this.staticFriction=this.density=this.elasticity=this.rollingFriction=0;this.next=this.outer=this.shapes=null;this.shapes=new Kc;this.elasticity=0;this.dynamicFriction=
1;this.staticFriction=2;this.density=0.001;this.rollingFriction=0.01};K.__name__=!0;K.prototype={wrapper:function(){if(null==this.outer){this.outer=new Fb;var a=this.outer.zpp_inner;a.outer=null;a.next=K.zpp_pool;K.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},set:function(a){this.dynamicFriction=a.dynamicFriction;this.staticFriction=a.staticFriction;this.density=a.density;this.elasticity=a.elasticity;this.rollingFriction=a.rollingFriction},invalidate:function(a){for(var b=this.shapes.head;null!=
b;)b.elt.invalidate_material(a),b=b.next},__class__:K};var Lb=function(a){this.zip_aabb=!1;this.sweep=this.node=this.pairs=this.aabb=null;this.fluidEnabled=this.sensorEnabled=!1;this.circle=this.polygon=this.refmaterial=this.material=this.filter=this.fluidProperties=null;this.sweepCoef=0;this.zip_sweepRadius=!1;this.sweepRadius=0;this.wrap_localCOM=null;this.zip_worldCOM=!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_angDrag=!1;this.inertia=this.angDrag=
0;this.zip_area_inertia=!1;this.type=this.area=0;this.outer=this.body=null;$.call(this);this.pairs=new Kf;this.ishape=this;this.type=a;this.aabb=qa.get(0,0,0,0);this.aabb._immutable=!0;this.aabb._validate=G(this,this.aabb_validate);this.zip_area_inertia=this.zip_angDrag=this.zip_localCOM=this.zip_sweepRadius=!0;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.sensorEnabled=this.fluidEnabled=!1;this.body=this.fluidProperties=null;this.refmaterial=new K;this.sweepRadius=this.sweepCoef=
0};Lb.__name__=!0;Lb.__super__=$;Lb.prototype=y($.prototype,{validate_sweepRadius:function(){this.zip_sweepRadius&&(this.zip_sweepRadius=!1,this.type==g.id_ShapeType_CIRCLE?this.circle.__validate_sweepRadius():this.polygon.__validate_sweepRadius())},validate_area_inertia:function(){this.zip_area_inertia&&(this.zip_area_inertia=!1,this.type==g.id_ShapeType_CIRCLE?this.circle.__validate_area_inertia():this.polygon.__validate_area_inertia())},validate_angDrag:function(){if(this.zip_angDrag||this.refmaterial.dynamicFriction!=
this.material.dynamicFriction)this.zip_angDrag=!1,this.refmaterial.dynamicFriction=this.material.dynamicFriction,this.type==g.id_ShapeType_CIRCLE?this.circle.__validate_angDrag():this.polygon.__validate_angDrag()},validate_worldCOM:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==g.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=
this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy))},invalidate_area_inertia:function(){this.zip_area_inertia=!0;null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia())},invalidate_angDrag:function(){this.zip_angDrag=!0},invalidate_localCOM:function(){this.zip_localCOM=
!0;this.invalidate_area_inertia();this.type==g.id_ShapeType_CIRCLE&&(this.zip_sweepRadius=!0);this.invalidate_angDrag();this.invalidate_worldCOM();null!=this.body&&this.body.invalidate_localCOM()},invalidate_worldCOM:function(){this.zip_aabb=this.zip_worldCOM=!0;null!=this.body&&(this.body.zip_aabb=!0)},invalidate_material:function(a){0!=(a&K.WAKE)&&this.wake();0!=(a&K.ARBITERS)&&null!=this.body&&this.body.refreshArbiters();0!=(a&K.PROPS)&&null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),
this.body.invalidate_inertia());0!=(a&K.ANGDRAG)&&this.invalidate_angDrag();this.refmaterial.set(this.material)},invalidate_filter:function(){this.wake()},aabb_validate:function(){this.zip_aabb&&null!=this.body&&(this.zip_aabb=!1,this.type==g.id_ShapeType_CIRCLE?this.circle.__validate_aabb():this.polygon.__validate_aabb())},setMaterial:function(a){this.material!=a&&(null!=this.body&&null!=this.body.space&&null!=this.material&&this.material.shapes.remove(this),this.material=a,null!=this.body&&null!=
this.body.space&&a.shapes.add(this),this.wake(),null!=this.body&&this.body.refreshArbiters())},setFilter:function(a){this.filter!=a&&(null!=this.body&&null!=this.body.space&&null!=this.filter&&this.filter.shapes.remove(this),this.filter=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.wake())},__immutable_midstep:function(){},addedToBody:function(){this.invalidate_worldCOM();this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0)},removedFromBody:function(){},addedToSpace:function(){this.__iaddedToSpace();
this.material.shapes.add(this);this.filter.shapes.add(this);null!=this.fluidProperties&&this.fluidProperties.shapes.add(this)},removedFromSpace:function(){this.__iremovedFromSpace();this.material.shapes.remove(this);this.filter.shapes.remove(this);null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this)},__class__:Lb});var ke=function(){this.radius=0;this.outer_zn=null;Lb.call(this,g.id_ShapeType_CIRCLE);this.circle=this;this.zip_localCOM=!1};ke.__name__=!0;ke.__super__=Lb;ke.prototype=
y(Lb.prototype,{invalidate_radius:function(){this.invalidate_area_inertia();this.invalidate_angDrag();this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0);null!=this.body&&this.body.wake()},__validate_aabb:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==g.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),
this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy));var a=this.radius,b=this.radius;this.aabb.minx=this.worldCOMx-a;this.aabb.miny=this.worldCOMy-b;this.aabb.maxx=this.worldCOMx+a;this.aabb.maxy=this.worldCOMy+b},_force_validate_aabb:function(){this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy);
this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy);this.aabb.minx=this.worldCOMx-this.radius;this.aabb.miny=this.worldCOMy-this.radius;this.aabb.maxx=this.worldCOMx+this.radius;this.aabb.maxy=this.worldCOMy+this.radius},__validate_sweepRadius:function(){this.sweepCoef=Math.sqrt(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy);this.sweepRadius=this.sweepCoef+this.radius},__validate_area_inertia:function(){var a=this.radius*this.radius;this.area=
a*Math.PI;this.inertia=0.5*a+(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy)},__validate_angDrag:function(){var a=this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy,b=this.radius*this.radius;this.angDrag=(a+2*b)*this.material.dynamicFriction*m.fluidAngularDragFriction+0.5*m.fluidAngularDrag*(1+m.fluidVacuumDrag)*a;this.angDrag/=2*(a+0.5*b)},__translate:function(a,b){this.localCOMx+=1*a;this.localCOMy+=1*b;this.invalidate_localCOM()},__class__:ke});var R=function(){this.tp0=
this.tp1=0;this.lp0=this.gp0=this.lp1=this.gp1=null;this.length=this.lprojection=this.gprojection=0;this.wrap_gnorm=null;this.gnormx=this.gnormy=0;this.wrap_lnorm=null;this.lnormx=this.lnormy=0;this.next=this.polygon=this.outer=null;this.gprojection=this.lprojection=this.length=this.gnormy=this.gnormx=this.lnormy=this.lnormx=0};R.__name__=!0;R.prototype={wrapper:function(){null==this.outer&&(R.internal=!0,this.outer=new zf,R.internal=!1,this.outer.zpp_inner=this);return this.outer},__class__:R};var te=
function(){this.reverse_flag=this.zip_lverts=this.zip_laxi=this.zip_gverts=this.zip_gaxi=this.zip_valid=this.zip_sanitation=!1;this.edgeCnt=0;this.outer_zn=this.lverts=this.wrap_lverts=this.gverts=this.wrap_gverts=this.edges=this.wrap_edges=null;Lb.call(this,g.id_ShapeType_POLYGON);this.polygon=this;this.lverts=new H;this.gverts=new H;this.edges=new Lf;this.edgeCnt=0};te.__name__=!0;te.__super__=Lb;te.prototype=y(Lb.prototype,{lverts_pa_invalidate:function(){this.invalidate_lverts()},gverts_pa_validate:function(){this.validate_gverts()},
lverts_post_adder:function(a){a.zpp_inner._invalidate=G(this,this.lverts_pa_invalidate);for(var b=null,c=null,d=this.lverts.next;null!=d&&!(d==a.zpp_inner);){b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:c.next;d=d.next}a=H.get(0,0,!0);this.gverts.insert(b,a);null!=this.lverts.next.next&&(null==this.lverts.next.next.next?(null==R.zpp_pool?c=new R:(c=R.zpp_pool,R.zpp_pool=c.next,c.next=null),null,c.polygon=this,this.edges.add(c),null==R.zpp_pool?c=new R:(c=R.zpp_pool,R.zpp_pool=c.next,
c.next=null),null,c.polygon=this,this.edges.add(c),this.edgeCnt+=2):(null==R.zpp_pool?b=new R:(b=R.zpp_pool,R.zpp_pool=b.next,b.next=null),null,b.polygon=this,this.edges.insert(c,b),this.edgeCnt++));a._validate=G(this,this.gverts_pa_validate)},lverts_subber:function(a){this.cleanup_lvert(a.zpp_inner)},lverts_invalidate:function(){this.invalidate_lverts()},lverts_validate:function(){this.validate_lverts()},getlverts:function(){this.wrap_lverts=ed.get(this.lverts);this.wrap_lverts.zpp_inner.post_adder=
G(this,this.lverts_post_adder);this.wrap_lverts.zpp_inner.subber=G(this,this.lverts_subber);this.wrap_lverts.zpp_inner._invalidate=G(this,this.lverts_invalidate);this.wrap_lverts.zpp_inner._validate=G(this,this.lverts_validate);this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag},invalidate_lverts:function(){this.invalidate_laxi();this.invalidate_area_inertia();this.invalidate_angDrag();this.invalidate_localCOM();this.invalidate_gverts();this.zip_sanitation=this.zip_valid=this.zip_lverts=!0;
null!=this.body&&this.body.wake()},invalidate_laxi:function(){this.invalidate_gaxi();this.zip_laxi=this.zip_sweepRadius=!0},invalidate_gverts:function(){this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0);this.zip_gverts=!0},invalidate_gaxi:function(){this.zip_gaxi=!0},validate_lverts:function(){this.zip_lverts&&(this.zip_lverts=!1,2<this.lverts.length&&(this.validate_area_inertia(),0>this.area&&(this.reverse_vertices(),this.area=-this.area)))},cleanup_lvert:function(a){for(var b=null,c=null,
d=this.lverts.next;null!=d&&!(d==a);){b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:c.next;d=d.next}a=null==b?this.gverts.next:b.next;this.gverts.erase(b);null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=H.zpp_pool;H.zpp_pool=a;2==this.edgeCnt?(c=this.edges.pop_unsafe(),c.polygon=null,c.next=R.zpp_pool,R.zpp_pool=c,c=this.edges.pop_unsafe(),c.polygon=null,c.next=R.zpp_pool,R.zpp_pool=c,this.edgeCnt=0):0!=this.edgeCnt&&
(b=null==c?this.edges.head.elt:c.next.elt,this.edges.erase(c),b.polygon=null,b.next=R.zpp_pool,R.zpp_pool=b,this.edgeCnt--)},splice_collinear:function(){this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real())},splice_collinear_real:function(){if(!(null==this.lverts.next||null==this.lverts.next.next)&&null!=this.lverts.next.next.next){for(var a=null,b=this.lverts.next;null!=b;){var c=b,d=null==b.next?this.lverts.next:b.next;gb.vec_dsq(c.x,c.y,d.x,d.y)<m.epsilon*m.epsilon?(this.cleanup_lvert(b),
b=this.lverts.erase(a)):(a=b,b=b.next)}if(null!=this.lverts.next){do{a=!1;for(b=this.lverts.next;null!=b;){var c=null==b.next?this.lverts.next:b.next,e=b,d=c,f=null==c.next?this.lverts.next:c.next,h=0,g=0,h=d.x-e.x,g=d.y-e.y,k=e=0,e=f.x-d.x,k=f.y-d.y,d=k*h-e*g;d*d>=m.epsilon*m.epsilon||(this.cleanup_lvert(c),this.lverts.erase(null==b.next?null:b),a=!0);b=b.next}}while(a)}}},reverse_vertices:function(){this.lverts.reverse();this.gverts.reverse();this.edges.reverse();var a=this.edges.iterator_at(this.edgeCnt-
1),b=this.edges.pop_unsafe();this.edges.insert(a,b);this.reverse_flag=!this.reverse_flag;null!=this.wrap_lverts&&(this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag);null!=this.wrap_gverts&&(this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag);null!=this.wrap_edges&&(this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag)},validate_laxi:function(){if(this.zip_laxi){this.zip_laxi=!1;this.validate_lverts();for(var a=this.edges.head,b=this.lverts.next,c=b,b=b.next;null!=b;){var d=b,e=
a.elt,a=a.next;e.lp0=c;e.lp1=d;var f=0,h=0,f=c.x-d.x,h=c.y-d.y,g=Math.sqrt(f*f+h*h);e.length=g;g=1/g;f*=g;h*=g;g=f;f=-h;h=g;e.lprojection=f*c.x+h*c.y;e.lnormx=f;e.lnormy=h;null!=e.wrap_lnorm&&(e.wrap_lnorm.zpp_inner.x=f,e.wrap_lnorm.zpp_inner.y=h);c=d;b=b.next}e=this.lverts.next;a=a.elt;a.lp0=c;a.lp1=e;d=b=0;b=c.x-e.x;d=c.y-e.y;e=Math.sqrt(b*b+d*d);a.length=e;e=1/e;f=b*e;b=-(d*e);d=f;a.lprojection=b*c.x+d*c.y;a.lnormx=b;a.lnormy=d;null!=a.wrap_lnorm&&(a.wrap_lnorm.zpp_inner.x=b,a.wrap_lnorm.zpp_inner.y=
d)}},validate_gverts:function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1;this.validate_lverts();this.body.validate_axis();for(var a=this.lverts.next,b=this.gverts.next;null!=b;){var c=b,d=a,a=a.next;c.x=this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);c.y=this.body.posy+(d.x*this.body.axisx+d.y*this.body.axisy);b=b.next}}},validate_gaxi:function(){if(this.zip_gaxi&&null!=this.body){this.zip_gaxi=!1;this.validate_laxi();this.body.validate_axis();this.validate_gverts();for(var a=
this.edges.head,b=this.gverts.next,c=b,b=b.next;null!=b;){var d=b,e=a.elt,a=a.next;e.gp0=c;e.gp1=d;e.gnormx=this.body.axisy*e.lnormx-this.body.axisx*e.lnormy;e.gnormy=e.lnormx*this.body.axisx+e.lnormy*this.body.axisy;e.gprojection=this.body.posx*e.gnormx+this.body.posy*e.gnormy+e.lprojection;null!=e.wrap_gnorm&&(e.wrap_gnorm.zpp_inner.x=e.gnormx,e.wrap_gnorm.zpp_inner.y=e.gnormy);e.tp0=e.gp0.y*e.gnormx-e.gp0.x*e.gnormy;e.tp1=e.gp1.y*e.gnormx-e.gp1.x*e.gnormy;c=d;b=b.next}b=this.gverts.next;a=a.elt;
a.gp0=c;a.gp1=b;a.gnormx=this.body.axisy*a.lnormx-this.body.axisx*a.lnormy;a.gnormy=a.lnormx*this.body.axisx+a.lnormy*this.body.axisy;a.gprojection=this.body.posx*a.gnormx+this.body.posy*a.gnormy+a.lprojection;null!=a.wrap_gnorm&&(a.wrap_gnorm.zpp_inner.x=a.gnormx,a.wrap_gnorm.zpp_inner.y=a.gnormy);a.tp0=a.gp0.y*a.gnormx-a.gp0.x*a.gnormy;a.tp1=a.gp1.y*a.gnormx-a.gp1.x*a.gnormy}},__validate_aabb:function(){this.validate_gverts();var a=this.gverts.next;this.aabb.minx=a.x;this.aabb.miny=a.y;this.aabb.maxx=
a.x;this.aabb.maxy=a.y;for(a=this.gverts.next.next;null!=a;){var b=a;b.x<this.aabb.minx&&(this.aabb.minx=b.x);b.x>this.aabb.maxx&&(this.aabb.maxx=b.x);b.y<this.aabb.miny&&(this.aabb.miny=b.y);b.y>this.aabb.maxy&&(this.aabb.maxy=b.y);a=a.next}},_force_validate_aabb:function(){var a=this.lverts.next,b=this.gverts.next,c=a,a=a.next;b.x=this.body.posx+(this.body.axisy*c.x-this.body.axisx*c.y);b.y=this.body.posy+(c.x*this.body.axisx+c.y*this.body.axisy);this.aabb.minx=b.x;this.aabb.miny=b.y;this.aabb.maxx=
b.x;this.aabb.maxy=b.y;for(b=this.gverts.next.next;null!=b;){var c=b,d=a,a=a.next;c.x=this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);c.y=this.body.posy+(d.x*this.body.axisx+d.y*this.body.axisy);c.x<this.aabb.minx&&(this.aabb.minx=c.x);c.x>this.aabb.maxx&&(this.aabb.maxx=c.x);c.y<this.aabb.miny&&(this.aabb.miny=c.y);c.y>this.aabb.maxy&&(this.aabb.maxy=c.y);b=b.next}},__validate_sweepRadius:function(){var a=0,b=0;this.validate_laxi();for(var c=this.lverts.next;null!=c;){var d=c,d=d.x*d.x+
d.y*d.y;d>a&&(a=d);c=c.next}for(c=this.edges.head;null!=c;){d=c.elt;if(d.lprojection<b&&(b=d.lprojection,0>b))break;c=c.next}0>b&&(b=0);this.sweepRadius=Math.sqrt(a);this.sweepCoef=this.sweepRadius-b},__validate_area_inertia:function(){if(null==this.lverts.next||null==this.lverts.next.next||null==this.lverts.next.next.next)this.inertia=this.area=0;else{for(var a=this.area=0,b=0,c=this.lverts.next,d=c,e=c=c.next,c=c.next;null!=c;){var f=c,h=e.y*d.x-e.x*d.y,a=a+h*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+
(d.x*d.x+d.y*d.y)),b=b+h;this.area+=e.x*(f.y-d.y);d=e;e=f;c=c.next}h=c=this.lverts.next;f=e.y*d.x-e.x*d.y;a+=f*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));this.area+=e.x*(h.y-d.y);d=e;e=h;c=c.next;h=e.y*d.x-e.x*d.y;a+=h*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));this.area+=e.x*(c.y-d.y);this.inertia=a/(6*(b+f+h));this.area*=0.5;0>this.area&&(this.area=-this.area,this.reverse_vertices())}},__validate_angDrag:function(){this.validate_area_inertia();this.validate_laxi();for(var a=
0,b=this.edges.head,c=0,d=this.lverts.next,e=d,d=d.next;null!=d;){var f=d,h=b.elt,b=b.next,c=c+h.length,g=0,k=0,g=f.x-e.x,k=f.y-e.y,a=a+h.length*m.fluidAngularDragFriction*this.material.dynamicFriction*h.lprojection*h.lprojection,n=-(e.y*h.lnormx-e.x*h.lnormy)/(k*h.lnormx-g*h.lnormy);if(0<n){var l;l=1<n?1:n;var j=0,r=0,j=e.x,r=e.y,o=l,j=j+g*o,r=r+k*o,o=h.lnormy*e.x-h.lnormx*e.y,j=h.lnormy*j-h.lnormx*r,a=a+(j*j*j-o*o*o)/(3*(j-o))*l*h.length*m.fluidAngularDrag}1>n&&(n=0>n?0:n,j=l=0,l=e.x,j=e.y,e=n,
l+=g*e,j+=k*e,e=h.lnormy*l-h.lnormx*j,g=h.lnormy*f.x-h.lnormx*f.y,a+=(g*g*g-e*e*e)/(3*(g-e))*m.fluidVacuumDrag*(1-n)*h.length*m.fluidAngularDrag);e=f;d=d.next}d=this.lverts.next;b=b.elt;c+=b.length;h=f=0;f=d.x-e.x;h=d.y-e.y;a+=b.length*m.fluidAngularDragFriction*this.material.dynamicFriction*b.lprojection*b.lprojection;g=-(e.y*b.lnormx-e.x*b.lnormy)/(h*b.lnormx-f*b.lnormy);0<g&&(k=1<g?1:g,j=l=0,l=e.x,j=e.y,n=b.lnormy*e.x-b.lnormx*e.y,l=b.lnormy*(l+f*k)-b.lnormx*(j+h*k),a+=(l*l*l-n*n*n)/(3*(l-n))*
k*b.length*m.fluidAngularDrag);1>g&&(g=0>g?0:g,n=k=0,k=e.x,n=e.y,e=b.lnormy*(k+f*g)-b.lnormx*(n+h*g),d=b.lnormy*d.x-b.lnormx*d.y,a+=(d*d*d-e*e*e)/(3*(d-e))*m.fluidVacuumDrag*(1-g)*b.length*m.fluidAngularDrag);this.angDrag=a/(this.inertia*c)},__validate_localCOM:function(){if(null==this.lverts.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y;else if(null==this.lverts.next.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y,this.localCOMx+=1*this.lverts.next.next.x,
this.localCOMy+=1*this.lverts.next.next.y,this.localCOMx*=0.5,this.localCOMy*=0.5;else{for(var a=this.localCOMy=this.localCOMx=0,b=this.lverts.next,c=b,d=b=b.next,b=b.next;null!=b;){var e=b,a=a+d.x*(e.y-c.y),c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next}e=b=this.lverts.next;a+=d.x*(e.y-c.y);c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next;a+=d.x*(b.y-c.y);c=b.y*d.x-b.x*d.y;this.localCOMx+=(d.x+b.x)*c;this.localCOMy+=
(d.y+b.y)*c;a=1/(3*a);this.localCOMx*=a;this.localCOMy*=a}},__translate:function(a,b){for(var c=this.lverts.next;null!=c;){var d=c;d.x+=1*a;d.y+=1*b;c=c.next}this.invalidate_lverts()},__class__:te});var qc=function(){this.sweep=this.dynab=null;this.is_sweep=!1;this.space=null};qc.__name__=!0;qc.prototype={insert:function(a){this.is_sweep?this.sweep.__insert(a):this.dynab.__insert(a)},remove:function(a){this.is_sweep?this.sweep.__remove(a):this.dynab.__remove(a)},sync:function(a){this.is_sweep?!this.sweep.space.continuous&&
a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,a.type==g.id_ShapeType_CIRCLE?a.circle.__validate_aabb():a.polygon.__validate_aabb()):this.dynab.__sync(a)},broadphase:function(){},bodiesUnderPoint:function(){return null},__class__:qc};var la=function(){this.synced=this.first_sync=!1;this.snext=null;this.moved=!1;this.next=this.mnext=null;this.height=0;this.parent=this.child1=this.child2=null;this.dyn=!1;this.aabb=this.shape=null;this.height=-1};la.__name__=!0;la.prototype={free:function(){this.height=-1;
var a=this.aabb;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a.wrap_min=a.wrap_max=null;a._invalidate=null;a._validate=null;a.next=qa.zpp_pool;qa.zpp_pool=a;this.mnext=this.snext=this.next=this.child1=this.child2=this.parent=null},__class__:la};var X=function(){this.arb=this.next=null;this.id=this.di=0;this.first=this.sleeping=!1;this.n1=this.n2=null};X.__name__=!0;X.prototype={__class__:X};var Aa=function(){this.root=null};Aa.__name__=!0;Aa.prototype={inlined_insertLeaf:function(a){if(null==
this.root)this.root=a,this.root.parent=null;else{for(var b=a.aabb,c=this.root;null!=c.child1;){var d=c.child1,e=c.child2,f=c.aabb.perimeter();Aa.tmpaabb.setCombine(c.aabb,b);var h=Aa.tmpaabb.perimeter(),g=2*h,f=2*(h-f);Aa.tmpaabb.setCombine(b,d.aabb);null==d.child1?h=Aa.tmpaabb.perimeter()+f:(h=d.aabb.perimeter(),h=Aa.tmpaabb.perimeter()-h+f);Aa.tmpaabb.setCombine(b,e.aabb);if(null==e.child1)f=Aa.tmpaabb.perimeter()+f;else var k=e.aabb.perimeter(),f=Aa.tmpaabb.perimeter()-k+f;if(g<h&&g<f)break;else c=
h<f?d:e}d=c.parent;null==la.zpp_pool?e=new la:(e=la.zpp_pool,la.zpp_pool=e.next,e.next=null);null==qa.zpp_pool?e.aabb=new qa:(e.aabb=qa.zpp_pool,qa.zpp_pool=e.aabb.next,e.aabb.next=null);null;e.moved=!1;e.synced=!1;e.first_sync=!1;e.parent=d;e.aabb.setCombine(b,c.aabb);e.height=c.height+1;null!=d?(d.child1==c?d.child1=e:d.child2=e,e.child1=c,e.child2=a,c.parent=e,a.parent=e):(e.child1=c,e.child2=a,c.parent=e,this.root=a.parent=e);for(c=a.parent;null!=c;)c=this.balance(c),a=c.child1,b=c.child2,d=a.height,
e=b.height,c.height=1+(d>e?d:e),c.aabb.setCombine(a.aabb,b.aabb),c=c.parent}},removeLeaf:function(a){this.inlined_removeLeaf(a)},inlined_removeLeaf:function(a){if(a==this.root)this.root=null;else{var b=a.parent,c=b.parent,a=b.child1==a?b.child2:b.child1;if(null!=c){c.child1==b?c.child1=a:c.child2=a;a.parent=c;b.free();b.next=la.zpp_pool;la.zpp_pool=b;for(b=c;null!=b;)b=this.balance(b),a=b.child1,c=b.child2,b.aabb.setCombine(a.aabb,c.aabb),a=a.height,c=c.height,b.height=1+(a>c?a:c),b=b.parent}else this.root=
a,a.parent=null,b.free(),b.next=la.zpp_pool,la.zpp_pool=b}},balance:function(a){if(null==a.child1||2>a.height)return a;var b=a.child1,c=a.child2,d=c.height-b.height;if(1<d){var e=c.child1,f=c.child2;c.child1=a;c.parent=a.parent;a.parent=c;null!=c.parent?c.parent.child1==a?c.parent.child1=c:c.parent.child2=c:this.root=c;e.height>f.height?(c.child2=e,a.child2=f,f.parent=a,a.aabb.setCombine(b.aabb,f.aabb),c.aabb.setCombine(a.aabb,e.aabb),a.height=1+function(){var a=b.height,c=f.height;return a>c?a:c}(this),
c.height=1+function(){var b=a.height,c=e.height;return b>c?b:c}(this)):(c.child2=f,a.child2=e,e.parent=a,a.aabb.setCombine(b.aabb,e.aabb),c.aabb.setCombine(a.aabb,f.aabb),a.height=1+function(){var a=b.height,c=e.height;return a>c?a:c}(this),c.height=1+function(){var b=a.height,c=f.height;return b>c?b:c}(this));return c}if(-1>d){var h=b.child1,g=b.child2;b.child1=a;b.parent=a.parent;a.parent=b;null!=b.parent?b.parent.child1==a?b.parent.child1=b:b.parent.child2=b:this.root=b;h.height>g.height?(b.child2=
h,a.child1=g,g.parent=a,a.aabb.setCombine(c.aabb,g.aabb),b.aabb.setCombine(a.aabb,h.aabb),a.height=1+function(){var a=c.height,b=g.height;return a>b?a:b}(this),b.height=1+function(){var b=a.height,c=h.height;return b>c?b:c}(this)):(b.child2=g,a.child1=h,h.parent=a,a.aabb.setCombine(c.aabb,h.aabb),b.aabb.setCombine(a.aabb,g.aabb),a.height=1+function(){var a=c.height,b=h.height;return a>b?a:b}(this),b.height=1+function(){var b=a.height,c=g.height;return b>c?b:c}(this));return b}return a},__class__:Aa};
var Be=function(a){this.stree=this.dtree=this.pairs=this.syncs=this.moves=this.treeStack=null;qc.call(this);this.space=a;this.is_sweep=!1;this.dynab=this;this.stree=new Aa;this.dtree=new Aa};Be.__name__=!0;Be.__super__=qc;Be.prototype=y(qc.prototype,{__insert:function(a){var b;null==la.zpp_pool?b=new la:(b=la.zpp_pool,la.zpp_pool=b.next,b.next=null);null==qa.zpp_pool?b.aabb=new qa:(b.aabb=qa.zpp_pool,qa.zpp_pool=b.aabb.next,b.aabb.next=null);null;b.moved=!1;b.synced=!1;b.first_sync=!1;b.shape=a;a.node=
b;b.synced=!0;b.first_sync=!0;b.snext=this.syncs;this.syncs=b},__remove:function(a){var b=a.node;b.first_sync||(b.dyn?this.dtree.removeLeaf(b):this.stree.removeLeaf(b));a.node=null;if(b.synced){for(var c=null,d=this.syncs;null!=d&&!(d==b);){c=d;d=d.snext}null==c?this.syncs=d.snext:c.snext=d.snext;d.snext=null;b.synced=!1}if(b.moved){c=null;for(d=this.moves;null!=d&&!(d==b);){c=d;d=d.mnext}null==c?this.moves=d.mnext:c.mnext=d.mnext;d.mnext=null;b.moved=!1}for(var c=null,e=this.pairs;null!=e;)d=e.next,
e.n1==b||e.n2==b?(null==c?this.pairs=d:c.next=d,null!=e.arb&&(e.arb.pair=null),e.arb=null,e.n1.shape.pairs.remove(e),e.n2.shape.pairs.remove(e),e.n1=e.n2=null,e.sleeping=!1,e.next=X.zpp_pool,X.zpp_pool=e):c=e,e=d;for(;null!=a.pairs.head;)c=a.pairs.pop_unsafe(),c.n1==b?c.n2.shape.pairs.remove(c):c.n1.shape.pairs.remove(c),null!=c.arb&&(c.arb.pair=null),c.arb=null,c.n1=c.n2=null,c.sleeping=!1,c.next=X.zpp_pool,X.zpp_pool=c;b.free();b.next=la.zpp_pool;la.zpp_pool=b},__sync:function(a){var b=a.node;if(!b.synced&&
(!this.space.continuous&&a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,a.type==g.id_ShapeType_CIRCLE?a.circle.__validate_aabb():a.polygon.__validate_aabb()),b.dyn!=(a.body.type==g.id_BodyType_STATIC?!1:!a.body.component.sleeping)||!b.aabb.contains(a.aabb)))b.synced=!0,b.snext=this.syncs,this.syncs=b},sync_broadphase:function(){this.space.validation();if(null!=this.syncs)if(null==this.moves){for(var a=this.syncs;null!=a;){var b=a.shape;a.first_sync?a.first_sync=!1:(a.dyn?this.dtree:this.stree).inlined_removeLeaf(a);
var c=a.aabb;!this.space.continuous&&b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,b.type==g.id_ShapeType_CIRCLE?b.circle.__validate_aabb():b.polygon.__validate_aabb());c.setExpand(b.aabb,3);((b.body.type==g.id_BodyType_STATIC?a.dyn=!1:a.dyn=!b.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(a);a.synced=!1;a.moved=!0;a.mnext=a.snext;a.snext=null;a=a.mnext}a=this.syncs;this.syncs=this.moves;this.moves=a}else for(;null!=this.syncs;)a=this.syncs,this.syncs=a.snext,a.snext=null,b=a.shape,
a.first_sync?a.first_sync=!1:(a.dyn?this.dtree:this.stree).inlined_removeLeaf(a),c=a.aabb,!this.space.continuous&&b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,b.type==g.id_ShapeType_CIRCLE?b.circle.__validate_aabb():b.polygon.__validate_aabb()),c.setExpand(b.aabb,3),((b.body.type==g.id_BodyType_STATIC?a.dyn=!1:a.dyn=!b.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(a),a.synced=!1,a.moved||(a.moved=!0,a.mnext=this.moves,this.moves=a)},broadphase:function(a,b){for(var c=this.syncs;null!=
c;){var d=c.shape;c.first_sync?c.first_sync=!1:(c.dyn?this.dtree:this.stree).inlined_removeLeaf(c);var e=c.aabb;!a.continuous&&d.zip_aabb&&null!=d.body&&(d.zip_aabb=!1,d.type==g.id_ShapeType_CIRCLE?d.circle.__validate_aabb():d.polygon.__validate_aabb());e.setExpand(d.aabb,3);((d.body.type==g.id_BodyType_STATIC?c.dyn=!1:c.dyn=!d.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(c);c.synced=!1;c=c.snext}for(;null!=this.syncs;)if(c=this.syncs,this.syncs=c.snext,c.snext=null,!c.moved&&
(c.moved=!1,d=c.shape,!d.body.component.sleeping)){var e=c.aabb,f=null;null!=this.dtree.root&&(this.dtree.root.next=f,f=this.dtree.root);for(;null!=f;){var h;h=f;f=h.next;h.next=null;if(h!=c)if(null==h.child1){var i=h.shape;if(i.body!=d.body&&!(i.body.type==g.id_BodyType_STATIC&&d.body.type==g.id_BodyType_STATIC)&&e.intersect(h.aabb)){var k,j;d.id<i.id?(k=d.id,j=i.id):(k=i.id,j=d.id);for(var l=null,m=(d.pairs.length<i.pairs.length?d:i).pairs.head;null!=m;){var r=m.elt;if(r.id==k&&r.di==j){l=r;break}m=
m.next}null!=l?l.sleeping&&(l.sleeping=!1,l.next=this.pairs,this.pairs=l,l.first=!0):(null==X.zpp_pool?l=new X:(l=X.zpp_pool,X.zpp_pool=l.next,l.next=null),null,l.n1=c,l.n2=h,l.id=k,l.di=j,l.next=this.pairs,this.pairs=l,l.first=!0,d.pairs.inlined_add(l),i.pairs.inlined_add(l))}}else e.intersect(h.aabb)&&(null!=h.child1&&(h.child1.next=f,f=h.child1),null!=h.child2&&(h.child2.next=f,f=h.child2))}null!=this.stree.root&&(this.stree.root.next=f,f=this.stree.root);for(;null!=f;)if(h=f,f=h.next,h.next=null,
h!=c)if(null==h.child1){if(i=h.shape,i.body!=d.body&&!(i.body.type==g.id_BodyType_STATIC&&d.body.type==g.id_BodyType_STATIC)&&e.intersect(h.aabb)){d.id<i.id?(k=d.id,j=i.id):(k=i.id,j=d.id);l=null;for(m=(d.pairs.length<i.pairs.length?d:i).pairs.head;null!=m;){r=m.elt;if(r.id==k&&r.di==j){l=r;break}m=m.next}null!=l?l.sleeping&&(l.sleeping=!1,l.next=this.pairs,this.pairs=l,l.first=!0):(null==X.zpp_pool?l=new X:(l=X.zpp_pool,X.zpp_pool=l.next,l.next=null),null,l.n1=c,l.n2=h,l.id=k,l.di=j,l.next=this.pairs,
this.pairs=l,l.first=!0,d.pairs.inlined_add(l),i.pairs.inlined_add(l))}}else e.intersect(h.aabb)&&(null!=h.child1&&(h.child1.next=f,f=h.child1),null!=h.child2&&(h.child2.next=f,f=h.child2))}for(;null!=this.moves;)if(c=this.moves,this.moves=c.mnext,c.mnext=null,c.moved=!1,d=c.shape,!d.body.component.sleeping){e=c.aabb;f=null;null!=this.dtree.root&&(this.dtree.root.next=f,f=this.dtree.root);for(;null!=f;)if(h=f,f=h.next,h.next=null,h!=c)if(null==h.child1){if(i=h.shape,i.body!=d.body&&!(i.body.type==
g.id_BodyType_STATIC&&d.body.type==g.id_BodyType_STATIC)&&e.intersect(h.aabb)){d.id<i.id?(k=d.id,j=i.id):(k=i.id,j=d.id);l=null;for(m=(d.pairs.length<i.pairs.length?d:i).pairs.head;null!=m;){r=m.elt;if(r.id==k&&r.di==j){l=r;break}m=m.next}null!=l?l.sleeping&&(l.sleeping=!1,l.next=this.pairs,this.pairs=l,l.first=!0):(null==X.zpp_pool?l=new X:(l=X.zpp_pool,X.zpp_pool=l.next,l.next=null),null,l.n1=c,l.n2=h,l.id=k,l.di=j,l.next=this.pairs,this.pairs=l,l.first=!0,d.pairs.inlined_add(l),i.pairs.inlined_add(l))}}else e.intersect(h.aabb)&&
(null!=h.child1&&(h.child1.next=f,f=h.child1),null!=h.child2&&(h.child2.next=f,f=h.child2));null!=this.stree.root&&(this.stree.root.next=f,f=this.stree.root);for(;null!=f;)if(h=f,f=h.next,h.next=null,h!=c)if(null==h.child1){if(i=h.shape,i.body!=d.body&&!(i.body.type==g.id_BodyType_STATIC&&d.body.type==g.id_BodyType_STATIC)&&e.intersect(h.aabb)){d.id<i.id?(k=d.id,j=i.id):(k=i.id,j=d.id);l=null;for(m=(d.pairs.length<i.pairs.length?d:i).pairs.head;null!=m;){r=m.elt;if(r.id==k&&r.di==j){l=r;break}m=m.next}null!=
l?l.sleeping&&(l.sleeping=!1,l.next=this.pairs,this.pairs=l,l.first=!0):(null==X.zpp_pool?l=new X:(l=X.zpp_pool,X.zpp_pool=l.next,l.next=null),null,l.n1=c,l.n2=h,l.id=k,l.di=j,l.next=this.pairs,this.pairs=l,l.first=!0,d.pairs.inlined_add(l),i.pairs.inlined_add(l))}}else e.intersect(h.aabb)&&(null!=h.child1&&(h.child1.next=f,f=h.child1),null!=h.child2&&(h.child2.next=f,f=h.child2))}c=null;for(d=this.pairs;null!=d;)!d.first&&!d.n1.aabb.intersect(d.n2.aabb)?(null==c?this.pairs=d.next:c.next=d.next,d.n1.shape.pairs.inlined_try_remove(d),
d.n2.shape.pairs.inlined_try_remove(d),e=d.next,null!=d.arb&&(d.arb.pair=null),d.arb=null,d.n1=d.n2=null,d.sleeping=!1,d.next=X.zpp_pool,X.zpp_pool=d,d=e):(e=d.n1.shape,f=e.body,h=d.n2.shape,i=h.body,!d.first&&(f.component.sleeping||f.type==g.id_BodyType_STATIC)&&(i.component.sleeping||i.type==g.id_BodyType_STATIC)?(d.sleeping=!0,null==c?this.pairs=d.next:c.next=d.next):(d.first=!1,e.aabb.intersect(h.aabb)&&(c=d.arb,d.arb=b?a.narrowPhase(e,h,f.type!=g.id_BodyType_DYNAMIC||i.type!=g.id_BodyType_DYNAMIC,
d.arb,!1):a.continuousEvent(e,h,f.type!=g.id_BodyType_DYNAMIC||i.type!=g.id_BodyType_DYNAMIC,d.arb,!1),null==d.arb?null!=c&&(c.pair=null):d.arb.pair=d),c=d),d=d.next)},bodiesUnderPoint:function(a,b,c,d){this.sync_broadphase();a=H.get(a,b,null);d=null==d?new Gc:d;if(null!=this.stree.root){null==this.treeStack&&(this.treeStack=new Ce);for(this.treeStack.add(this.stree.root);null!=this.treeStack.head;)if(b=this.treeStack.pop_unsafe(),b.aabb.containsPoint(a))if(null==b.child1){var e=b.shape.body.outer;
if(!d.has(e)&&(null==c||b.shape.filter.shouldCollide(c)))b.shape.type==g.id_ShapeType_CIRCLE?o.circleContains(b.shape.circle,a)&&d.push(e):o.polyContains(b.shape.polygon,a)&&d.push(e)}else null!=b.child1&&this.treeStack.add(b.child1),null!=b.child2&&this.treeStack.add(b.child2)}if(null!=this.dtree.root){null==this.treeStack&&(this.treeStack=new Ce);for(this.treeStack.add(this.dtree.root);null!=this.treeStack.head;)if(b=this.treeStack.pop_unsafe(),b.aabb.containsPoint(a))if(null==b.child1){if(e=b.shape.body.outer,
!d.has(e)&&(null==c||b.shape.filter.shouldCollide(c)))b.shape.type==g.id_ShapeType_CIRCLE?o.circleContains(b.shape.circle,a)&&d.push(e):o.polyContains(b.shape.polygon,a)&&d.push(e)}else null!=b.child1&&this.treeStack.add(b.child1),null!=b.child2&&this.treeStack.add(b.child2)}null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=H.zpp_pool;H.zpp_pool=a;return d},__class__:Be});var Mb=function(){this.waket=0;this.sleep=!1;this.comps=null;
this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.comps=new Mf};Mb.__name__=!0;Mb.prototype={inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},__class__:Mb};var Z=function(){this.woken=
!1;this.waket=0;this.sleeping=!1;this.body=this.constraint=this.island=null;this.isBody=!1;this.rank=0;this.next=this.parent=null;this.sleeping=!1;this.island=null;this.parent=this;this.rank=0;this.woken=!1};Z.__name__=!0;Z.prototype={__class__:Z};var Ga=function(){this.freed=this.lazydel=!1;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.int1=this.int2=this.next=null;this.id=this.di=0;this.arbiters=new Td};Ga.__name__=!0;Ga.get=function(a,b){var c;null==Ga.zpp_pool?c=new Ga:(c=Ga.zpp_pool,
Ga.zpp_pool=c.next,c.next=null);c.freed=!1;c.lazydel=!1;c.COLLISIONstate=g.id_PreFlag_ACCEPT;c.COLLISIONstamp=0;c.SENSORstate=g.id_PreFlag_ACCEPT;c.SENSORstamp=0;c.FLUIDstate=g.id_PreFlag_ACCEPT;c.FLUIDstamp=0;a.id<b.id?(c.int1=a,c.int2=b):(c.int1=b,c.int2=a);c.id=c.int1.id;c.di=c.int2.id;return c};Ga.prototype={inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&
(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},remove_arb:function(a){this.arbiters.inlined_try_remove(a)},empty_arb:function(a){var b;b=!0;for(var c=this.arbiters.head;null!=c;)if(0==(c.elt.type&a))c=c.next;else{b=!1;break}return b},sleeping:function(){var a;a=!0;for(var b=this.arbiters.head;null!=b;)if(b.elt.sleeping)b=b.next;else{a=!1;break}return a},__class__:Ga};var Nf=function(a){this.cbsets=this.space=
null;null==jb.zpp_pool?this.cbsets=new jb:(this.cbsets=jb.zpp_pool,jb.zpp_pool=this.cbsets.next,this.cbsets.next=null);null;this.cbsets.lt=T.setlt;this.space=a};Nf.__name__=!0;Nf.prototype={get:function(a){if(null==a.head)return null;var b;null==T.zpp_pool?b=new T:(b=T.zpp_pool,T.zpp_pool=b.next,b.next=null);null;var c=b.cbTypes;b.cbTypes=a;var d=this.cbsets.find_weak(b);null!=d?a=d.data:(a=T.get(a),this.cbsets.insert(a),a.manager=this);b.cbTypes=c;b.free();b.next=T.zpp_pool;T.zpp_pool=b;return a},
remove:function(a){for(this.cbsets.remove(a);null!=a.cbpairs.head;){var b=a.cbpairs.pop_unsafe();b.a!=b.b&&(a==b.a?b.b.cbpairs.remove(b):b.a.cbpairs.remove(b));b.a=b.b=null;b.listeners.clear();b.next=Ca.zpp_pool;Ca.zpp_pool=b}a.manager=null},validate:function(){if(!this.cbsets.empty()){for(var a=this.cbsets.parent;null!=a.prev;)a=a.prev;for(;null!=a;)if(a.data.validate(),null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}},pair:function(a,
b){for(var c=null,d=(a.cbpairs.length<b.cbpairs.length?a.cbpairs:b.cbpairs).head;null!=d;){var e=d.elt;if(e.a==a&&e.b==b||e.a==b&&e.b==a){c=e;break}d=d.next}null==c&&(c=Ca.get(a,b),a.cbpairs.add(c),b!=a&&b.cbpairs.add(c));c.zip_listeners&&(c.zip_listeners=!1,c.__validate());return c},__class__:Nf};var Bf=function(a,b){this.precb=this.prelisteners=null;this.continuous=!1;this.toiEvents=null;this.pre_dt=0;this.c_arbiters_true=this.c_arbiters_false=this.f_arbiters=this.s_arbiters=this.live=this.wrap_live=
this.live_constraints=this.wrap_livecon=this.staticsleep=this.islands=this.listeners=this.wrap_listeners=this.callbacks=this.callbackset_list=this.cbsets=null;this.sortcontacts=!1;this.time=0;this.midstep=!1;this.global_lin_drag=this.global_ang_drag=this.stamp=0;this.bodies=this.wrap_bodies=this.compounds=this.wrap_compounds=this.constraints=this.wrap_constraints=this.kinematics=this.bphase=this.__static=null;this.gravityx=this.gravityy=0;this.outer=null;this.toiEvents=new Of;this.global_ang_drag=
this.global_lin_drag=0.015;this.precb=new ie;this.precb.zpp_inner=new Yb;this.sortcontacts=!0;this.pre_dt=0;var c;if(!(c=null==b))null==g.Broadphase_DYNAMIC_AABB_TREE&&(g.internal=!0,g.Broadphase_DYNAMIC_AABB_TREE=new vd,g.internal=!1),c=b==g.Broadphase_DYNAMIC_AABB_TREE;c?this.bphase=new Be(this):(null==g.Broadphase_SWEEP_AND_PRUNE&&(g.internal=!0,g.Broadphase_SWEEP_AND_PRUNE=new vd,g.internal=!1),b==g.Broadphase_SWEEP_AND_PRUNE&&(this.bphase=new De(this)));this.time=0;null!=a?(this.gravityx=a.x,
this.gravityy=a.y):this.gravityy=this.gravityx=0;this.bodies=new fd;this.wrap_bodies=Eb.get(this.bodies);this.wrap_bodies.zpp_inner.adder=G(this,this.bodies_adder);this.wrap_bodies.zpp_inner.subber=G(this,this.bodies_subber);this.compounds=new Ee;this.wrap_compounds=Wb.get(this.compounds);this.wrap_compounds.zpp_inner.adder=G(this,this.compounds_adder);this.wrap_compounds.zpp_inner.subber=G(this,this.compounds_subber);this.kinematics=new fd;this.c_arbiters_true=new Fe;this.c_arbiters_false=new Fe;
this.f_arbiters=new Pf;this.s_arbiters=new Qf;this.islands=new Mb;this.live=new fd;this.wrap_live=Eb.get(this.live,!0);this.staticsleep=new fd;this.constraints=new Hc;this.wrap_constraints=ub.get(this.constraints);this.wrap_constraints.zpp_inner.adder=G(this,this.constraints_adder);this.wrap_constraints.zpp_inner.subber=G(this,this.constraints_subber);this.live_constraints=new Hc;this.wrap_livecon=ub.get(this.live_constraints,!0);this.__static=bb.__static();this.__static.zpp_inner.space=this;this.callbacks=
new Yb;this.midstep=!1;this.listeners=new Ge;this.wrap_listeners=Sb.get(this.listeners);this.wrap_listeners.zpp_inner.adder=G(this,this.listeners_adder);this.wrap_listeners.zpp_inner.subber=G(this,this.listeners_subber);this.callbackset_list=new Ga;this.mrca1=new Ic;this.mrca2=new Ic;this.prelisteners=new wd;this.cbsets=new Nf(this)};Bf.__name__=!0;Bf.prototype={bodies_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_bodies.remove(a),
this.addBody(a.zpp_inner),!0):!1},bodies_subber:function(a){this.remBody(a.zpp_inner)},compounds_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_compounds.remove(a),this.addCompound(a.zpp_inner),!0):!1},compounds_subber:function(a){this.remCompound(a.zpp_inner)},constraints_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(a),this.addConstraint(a.zpp_inner),!0):!1},
constraints_subber:function(a){this.remConstraint(a.zpp_inner)},listeners_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(a),this.addListener(a.zpp_inner),!0):!1},listeners_subber:function(a){this.remListener(a.zpp_inner)},addListener:function(a){a.space=this;a.addedToSpace();null!=a.interaction&&null},remListener:function(a){null!=a.interaction&&null;a.removedFromSpace();a.space=null},add_callbackset:function(a){a.int1.cbsets.inlined_add(a);
a.int2.cbsets.inlined_add(a);this.callbackset_list.inlined_add(a)},remove_callbackset:function(a){a.lazydel=!0;a.int1.cbsets.inlined_try_remove(a);a.int2.cbsets.inlined_try_remove(a)},transmitType:function(a,b){a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!1));a.type==g.id_BodyType_DYNAMIC?this.live.remove(a):a.type==g.id_BodyType_KINEMATIC?(this.kinematics.remove(a),this.staticsleep.remove(a)):
a.type==g.id_BodyType_STATIC&&this.staticsleep.remove(a);a.type=b;a.type==g.id_BodyType_KINEMATIC&&this.kinematics.add(a);a.type==g.id_BodyType_STATIC&&this.static_validation(a);a.component.sleeping=!0;a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0))},added_shape:function(a,b){null==b&&(b=!1);if(!b){var c=a.body;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),c.type==g.id_BodyType_KINEMATIC&&
(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1))}this.bphase.insert(a);a.addedToSpace()},removed_shape:function(a,b){null==b&&(b=!1);var c=this,d=a.body;b||d.wake();for(var e=null,f=d.arbiters.head;null!=f;){var h=[f.elt];if(h[0].ws1==a||h[0].ws2==a){if(0!=h[0].present){this.MRCA_chains(h[0].ws1,h[0].ws2);for(f=this.mrca1.head;null!=f;){for(var i=f.elt,k=this.mrca2.head;null!=k;){var j=k.elt,l=i.cbSet,m=j.cbSet;l.validate();m.validate();l.manager.pair(l,m).empty_intersection()||
(j=[$.get(i,j)],j[0].remove_arb(h[0]),h[0].present--,l.manager.pair(l,m).forall(g.id_CbEvent_END,function(a,b){return function(d){if(0!=(d.itype&b[0].type)&&a[0].empty_arb(d.itype)){var e=c.push_callback(d);e.event=g.id_CbEvent_END;$.int_callback(a[0],d,e);e.set=a[0]}}}(j,h)),null==j[0].arbiters.head&&this.remove_callbackset(j[0]));k=k.next}f=f.next}}h[0].b1!=d&&h[0].b1.type==g.id_BodyType_DYNAMIC&&(f=h[0].b1,f.world||(f.component.waket=this.stamp+(this.midstep?0:1),f.type==g.id_BodyType_KINEMATIC&&
(f.kinematicDelaySleep=!0),f.component.sleeping&&this.really_wake(f,!1)));h[0].b2!=d&&h[0].b2.type==g.id_BodyType_DYNAMIC&&(f=h[0].b2,f.world||(f.component.waket=this.stamp+(this.midstep?0:1),f.type==g.id_BodyType_KINEMATIC&&(f.kinematicDelaySleep=!0),f.component.sleeping&&this.really_wake(f,!1)));h[0].cleared=!0;(null==d||h[0].b2==d)&&h[0].b1.arbiters.inlined_try_remove(h[0]);(null==d||h[0].b1==d)&&h[0].b2.arbiters.inlined_try_remove(h[0]);null!=h[0].pair&&(h[0].pair.arb=null,h[0].pair=null);h[0].active=
!1;this.f_arbiters.modified=!0;f=d.arbiters.erase(e)}else e=f,f=f.next}this.bphase.remove(a);a.removedFromSpace()},addConstraint:function(a){a.space=this;a.addedToSpace();a.active&&(a.component.sleeping=!0,this.wake_constraint(a,!0))},remConstraint:function(a){a.active&&(this.wake_constraint(a,!0),this.live_constraints.remove(a));a.removedFromSpace();a.space=null},addCompound:function(a){a.space=this;a.addedToSpace();for(var b=a.bodies.head;null!=b;)this.addBody(b.elt),b=b.next;for(b=a.constraints.head;null!=
b;)this.addConstraint(b.elt),b=b.next;for(a=a.compounds.head;null!=a;)this.addCompound(a.elt),a=a.next},remCompound:function(a){for(var b=a.bodies.head;null!=b;)this.remBody(b.elt),b=b.next;for(b=a.constraints.head;null!=b;)this.remConstraint(b.elt),b=b.next;for(b=a.compounds.head;null!=b;)this.remCompound(b.elt),b=b.next;a.removedFromSpace();a.space=null},addBody:function(a,b){null==b&&(b=-1);a.space=this;a.addedToSpace();a.component.sleeping=!0;a.world||(a.component.waket=this.stamp+(this.midstep?
0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0));for(var c=a.shapes.head;null!=c;)this.added_shape(c.elt,!0),c=c.next;a.type==g.id_BodyType_STATIC?this.static_validation(a):a.type!=g.id_BodyType_DYNAMIC&&b!=g.id_BodyType_KINEMATIC&&this.kinematics.add(a)},remBody:function(a,b){null==b&&(b=-1);a.type==g.id_BodyType_STATIC?(a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),
a.component.sleeping&&this.really_wake(a,!0)),this.staticsleep.remove(a)):a.type==g.id_BodyType_DYNAMIC?(a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.live.remove(a)):(b!=g.id_BodyType_KINEMATIC&&this.kinematics.remove(a),a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,
!0)),this.staticsleep.remove(a));for(var c=a.shapes.head;null!=c;)this.removed_shape(c.elt,!0),c=c.next;a.removedFromSpace();a.space=null},bodiesUnderPoint:function(a,b,c,d){return this.bphase.bodiesUnderPoint(a,b,c,d)},push_callback:function(a){var b;null==Yb.zpp_pool?b=new Yb:(b=Yb.zpp_pool,Yb.zpp_pool=b.next,b.next=null);null;this.callbacks.push(b);b.listener=a;return b},step:function(a,b,c){var d=this;this.time+=a;this.pre_dt=a;this.midstep=!0;this.stamp++;this.validation();this.bphase.broadphase(this,
!0);this.prestep(a);if(this.sortcontacts){var e=this.c_arbiters_false;if(null!=e.head&&null!=e.head.next){var f=e.head,h=null,i=null,k=null,j=null,l=1,m,r,o;do{m=0;i=f;for(h=f=null;null!=i;){m++;k=i;r=0;for(o=l;null!=k&&r<l;)r++,k=k.next;for(;0<r||0<o&&null!=k;)0==r?(j=k,k=k.next,o--):0==o||null==k?(j=i,i=i.next,r--):(i.elt.active&&k.elt.active?i.elt.oc1.dist<k.elt.oc1.dist:1)?(j=i,i=i.next,r--):(j=k,k=k.next,o--),null!=h?h.next=j:f=j,h=j;i=k}h.next=null;l<<=1}while(1<m);e.head=f;e.modified=!0;e.pushmod=
!0}}this.updateVel(a);this.warmStart();this.iterateVel(b);for(b=this.kinematics.head;null!=b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=e.posy,e.pre_rot=e.rot,b=b.next;for(b=this.live.head;null!=b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=e.posy,e.pre_rot=e.rot,b=b.next;this.updatePos(a);this.continuous=!0;this.continuousCollisions(a);this.continuous=!1;this.iteratePos(c);for(c=this.kinematics.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,!(b.posx==b.pre_posx&&b.posy==b.pre_posy)&&b.invalidate_pos(),e&&b.invalidate_rot(),
c=c.next;for(c=this.live.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,!(b.posx==b.pre_posx&&b.posy==b.pre_posy)&&b.invalidate_pos(),e&&b.invalidate_rot(),c=c.next;c=null;for(b=this.staticsleep.head;null!=b;)e=b.elt,e.type!=g.id_BodyType_KINEMATIC||0==e.velx&&0==e.vely&&0==e.angvel?e.kinematicDelaySleep?(e.kinematicDelaySleep=!1,b=b.next):(e.component.sleeping=!0,b=this.staticsleep.inlined_erase(c)):(c=b,b=b.next);this.doForests(a);this.sleepArbiters();this.midstep=!1;c=null;for(a=this.callbackset_list.next;null!=
a;)b=[a],null==b[0].arbiters.head?(a=this.callbackset_list.inlined_erase(c),b=b[0],b.int1=b.int2=null,b.id=b.di=-1,b.freed=!0,null,b.next=Ga.zpp_pool,Ga.zpp_pool=b):(c=[b[0].sleeping()],T.find_all(b[0].int1.cbSet,b[0].int2.cbSet,g.id_CbEvent_ONGOING,function(a,b){return function(c){if((!a[0]||c.allowSleepingCallbacks)&&!b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=g.id_CbEvent_ONGOING;$.int_callback(b[0],c,e);e.set=b[0]}}}(c,b)),c=a,a=a.next);for(;!this.callbacks.empty();)a=this.callbacks.pop(),
a.listener.type==g.id_ListenerType_BODY?a.listener.body.handler(a.wrapper_body()):a.listener.type==g.id_ListenerType_CONSTRAINT?a.listener.constraint.handler(a.wrapper_con()):a.listener.type==g.id_ListenerType_INTERACTION&&a.listener.interaction.handleri(a.wrapper_int()),a.int1=a.int2=null,a.body=null,a.constraint=null,a.listener=null,null!=a.wrap_arbiters&&(a.wrap_arbiters.zpp_inner.inner=null),a.set=null,a.next=Yb.zpp_pool,Yb.zpp_pool=a},continuousCollisions:function(a){var b=2*Math.PI/a;this.bphase.broadphase(this,
!1);for(var c=0;1>c&&null!=this.toiEvents.head;){for(var d=null,c=2,e=!1,f=null,h=null,i=this.toiEvents.head;null!=i;){var k=i.elt,j=k.s1.body,l=k.s2.body;if(j.sweepFrozen&&l.sweepFrozen)if(0!=k.toi&&o.testCollide_safe(k.s1,k.s2))k.toi=0;else{i=this.toiEvents.erase(h);k.next=Ka.zpp_pool;Ka.zpp_pool=k;continue}if(k.frozen1!=j.sweepFrozen||k.frozen2!=l.sweepFrozen)if(k.kinematic){i=this.toiEvents.erase(h);k.next=Ka.zpp_pool;Ka.zpp_pool=k;continue}else if(k.frozen1=j.sweepFrozen,k.frozen2=l.sweepFrozen,
k.frozen1&&(j=k.s1,k.s1=k.s2,k.s2=j,k.frozen1=!1,k.frozen2=!0),ob.staticSweep(k,a,0,m.collisionSlopCCD),0>k.toi){i=this.toiEvents.erase(h);k.next=Ka.zpp_pool;Ka.zpp_pool=k;continue}if(0<=k.toi&&(k.toi<c||!e&&k.kinematic))d=k,c=k.toi,e=k.kinematic,f=h;h=i;i=i.next}if(null==d)break;this.toiEvents.erase(f);c=d.toi;e=d.s1.body;f=d.s2.body;e.sweepFrozen||(e.sweepIntegrate(c*a),e.sweepValidate(d.s1));f.sweepFrozen||(f.sweepIntegrate(c*a),f.sweepValidate(d.s2));h=this.narrowPhase(d.s1,d.s2,!0,d.arbiter,
!0);null==h?null!=d.arbiter&&null!=d.arbiter.pair&&(d.arbiter.pair.arb=null,d.arbiter.pair=null):!this.presteparb(h,a,!0)&&h.type==D.COL&&h.active&&0!=(h.immState&g.id_ImmState_ACCEPT)&&(h.colarb.warmStart(),h.colarb.applyImpulseVel(),h.colarb.applyImpulseVel(),h.colarb.applyImpulseVel(),h.colarb.applyImpulseVel(),e.sweep_angvel=e.angvel%b,f.sweep_angvel=f.angvel%b);null!=h&&h.active&&0!=(h.immState&g.id_ImmState_ACCEPT)&&h.type==D.COL&&(!e.sweepFrozen&&e.type!=g.id_BodyType_KINEMATIC&&(e.sweepFrozen=
!0,e.angvel=d.failed?e.sweep_angvel=0:d.slipped?e.sweep_angvel*=m.angularCCDSlipScale:e.sweep_angvel),!f.sweepFrozen&&f.type!=g.id_BodyType_KINEMATIC&&(f.sweepFrozen=!0,f.angvel=d.failed?f.sweep_angvel=0:d.slipped?f.sweep_angvel*=m.angularCCDSlipScale:f.sweep_angvel))}for(;null!=this.toiEvents.head;)b=this.toiEvents.pop_unsafe(),b.next=Ka.zpp_pool,Ka.zpp_pool=b;for(b=this.kinematics.head;null!=b;)d=b.elt,d.sweepIntegrate(a),d.sweepTime=0,b=b.next;for(b=this.live.head;null!=b;)d=b.elt,d.sweepFrozen||
d.sweepIntegrate(a),d.sweepTime=0,b=b.next},continuousEvent:function(a,b,c,d){if(a.body.sweepFrozen&&b.body.sweepFrozen||a.body.disableCCD||b.body.disableCCD||null!=d&&null==d.colarb||0>=this.interactionType(a,b,a.body,b.body))return d;var e=a.body,f=b.body;if(c||e.bullet||f.bullet){var h;null==Ka.zpp_pool?h=new Ka:(h=Ka.zpp_pool,Ka.zpp_pool=h.next,h.next=null);h.failed=!1;h.s1=h.s2=null;h.arbiter=null;e=e.type==g.id_BodyType_KINEMATIC||f.type==g.id_BodyType_KINEMATIC;c&&!e?(a.body.type!=g.id_BodyType_DYNAMIC?
(h.s2=a,h.s1=b):(h.s1=a,h.s2=b),h.kinematic=!1,ob.staticSweep(h,this.pre_dt,0,m.collisionSlopCCD)):(h.s1=a,h.s2=b,h.kinematic=e,h.s1.body.sweepFrozen||h.s2.body.sweepFrozen?(h.s1.body.sweepFrozen&&(a=h.s1,h.s1=h.s2,h.s2=a,h.frozen1=!1,h.frozen2=!0),ob.staticSweep(h,this.pre_dt,0,m.collisionSlopCCD)):ob.dynamicSweep(h,this.pre_dt,0,m.collisionSlopCCD));c&&0>h.toi||h.failed?(c=h,c.next=Ka.zpp_pool,Ka.zpp_pool=c):(this.toiEvents.add(h),h.frozen1=h.s1.body.sweepFrozen,h.frozen2=h.s2.body.sweepFrozen,
h.arbiter=null!=d?d.colarb:null)}return d},bodyCbWake:function(a){if(a.type==g.id_BodyType_DYNAMIC&&null!=a.cbSet)if(this.midstep)for(var b=a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_WAKE&&(c=this.push_callback(c),c.event=g.id_CbEvent_WAKE,c.body=a);b=b.next}else a.component.woken=!0},bodyCbSleep:function(a){if(a.type==g.id_BodyType_DYNAMIC&&null!=a.cbSet)for(var b=a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_SLEEP&&(c=this.push_callback(c),c.event=
g.id_CbEvent_SLEEP,c.body=a);b=b.next}},constraintCbWake:function(a){if(null!=a.cbSet)if(this.midstep)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_WAKE&&(c=this.push_callback(c),c.event=g.id_CbEvent_WAKE,c.constraint=a);b=b.next}else a.component.woken=!0},constraintCbSleep:function(a){if(null!=a.cbSet)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_SLEEP&&(c=this.push_callback(c),c.event=g.id_CbEvent_SLEEP,c.constraint=a);b=b.next}},
constraintCbBreak:function(a){if(null!=a.cbSet)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;c.event==g.id_CbEvent_BREAK&&(c=this.push_callback(c),c.event=g.id_CbEvent_BREAK,c.constraint=a);b=b.next}},nullListenerType:function(a,b){for(var c=new Ic,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;
for(d=d.compounds.head;null!=d;)c.add(d.elt),d=d.next}else{e=null!=d.ibody?d.ibody:d.ishape.body;d=null!=d.ishape?d.ishape:null;for(e=e.arbiters.head;null!=e;){var f=e.elt;if(0!=f.present&&(null==d||f.ws1==d||f.ws2==d)){this.MRCA_chains(f.ws1,f.ws2);for(f=this.mrca1.head;null!=f;){var h=f.elt;if(!(h.cbSet!=a&&h.cbSet!=b))for(var g=this.mrca2.head;null!=g;){var k=g.elt;if(!(h.cbSet==a&&k.cbSet!=b||h.cbSet==b&&k.cbSet!=a))if(k=$.get(h,k),null!=k){for(;null!=k.arbiters.head;)k.arbiters.pop_unsafe().present--;
this.remove_callbackset(k)}g=g.next}f=f.next}}e=e.next}}},nullInteractorType:function(a,b){null==b&&(b=a);if(null!=a.icompound){for(var c=a.icompound,d=c.bodies.head;null!=d;)this.nullInteractorType(d.elt,b),d=d.next;for(c=c.compounds.head;null!=c;)this.nullInteractorType(c.elt,b),c=c.next}else{d=null!=a.ibody?a.ibody:a.ishape.body;c=null!=a.ishape?a.ishape:null;for(d=d.arbiters.head;null!=d;){var e=d.elt;if(0!=e.present&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=
f;){for(var h=f.elt,g=this.mrca2.head;null!=g;){var k=g.elt;h!=b&&k!=b||(k=$.get(h,k),null!=k&&(e.present--,k.remove_arb(e),null==k.arbiters.head&&this.remove_callbackset(k)));g=g.next}f=f.next}}d=d.next}}},freshListenerType:function(a,b){for(var c=new Ic,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;for(d=
d.compounds.head;null!=d;)c.add(d.elt),d=d.next}else{e=null!=d.ibody?d.ibody:d.ishape.body;d=null!=d.ishape?d.ishape:null;for(e=e.arbiters.head;null!=e;){var f=e.elt;if(f.presentable&&(null==d||f.ws1==d||f.ws2==d)){this.MRCA_chains(f.ws1,f.ws2);for(var h=this.mrca1.head;null!=h;){var g=h.elt;if(!(g.cbSet!=a&&g.cbSet!=b))for(var k=this.mrca2.head;null!=k;){var j=k.elt;if(!(g.cbSet==a&&j.cbSet!=b||g.cbSet==b&&j.cbSet!=a)){var l=$.get(g,j);null==l&&(l=Ga.get(g,j),this.add_callbackset(l));if(j=!l.arbiters.inlined_has(f))l.arbiters.inlined_add(f),
j=!0;j&&f.present++}k=k.next}h=h.next}}e=e.next}}},freshInteractorType:function(a,b){null==b&&(b=a);if(null!=a.icompound){for(var c=a.icompound,d=c.bodies.head;null!=d;)this.freshInteractorType(d.elt,b),d=d.next;for(c=c.compounds.head;null!=c;)this.freshInteractorType(c.elt,b),c=c.next}else{d=null!=a.ibody?a.ibody:a.ishape.body;c=null!=a.ishape?a.ishape:null;for(d=d.arbiters.head;null!=d;){var e=d.elt;if(e.presentable&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=
f;){for(var h=f.elt,g=this.mrca2.head;null!=g;){var k=g.elt;if(!(h!=b&&k!=b)){var j=h.cbSet,l=k.cbSet;j.validate();l.validate();if(!j.manager.pair(j,l).empty_intersection()){j=$.get(h,k);null==j&&(j=Ga.get(h,k),this.add_callbackset(j));if(k=!j.arbiters.inlined_has(e))j.arbiters.inlined_add(e),k=!0;k&&e.present++}}g=g.next}f=f.next}}d=d.next}}},wakeCompound:function(a){for(var b=a.bodies.head;null!=b;){var c=b.elt;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),c.type==g.id_BodyType_KINEMATIC&&
(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1));b=b.next}for(b=a.constraints.head;null!=b;)this.wake_constraint(b.elt),b=b.next;for(a=a.compounds.head;null!=a;)this.wakeCompound(a.elt),a=a.next},wakeIsland:function(a){for(;null!=a.comps.head;){var b=a.comps.pop_unsafe();b.waket=this.stamp+(this.midstep?0:1);if(b.isBody){var c=b.body;this.live.add(c);for(var d=c.arbiters.head;null!=d;){var e=d.elt;e.sleeping&&(e.sleeping=!1,e.up_stamp+=this.stamp-e.sleep_stamp,e.type==D.COL?
(e=e.colarb,e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)):e.type==D.FLUID?this.f_arbiters.inlined_add(e.fluidarb):this.s_arbiters.inlined_add(e.sensorarb));d=d.next}this.bodyCbWake(c);b.sleeping=!1;b.island=null;b.parent=b;b.rank=0;if(c.type!=g.id_BodyType_STATIC)for(b=c.shapes.head;null!=b;)c=b.elt,null!=c.node&&this.bphase.sync(c),b=b.next}else c=b.constraint,this.live_constraints.inlined_add(c),this.constraintCbWake(c),b.sleeping=!1,b.island=null,b.parent=b,b.rank=
0}a.next=Mb.zpp_pool;Mb.zpp_pool=a},non_inlined_wake:function(a,b){null==b&&(b=!1);a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==g.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,b))},really_wake:function(a,b){null==b&&(b=!1);if(null==a.component.island){a.component.sleeping=!1;a.type==g.id_BodyType_KINEMATIC||a.type==g.id_BodyType_STATIC?this.staticsleep.inlined_add(a):this.live.inlined_add(a);for(var c=a.constraints.head;null!=c;){var d=
c.elt;d.space==this&&this.wake_constraint(d);c=c.next}for(c=a.arbiters.head;null!=c;){d=c.elt;if(d.sleeping)if(d.sleeping=!1,d.up_stamp+=this.stamp+(this.midstep?0:1)-d.sleep_stamp,d.type==D.COL){var e=d.colarb;e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)}else d.type==D.FLUID?this.f_arbiters.inlined_add(d.fluidarb):this.s_arbiters.inlined_add(d.sensorarb);d.type!=D.SENSOR&&!d.cleared&&d.up_stamp>=this.stamp&&0!=(d.immState&g.id_ImmState_ACCEPT)&&(d.b1.type==g.id_BodyType_DYNAMIC&&
d.b1.component.sleeping&&(e=d.b1,e.world||(e.component.waket=this.stamp+(this.midstep?0:1),e.type==g.id_BodyType_KINEMATIC&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,!1))),d.b2.type==g.id_BodyType_DYNAMIC&&d.b2.component.sleeping&&(d=d.b2,d.world||(d.component.waket=this.stamp+(this.midstep?0:1),d.type==g.id_BodyType_KINEMATIC&&(d.kinematicDelaySleep=!0),d.component.sleeping&&this.really_wake(d,!1))));c=c.next}!b&&a.type==g.id_BodyType_DYNAMIC&&this.bodyCbWake(a);if(!b&&
!this.bphase.is_sweep&&a.type!=g.id_BodyType_STATIC)for(c=a.shapes.head;null!=c;)d=c.elt,null!=d.node&&this.bphase.sync(d),c=c.next}else this.wakeIsland(a.component.island)},wake_constraint:function(a,b){null==b&&(b=!1);return a.active&&(a.component.waket=this.stamp+(this.midstep?0:1),a.component.sleeping)?(null==a.component.island?(a.component.sleeping=!1,this.live_constraints.inlined_add(a),a.wake_connected(),b||this.constraintCbWake(a)):this.wakeIsland(a.component.island),!0):!1},doForests:function(a){for(var b=
this.c_arbiters_false.head;null!=b;){var c=b.elt;if(!c.cleared&&c.up_stamp==this.stamp&&0!=(c.immState&g.id_ImmState_ACCEPT)&&c.b1.type==g.id_BodyType_DYNAMIC&&c.b2.type==g.id_BodyType_DYNAMIC){var d;if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(var e=null;d!=d.parent;){var f=d.parent;d.parent=e;e=d;d=f}for(;null!=e;)f=e.parent,e.parent=d,e=f}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=c.b2.component;for(e=null;c!=c.parent;)f=c.parent,c.parent=
e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,e=f}d!=c&&(d.rank<c.rank?d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=b.next}for(b=this.f_arbiters.head;null!=b;){c=b.elt;if(!c.cleared&&c.up_stamp==this.stamp&&0!=(c.immState&g.id_ImmState_ACCEPT)&&c.b1.type==g.id_BodyType_DYNAMIC&&c.b2.type==g.id_BodyType_DYNAMIC){if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(e=null;d!=d.parent;)f=d.parent,d.parent=e,e=d,d=f;for(;null!=e;)f=e.parent,e.parent=d,e=
f}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=c.b2.component;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,e=f}d!=c&&(d.rank<c.rank?d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=b.next}for(b=this.live_constraints.head;null!=b;)b.elt.forest(),b=b.next;for(;null!=this.live.head;){d=this.live.inlined_pop_unsafe();b=d.component;if(b==b.parent)c=b;else{c=b;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=
e.parent,e.parent=c,e=f}null==c.island&&(null==Mb.zpp_pool?c.island=new Mb:(c.island=Mb.zpp_pool,Mb.zpp_pool=c.island.next,c.island.next=null),c.island.waket=0,this.islands.inlined_add(c.island),c.island.sleep=!0);b.island=c.island;b.island.comps.inlined_add(b);d=d.atRest(a);b.island.sleep=b.island.sleep&&d;b.waket>b.island.waket&&(b.island.waket=b.waket)}for(;null!=this.live_constraints.head;){a=this.live_constraints.inlined_pop_unsafe().component;if(a==a.parent)b=a;else{b=a;for(d=null;b!=b.parent;)c=
b.parent,b.parent=d,d=b,b=c;for(;null!=d;)c=d.parent,d.parent=b,d=c}a.island=b.island;a.island.comps.inlined_add(a);a.waket>a.island.waket&&(a.island.waket=a.waket)}for(;null!=this.islands.next;)if(a=this.islands.inlined_pop_unsafe(),a.sleep)for(a=a.comps.head;null!=a;){d=a.elt;if(d.isBody){b=d.body;b.velx=0;b.vely=0;b.angvel=0;d.sleeping=!0;for(d=b.shapes.head;null!=d;)this.bphase.sync(d.elt),d=d.next;this.bodyCbSleep(b)}else this.constraintCbSleep(d.constraint),d.sleeping=!0;a=a.next}else{for(;null!=
a.comps.head;)b=a.comps.inlined_pop_unsafe(),b.waket=a.waket,b.isBody?this.live.inlined_add(b.body):this.live_constraints.inlined_add(b.constraint),b.sleeping=!1,b.island=null,b.parent=b,b.rank=0;a.next=Mb.zpp_pool;Mb.zpp_pool=a}},sleepArbiters:function(){var a=null,b=this.c_arbiters_true,c=b.head,d=null!=this.c_arbiters_false;d&&null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null);for(;null!=c;){var e=c.elt;e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,
e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next);d&&null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null)}a=null;b=this.f_arbiters;c=b.head;d=!1;for(;null!=c;)e=c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next),d&&null==c&&(d=!1,c=null.begin(),a=b=null);a=null;b=this.s_arbiters;c=b.head;d=!1;for(;null!=c;)e=c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=
!0,c=b.inlined_erase(a)):(a=c,c=c.next),d&&null==c&&(d=!1,c=null.begin(),a=b=null)},static_validation:function(a){null!=a.shapes.head&&a.validate_aabb();a.validate_mass();a.validate_inertia();for(var b=a.shapes.head;null!=b;){var c=b.elt;c.type==g.id_ShapeType_POLYGON&&(c.polygon.splice_collinear(),c.polygon.validate_gaxi());b=b.next}a.sweepFrozen=!0},validation:function(){this.cbsets.validate();for(var a=this.live.head;null!=a;){var b=a.elt;b.sweepRadius=0;for(var c=b.shapes.head;null!=c;){var d=
c.elt;d.type==g.id_ShapeType_POLYGON&&(d.polygon.splice_collinear(),d.polygon.validate_gaxi());d.validate_sweepRadius();d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius);c=c.next}b.validate_mass();b.validate_inertia();null!=b.shapes.head&&(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.bodylisteners.head;null!=c;)d=c.elt,d.event==g.id_CbEvent_WAKE&&
(d=this.push_callback(d),d.event=g.id_CbEvent_WAKE,d.body=b),c=c.next;b.component.woken=!1;for(b=b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.kinematics.head;null!=a;){b=a.elt;b.sweepRadius=0;for(c=b.shapes.head;null!=c;)d=c.elt,d.type==g.id_ShapeType_POLYGON&&(d.polygon.splice_collinear(),d.polygon.validate_gaxi()),d.validate_sweepRadius(),d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius),c=c.next;b.validate_mass();b.validate_inertia();null!=b.shapes.head&&
(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);for(b=b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.live_constraints.head;null!=a;){b=a.elt;if(b.active){if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.conlisteners.head;null!=c;)d=c.elt,d.event==g.id_CbEvent_WAKE&&(d=this.push_callback(d),d.event=g.id_CbEvent_WAKE,d.constraint=b),c=c.next;b.component.woken=!1}a=a.next}},
updateVel:function(a){for(var b=1-a*this.global_lin_drag,c=1-a*this.global_ang_drag,d=this.live.head;null!=d;){var e=d.elt;if(0!=e.smass){var f=a*e.imass;e.velx=b*e.velx+(e.forcex+this.gravityx*e.gravMass)*f;e.vely=b*e.vely+(e.forcey+this.gravityy*e.gravMass)*f}if(0!=e.sinertia){var g=f=0,f=e.worldCOMx-e.posx,g=e.worldCOMy-e.posy;e.angvel=c*e.angvel+(e.torque+(this.gravityy*f-this.gravityx*g)*e.gravMass)*a*e.iinertia}d=d.next}},updatePos:function(a){for(var b=2*Math.PI/a,c=this.live.head;null!=c;){var d=
c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=!0,d.bullet=!1;else{var e=m.staticCCDLinearThreshold*d.sweepRadius,f=m.staticCCDAngularThreshold;if((d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f||d.type==g.id_BodyType_KINEMATIC){e=d.sweep_angvel;0>e&&(e=-e);for(var f=1/e,h=d.shapes.head;null!=h;){var i=h.elt,k=i.aabb,j=k.minx,l=k.miny,o=k.maxx,r=k.maxy,p=0.008333333333333333*e*a*i.sweepCoef|
0;8<p&&(p=8);var t=e*a/p;d.sweepIntegrate(a);i.type==g.id_ShapeType_CIRCLE?i.circle._force_validate_aabb():i.polygon._force_validate_aabb();j<k.minx?k.minx=j:j=k.minx;l<k.miny?k.miny=l:l=k.miny;o>k.maxx?k.maxx=o:o=k.maxx;r>k.maxy?k.maxy=r:r=k.maxy;for(var u=1;u<p;){var v=u++;d.sweepIntegrate(t*v*f);i.type==g.id_ShapeType_CIRCLE?i.circle._force_validate_aabb():i.polygon._force_validate_aabb();j<k.minx?k.minx=j:j=k.minx;l<k.miny?k.miny=l:l=k.miny;o>k.maxx?k.maxx=o:o=k.maxx;r>k.maxy?k.maxy=r:r=k.maxy}this.bphase.sync(i);
h=h.next}d.sweepFrozen=!1;if(d.type==g.id_BodyType_DYNAMIC&&d.bulletEnabled&&(e=m.bulletCCDLinearThreshold*d.sweepRadius,f=m.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f))d.bullet=!0}else d.sweepFrozen=!0,d.bullet=!1}c=c.next}for(c=this.kinematics.head;null!=c;){d=c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=!0,d.bullet=!1;else if(e=m.staticCCDLinearThreshold*
d.sweepRadius,f=m.staticCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f||d.type==g.id_BodyType_KINEMATIC){e=d.sweep_angvel;0>e&&(e=-e);f=1/e;for(h=d.shapes.head;null!=h;){i=h.elt;k=i.aabb;j=k.minx;l=k.miny;o=k.maxx;r=k.maxy;p=0.008333333333333333*e*a*i.sweepCoef|0;8<p&&(p=8);t=e*a/p;d.sweepIntegrate(a);i.type==g.id_ShapeType_CIRCLE?i.circle._force_validate_aabb():i.polygon._force_validate_aabb();j<k.minx?k.minx=j:j=k.minx;l<k.miny?k.miny=l:l=k.miny;o>k.maxx?k.maxx=
o:o=k.maxx;r>k.maxy?k.maxy=r:r=k.maxy;for(u=1;u<p;)v=u++,d.sweepIntegrate(t*v*f),i.type==g.id_ShapeType_CIRCLE?i.circle._force_validate_aabb():i.polygon._force_validate_aabb(),j<k.minx?k.minx=j:j=k.minx,l<k.miny?k.miny=l:l=k.miny,o>k.maxx?k.maxx=o:o=k.maxx,r>k.maxy?k.maxy=r:r=k.maxy;this.bphase.sync(i);h=h.next}d.sweepFrozen=!1;if(d.type==g.id_BodyType_DYNAMIC&&d.bulletEnabled&&(e=m.bulletCCDLinearThreshold*d.sweepRadius,f=m.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*
d.angvel*a*a>f*f))d.bullet=!0}else d.sweepFrozen=!0,d.bullet=!1;c=c.next}},presteparb:function(a,b,c){null==c&&(c=!1);var d=this;if(!a.cleared&&a.b1.component.sleeping&&a.b2.component.sleeping)return a.sleep_stamp=this.stamp,a.sleeping=!0;if(!a.cleared||0!=a.present||a.intchange){var e=!c&&a.up_stamp==this.stamp-1&&!a.cleared&&!a.intchange,c=a.fresh&&!a.cleared&&!a.intchange;e&&(a.endGenerated=this.stamp);if(c||e||a.cleared||a.intchange){this.inlined_MRCA_chains(a.ws1,a.ws2);for(e=this.mrca1.head;null!=
e;){for(var f=e.elt,h=this.mrca2.head;null!=h;){var i=h.elt,k=f.cbSet,j=i.cbSet;if(!k.manager.pair(k,j).empty_intersection()){var l=[$.get(f,i)];if(c||a.intchange){null==l[0]&&(l[0]=Ga.get(f,i),this.add_callbackset(l[0]));k.manager.pair(k,j).forall(g.id_CbEvent_BEGIN,function(b){return function(c){if(0!=(c.itype&a.type)&&b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=g.id_CbEvent_BEGIN;$.int_callback(b[0],c,e);e.set=b[0]}}}(l));if(i=!l[0].arbiters.inlined_has(a))l[0].arbiters.inlined_add(a),
i=!0;i&&a.present++}else a.present--,l[0].remove_arb(a),k.manager.pair(k,j).forall(g.id_CbEvent_END,function(b){return function(c){if(0!=(c.itype&a.type)&&b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=g.id_CbEvent_END;$.int_callback(b[0],c,e);e.set=b[0]}}}(l)),null==l[0].arbiters.head&&this.remove_callbackset(l[0])}h=h.next}e=e.next}}a.fresh=!1;a.intchange=!1}if(a.cleared||a.up_stamp+(a.type==D.COL?m.arbiterExpirationDelay:0)<this.stamp)return a.type==D.SENSOR?a.sensorarb.retire():a.type==
D.FLUID?a.fluidarb.retire():a.colarb.retire(),!0;c=a.active;a.active=a.presentable=a.up_stamp==this.stamp;0!=(a.immState&g.id_ImmState_ACCEPT)?a.active&&a.type!=D.SENSOR&&(null!=a.colarb?a.colarb.preStep(b)&&(a.active=!1):a.fluidarb.preStep(this,b)):null!=a.colarb&&a.colarb.cleanupContacts()&&(a.active=!1);c!=a.active&&(a.b1.arbiters.modified=!0,a.b2.arbiters.modified=!0,this.c_arbiters_true.modified=this.c_arbiters_false.modified=!0,this.s_arbiters.modified=this.f_arbiters.modified=!0);return!1},
prestep:function(a){for(var b=null,c=this.live_constraints.head;null!=c;){var d=c.elt;d.preStep(a)?(c=this.live_constraints.erase(b),d.broken(),this.constraintCbBreak(d),d.removeOnBreak?(d.component.sleeping=!0,this.midstep=!1,null!=d.compound?d.compound.wrap_constraints.remove(d.outer):this.wrap_constraints.remove(d.outer),this.midstep=!0):d.active=!1,d.clearcache()):(b=c,c=c.next)}var b=null,c=this.c_arbiters_true,d=c.head,e=null!=this.c_arbiters_false;e&&null==d&&(e=!1,d=this.c_arbiters_false.head,
c=this.c_arbiters_false,b=null);for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,d=this.c_arbiters_false.head,c=this.c_arbiters_false,b=null);b=null;c=this.f_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,d=null.begin(),b=c=null);b=null;c=this.s_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,d=null.begin(),b=c=null)},
warmStart:function(){for(var a=this.f_arbiters.head;null!=a;){var b=a.elt;b.active&&0!=(b.immState&g.id_ImmState_ACCEPT)&&b.warmStart();a=a.next}a=this.c_arbiters_false.head;b=!0;null==a&&(a=this.c_arbiters_true.head,b=!1);for(;null!=a;){var c=a.elt;c.active&&0!=(c.immState&g.id_ImmState_ACCEPT)&&c.warmStart();a=a.next;b&&null==a&&(a=this.c_arbiters_true.head,b=!1)}for(a=this.live_constraints.head;null!=a;)a.elt.warmStart(),a=a.next},iterateVel:function(a){for(var b=0;b<a;){b++;for(var c=this.f_arbiters.head;null!=
c;){var d=c.elt;d.active&&0!=(d.immState&g.id_ImmState_ACCEPT)&&d.applyImpulseVel();c=c.next}c=null;for(d=this.live_constraints.head;null!=d;){var e=d.elt;e.applyImpulseVel()?(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==
c&&(c=this.c_arbiters_true.head,d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&g.id_ImmState_ACCEPT)&&e.applyImpulseVel(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,d=!1)}},iteratePos:function(a){for(var b=0;b<a;){b++;for(var c=null,d=this.live_constraints.head;null!=d;){var e=d.elt;!e.__velocity&&e.stiff&&e.applyImpulsePos()?(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):
this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==c&&(c=this.c_arbiters_true.head,d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&g.id_ImmState_ACCEPT)&&e.applyImpulsePos(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,d=!1)}},group_ignore:function(a,b){var c=a.lookup_group();if(null==c)return!1;var d=b.lookup_group();if(null==d)return!1;for(var e=!1;null!=c&&null!=d;){if(c==d){e=c.ignore;break}c.depth<
d.depth?d=d.group:c=c.group}return e},interactionType:function(a,b,c,d){var e;e=!1;for(var f=c.constraints.head;null!=f;){var g=f.elt;if(g.ignore&&g.pair_exists(c.id,d.id)){e=!0;break}f=f.next}return!e&&!this.group_ignore(a,b)?(a.sensorEnabled||b.sensorEnabled)&&a.filter.shouldSense(b.filter)?2:(a.fluidEnabled||b.fluidEnabled)&&a.filter.shouldFlow(b.filter)&&!(0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia)?0:a.filter.shouldCollide(b.filter)&&!(0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia)?
1:-1:-1},narrowPhase:function(a,b,c,d,e){var f=this,h=null,i=a.body,k=b.body,j=this.interactionType(a,b,i,k);if(-1!=j){var l,m;a.type>b.type?(l=b,m=a):a.type==b.type?a.id<b.id?(l=a,m=b):(m=a,l=b):(l=a,m=b);var r=l==b;if(0==j){var p;if(null==d){for(var t=null,u=(i.arbiters.length<k.arbiters.length?i:k).arbiters.head;null!=u;){var v=u.elt;if(v.id==l.id&&v.di==m.id){t=v;break}u=u.next}p=t}else p=d;var w=null==p,s,y=!1;w?(null==ya.zpp_pool?s=new ya:(s=ya.zpp_pool,ya.zpp_pool=s.next,s.next=null),null):
null==p.fluidarb?(p.cleared=!0,p.b1.arbiters.inlined_try_remove(p),p.b2.arbiters.inlined_try_remove(p),null!=p.pair&&(p.pair.arb=null,p.pair=null),p.active=!1,this.f_arbiters.modified=!0,null==ya.zpp_pool?s=new ya:(s=ya.zpp_pool,ya.zpp_pool=s.next,s.next=null),null,y=w=s.intchange=!0):s=p.fluidarb;var z=g.id_InteractionType_FLUID;if(w||s.stamp!=this.stamp||e)if(s.stamp=this.stamp,o.flowCollide(l,m,s)){w?(s.b1=a.body,s.ws1=a,s.b2=b.body,s.ws2=b,s.id=l.id,s.di=m.id,s.b1.arbiters.inlined_add(s),s.b2.arbiters.inlined_add(s),
s.active=!0,s.present=0,s.cleared=!1,s.sleeping=!1,s.fresh=!1,s.presentable=!1,s.nx=0,s.ny=1,s.dampx=0,s.dampy=0,s.adamp=0,this.f_arbiters.inlined_add(s),s.fresh=!y):s.fresh=s.up_stamp<this.stamp-1||s.endGenerated==this.stamp&&e;s.up_stamp=s.stamp;if(s.fresh||0==(s.immState&g.id_ImmState_ALWAYS)){s.immState=g.id_ImmState_ACCEPT;var B=!1;this.inlined_MRCA_chains(s.ws1.id>s.ws2.id?s.ws2:s.ws1,s.ws1.id>s.ws2.id?s.ws1:s.ws2);for(var A=this.mrca1.head;null!=A;){for(var C=A.elt,E=this.mrca2.head;null!=
E;){var F=E.elt,G=C.cbSet,H=F.cbSet;if(!G.manager.pair(G,H).empty_intersection()){var D=null,I=null;this.prelisteners.inlined_clear();G.manager.pair(G,H).forall(g.id_CbEvent_PRE,function(a){return function(b){0!=(b.itype&z)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),B=B||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(D=$.get(C,F),null==D&&(I=Ga.get(C,F),this.add_callbackset(I)),null==D||(D.FLUIDstamp!=this.stamp||e)&&0==(D.FLUIDstate&g.id_ImmState_ALWAYS)){null!=I&&(D=I);if(null!=D)for(var J=
this.prelisteners.head;null!=J;)J.elt.itype==g.id_InteractionType_ANY&&(D.COLLISIONstamp=this.stamp,D.SENSORstamp=this.stamp),D.FLUIDstamp=this.stamp,J=J.next;var M=s.active;s.active=!0;this.precb.zpp_inner.pre_arbiter=s;this.precb.zpp_inner.set=D;for(var K=this.prelisteners.head;null!=K;){var N=K.elt;this.precb.zpp_inner.listener=N;$.int_callback(D,N,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=C!=this.precb.zpp_inner.int1;var P=N.handlerp(this.precb);if(null!=P){var U=s,X=P,S;null==g.PreFlag_ACCEPT&&
(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);if(X==g.PreFlag_ACCEPT)S=g.id_ImmState_ACCEPT|g.id_ImmState_ALWAYS;else{var Y=P,T;null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1);if(Y==g.PreFlag_ACCEPT_ONCE)T=g.id_ImmState_ACCEPT;else{var ca=P;null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1);T=ca==g.PreFlag_IGNORE?g.id_ImmState_IGNORE|g.id_ImmState_ALWAYS:g.id_ImmState_IGNORE}S=T}U.immState=S}K=K.next}s.active=M;if(null!=D)for(var W=
this.prelisteners.head;null!=W;)W.elt.itype==g.id_InteractionType_ANY&&(D.COLLISIONstate=s.immState,D.SENSORstate=s.immState),D.FLUIDstate=s.immState,W=W.next}else null==D?0==(s.immState&g.id_ImmState_ALWAYS)&&(s.immState=g.id_ImmState_ACCEPT):s.immState=D.FLUIDstate}E=E.next}A=A.next}if(B&&0==(s.immState&g.id_ImmState_ALWAYS)){if(s.b1.type==g.id_BodyType_DYNAMIC){var R=s.b1;R.world||(R.component.waket=this.stamp+(this.midstep?0:1),R.type==g.id_BodyType_KINEMATIC&&(R.kinematicDelaySleep=!0),R.component.sleeping&&
this.really_wake(R,!1))}if(s.b1.type==g.id_BodyType_DYNAMIC){var V=s.b2;V.world||(V.component.waket=this.stamp+(this.midstep?0:1),V.type==g.id_BodyType_KINEMATIC&&(V.kinematicDelaySleep=!0),V.component.sleeping&&this.really_wake(V,!1))}}}if(0!=(s.immState&g.id_ImmState_ACCEPT)){if(s.b1.type==g.id_BodyType_DYNAMIC&&s.b1.component.sleeping){var aa=s.b1;aa.world||(aa.component.waket=this.stamp+(this.midstep?0:1),aa.type==g.id_BodyType_KINEMATIC&&(aa.kinematicDelaySleep=!0),aa.component.sleeping&&this.really_wake(aa,
!1))}if(s.b2.type==g.id_BodyType_DYNAMIC&&s.b2.component.sleeping){var ba=s.b2;ba.world||(ba.component.waket=this.stamp+(this.midstep?0:1),ba.type==g.id_BodyType_KINEMATIC&&(ba.kinematicDelaySleep=!0),ba.component.sleeping&&this.really_wake(ba,!1))}}s.sleeping&&(s.sleeping=!1,this.f_arbiters.inlined_add(s));h=s}else if(w){var ha=s;ha.next=ya.zpp_pool;ya.zpp_pool=ha;h=null}else h=s;else h=s}else if(1==j){var fa;fa=c?this.c_arbiters_true:this.c_arbiters_false;var O;if(null==d){for(var la=null,ga=(i.arbiters.length<
k.arbiters.length?i:k).arbiters.head;null!=ga;){var ia=ga.elt;if(ia.id==l.id&&ia.di==m.id){la=ia;break}ga=ga.next}O=la}else O=d;var ea=null==O,q,oa=!1;ea?(null==Ea.zpp_pool?q=new Ea:(q=Ea.zpp_pool,Ea.zpp_pool=q.next,q.next=null),null,q.stat=c):null==O.colarb?(O.cleared=!0,O.b1.arbiters.inlined_try_remove(O),O.b2.arbiters.inlined_try_remove(O),null!=O.pair&&(O.pair.arb=null,O.pair=null),O.active=!1,this.f_arbiters.modified=!0,null==Ea.zpp_pool?q=new Ea:(q=Ea.zpp_pool,Ea.zpp_pool=q.next,q.next=null),
null,q.intchange=!0,q.stat=c,oa=ea=!0):(q=O.colarb,r=l!=q.s1,q.stat!=c&&(q.stat=c,q.sleeping||((c?this.c_arbiters_false:this.c_arbiters_true).remove(q),fa.add(q))));var Da=g.id_InteractionType_COLLISION;if(ea||q.stamp!=this.stamp||e)if(q.stamp=this.stamp,o.contactCollide(l,m,q,r)){ea?(q.b1=a.body,q.ws1=a,q.b2=b.body,q.ws2=b,q.id=l.id,q.di=m.id,q.b1.arbiters.inlined_add(q),q.b2.arbiters.inlined_add(q),q.active=!0,q.present=0,q.cleared=!1,q.sleeping=!1,q.fresh=!1,q.presentable=!1,q.s1=a,q.s2=b,q.userdef_restitution||
(q.restitution=q.s1.material.elasticity<=Math.NEGATIVE_INFINITY||q.s2.material.elasticity<=Math.NEGATIVE_INFINITY?0:q.s1.material.elasticity>=Math.POSITIVE_INFINITY||q.s2.material.elasticity>=Math.POSITIVE_INFINITY?1:(q.s1.material.elasticity+q.s2.material.elasticity)/2,0>q.restitution&&(q.restitution=0),1<q.restitution&&(q.restitution=1)),q.userdef_dyn_fric||(q.dyn_fric=Math.sqrt(q.s1.material.dynamicFriction*q.s2.material.dynamicFriction)),q.userdef_stat_fric||(q.stat_fric=Math.sqrt(q.s1.material.staticFriction*
q.s2.material.staticFriction)),q.userdef_rfric||(q.rfric=Math.sqrt(q.s1.material.rollingFriction*q.s2.material.rollingFriction)),fa.inlined_add(q),q.fresh=!oa):q.fresh=q.up_stamp<this.stamp-1||q.endGenerated==this.stamp&&e;q.up_stamp=q.stamp;if(q.fresh||0==(q.immState&g.id_ImmState_ALWAYS)){q.immState=g.id_ImmState_ACCEPT;var qa=!1;this.inlined_MRCA_chains(q.ws1.id>q.ws2.id?q.ws2:q.ws1,q.ws1.id>q.ws2.id?q.ws1:q.ws2);for(var ma=this.mrca1.head;null!=ma;){for(var da=ma.elt,na=this.mrca2.head;null!=
na;){var wa=na.elt,pa=da.cbSet,Ca=wa.cbSet;if(!pa.manager.pair(pa,Ca).empty_intersection()){var Qa=null,ua=null;this.prelisteners.inlined_clear();pa.manager.pair(pa,Ca).forall(g.id_CbEvent_PRE,function(a){return function(b){0!=(b.itype&Da)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),qa=qa||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(Qa=$.get(da,wa),null==Qa&&(ua=Ga.get(da,wa),this.add_callbackset(ua)),null==Qa||(Qa.COLLISIONstamp!=this.stamp||e)&&0==(Qa.COLLISIONstate&g.id_ImmState_ALWAYS)){null!=
ua&&(Qa=ua);if(null!=Qa)for(var xa=this.prelisteners.head;null!=xa;)xa.elt.itype==g.id_InteractionType_ANY?(Qa.COLLISIONstamp=this.stamp,Qa.SENSORstamp=this.stamp,Qa.FLUIDstamp=this.stamp):Qa.COLLISIONstamp=this.stamp,xa=xa.next;var Na=q.active;q.active=!0;q.cleanupContacts();this.precb.zpp_inner.pre_arbiter=q;this.precb.zpp_inner.set=Qa;for(var Aa=this.prelisteners.head;null!=Aa;){var Ha=Aa.elt;this.precb.zpp_inner.listener=Ha;$.int_callback(Qa,Ha,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=
da!=this.precb.zpp_inner.int1;var Ba=Ha.handlerp(this.precb);if(null!=Ba){var Sa=q,Ua=Ba,Ka;null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);if(Ua==g.PreFlag_ACCEPT)Ka=g.id_ImmState_ACCEPT|g.id_ImmState_ALWAYS;else{var Wa=Ba,La;null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1);if(Wa==g.PreFlag_ACCEPT_ONCE)La=g.id_ImmState_ACCEPT;else{var Za=Ba;null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1);La=Za==g.PreFlag_IGNORE?
g.id_ImmState_IGNORE|g.id_ImmState_ALWAYS:g.id_ImmState_IGNORE}Ka=La}Sa.immState=Ka}Aa=Aa.next}q.active=Na;if(null!=Qa)for(var Ia=this.prelisteners.head;null!=Ia;)Ia.elt.itype==g.id_InteractionType_ANY?(Qa.COLLISIONstate=q.immState,Qa.SENSORstate=q.immState,Qa.FLUIDstate=q.immState):Qa.COLLISIONstate=q.immState,Ia=Ia.next}else null==Qa?0==(q.immState&g.id_ImmState_ALWAYS)&&(q.immState=g.id_ImmState_ACCEPT):q.immState=Qa.COLLISIONstate}na=na.next}ma=ma.next}if(qa&&0==(q.immState&g.id_ImmState_ALWAYS)){if(q.b1.type==
g.id_BodyType_DYNAMIC){var ra=q.b1;ra.world||(ra.component.waket=this.stamp+(this.midstep?0:1),ra.type==g.id_BodyType_KINEMATIC&&(ra.kinematicDelaySleep=!0),ra.component.sleeping&&this.really_wake(ra,!1))}if(q.b1.type==g.id_BodyType_DYNAMIC){var sa=q.b2;sa.world||(sa.component.waket=this.stamp+(this.midstep?0:1),sa.type==g.id_BodyType_KINEMATIC&&(sa.kinematicDelaySleep=!0),sa.component.sleeping&&this.really_wake(sa,!1))}}}if(0!=(q.immState&g.id_ImmState_ACCEPT)){if(q.b1.type==g.id_BodyType_DYNAMIC&&
q.b1.component.sleeping){var ta=q.b1;ta.world||(ta.component.waket=this.stamp+(this.midstep?0:1),ta.type==g.id_BodyType_KINEMATIC&&(ta.kinematicDelaySleep=!0),ta.component.sleeping&&this.really_wake(ta,!1))}if(q.b2.type==g.id_BodyType_DYNAMIC&&q.b2.component.sleeping){var va=q.b2;va.world||(va.component.waket=this.stamp+(this.midstep?0:1),va.type==g.id_BodyType_KINEMATIC&&(va.kinematicDelaySleep=!0),va.component.sleeping&&this.really_wake(va,!1))}}q.sleeping&&(q.sleeping=!1,fa.inlined_add(q));h=q}else if(ea){var ka=
q;ka.userdef_dyn_fric=!1;ka.userdef_stat_fric=!1;ka.userdef_restitution=!1;ka.userdef_rfric=!1;ka.__ref_edge1=ka.__ref_edge2=null;ka.next=Ea.zpp_pool;Ea.zpp_pool=ka;h=null}else h=q;else h=q}else{var Z;if(null==d){for(var Xa=null,Ma=(i.arbiters.length<k.arbiters.length?i:k).arbiters.head;null!=Ma;){var Ra=Ma.elt;if(Ra.id==l.id&&Ra.di==m.id){Xa=Ra;break}Ma=Ma.next}Z=Xa}else Z=d;var Ja=null==Z,x,bb=!1;Ja?(null==Va.zpp_pool?x=new Va:(x=Va.zpp_pool,Va.zpp_pool=x.next,x.next=null),null):null==Z.sensorarb?
(Z.cleared=!0,Z.b1.arbiters.inlined_try_remove(Z),Z.b2.arbiters.inlined_try_remove(Z),null!=Z.pair&&(Z.pair.arb=null,Z.pair=null),Z.active=!1,this.f_arbiters.modified=!0,null==Va.zpp_pool?x=new Va:(x=Va.zpp_pool,Va.zpp_pool=x.next,x.next=null),null,bb=Ja=x.intchange=!0):x=Z.sensorarb;var fb=g.id_InteractionType_SENSOR;if(Ja||x.stamp!=this.stamp||e)if(x.stamp=this.stamp,o.testCollide(l,m)){Ja?(x.b1=a.body,x.ws1=a,x.b2=b.body,x.ws2=b,x.id=l.id,x.di=m.id,x.b1.arbiters.inlined_add(x),x.b2.arbiters.inlined_add(x),
x.active=!0,x.present=0,x.cleared=!1,x.sleeping=!1,x.fresh=!1,x.presentable=!1,this.s_arbiters.inlined_add(x),x.fresh=!bb):x.fresh=x.up_stamp<this.stamp-1||x.endGenerated==this.stamp&&e;x.up_stamp=x.stamp;if(x.fresh||0==(x.immState&g.id_ImmState_ALWAYS)){x.immState=g.id_ImmState_ACCEPT;var Ta=!1;this.inlined_MRCA_chains(x.ws1.id>x.ws2.id?x.ws2:x.ws1,x.ws1.id>x.ws2.id?x.ws1:x.ws2);for(var Oa=this.mrca1.head;null!=Oa;){for(var Ya=Oa.elt,$a=this.mrca2.head;null!=$a;){var hb=$a.elt,ab=Ya.cbSet,gb=hb.cbSet;
if(!ab.manager.pair(ab,gb).empty_intersection()){var Fa=null,db=null;this.prelisteners.inlined_clear();ab.manager.pair(ab,gb).forall(g.id_CbEvent_PRE,function(a){return function(b){0!=(b.itype&fb)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),Ta=Ta||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(Fa=$.get(Ya,hb),null==Fa&&(db=Ga.get(Ya,hb),this.add_callbackset(db)),null==Fa||(Fa.SENSORstamp!=this.stamp||e)&&0==(Fa.SENSORstate&g.id_ImmState_ALWAYS)){null!=db&&(Fa=db);if(null!=Fa)for(var eb=this.prelisteners.head;null!=
eb;)eb.elt.itype==g.id_InteractionType_ANY?(Fa.COLLISIONstamp=this.stamp,Fa.SENSORstamp=this.stamp,Fa.FLUIDstamp=this.stamp):Fa.SENSORstamp=this.stamp,eb=eb.next;var vb=x.active;x.active=!0;this.precb.zpp_inner.pre_arbiter=x;this.precb.zpp_inner.set=Fa;for(var ib=this.prelisteners.head;null!=ib;){var ob=ib.elt;this.precb.zpp_inner.listener=ob;$.int_callback(Fa,ob,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=Ya!=this.precb.zpp_inner.int1;var jb=ob.handlerp(this.precb);if(null!=jb){var wb=
x,xb=jb,pb;null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);if(xb==g.PreFlag_ACCEPT)pb=g.id_ImmState_ACCEPT|g.id_ImmState_ALWAYS;else{var yb=jb,zb;null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1);if(yb==g.PreFlag_ACCEPT_ONCE)zb=g.id_ImmState_ACCEPT;else{var nb=jb;null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1);zb=nb==g.PreFlag_IGNORE?g.id_ImmState_IGNORE|g.id_ImmState_ALWAYS:g.id_ImmState_IGNORE}pb=zb}wb.immState=
pb}ib=ib.next}x.active=vb;if(null!=Fa)for(var kb=this.prelisteners.head;null!=kb;)kb.elt.itype==g.id_InteractionType_ANY?(Fa.COLLISIONstate=x.immState,Fa.SENSORstate=x.immState,Fa.FLUIDstate=x.immState):Fa.SENSORstate=x.immState,kb=kb.next}else null==Fa?0==(x.immState&g.id_ImmState_ALWAYS)&&(x.immState=g.id_ImmState_ACCEPT):x.immState=Fa.SENSORstate}$a=$a.next}Oa=Oa.next}if(Ta&&0==(x.immState&g.id_ImmState_ALWAYS)){if(x.b1.type!=g.id_BodyType_STATIC){var za=x.b1;za.world||(za.component.waket=this.stamp+
(this.midstep?0:1),za.type==g.id_BodyType_KINEMATIC&&(za.kinematicDelaySleep=!0),za.component.sleeping&&this.really_wake(za,!1))}if(x.b2.type!=g.id_BodyType_STATIC){var Ab=x.b2;Ab.world||(Ab.component.waket=this.stamp+(this.midstep?0:1),Ab.type==g.id_BodyType_KINEMATIC&&(Ab.kinematicDelaySleep=!0),Ab.component.sleeping&&this.really_wake(Ab,!1))}}}x.sleeping&&(x.sleeping=!1,this.s_arbiters.inlined_add(x));h=x}else if(Ja){var ub=x;ub.next=Va.zpp_pool;Va.zpp_pool=ub;h=null}else h=x;else h=x}}return h},
MRCA_chains:function(a,b){this.inlined_MRCA_chains(a,b)},inlined_MRCA_chains:function(a,b){this.mrca1.inlined_clear();this.mrca2.inlined_clear();null!=a.cbSet&&this.mrca1.inlined_add(a);null!=a.body.cbSet&&this.mrca1.inlined_add(a.body);null!=b.cbSet&&this.mrca2.inlined_add(b);null!=b.body.cbSet&&this.mrca2.inlined_add(b.body);for(var c=a.body.compound,d=b.body.compound;c!=d;)(null==c?0:c.depth)<(null==d?0:d.depth)?(null!=d.cbSet&&this.mrca2.inlined_add(d),d=d.compound):(null!=c.cbSet&&this.mrca1.inlined_add(c),
c=c.compound)},__class__:Bf};var rc=function(){this.next=this.prev=this.shape=this.aabb=null};rc.__name__=!0;rc.prototype={__class__:rc};var De=function(a){this.list=null;qc.call(this);this.space=a;this.is_sweep=!0;this.sweep=this};De.__name__=!0;De.__super__=qc;De.prototype=y(qc.prototype,{__insert:function(a){var b;null==rc.zpp_pool?b=new rc:(b=rc.zpp_pool,rc.zpp_pool=b.next,b.next=null);null;a.sweep=b;b.shape=a;b.aabb=a.aabb;b.next=this.list;null!=this.list&&(this.list.prev=b);this.list=b},__remove:function(a){var b=
a.sweep;null==b.prev?this.list=b.next:b.prev.next=b.next;null!=b.next&&(b.next.prev=b.prev);a.sweep=null;b.prev=null;b.shape=null;b.aabb=null;b.next=rc.zpp_pool;rc.zpp_pool=b},sync_broadphase:function(){this.space.validation();null!=this.list&&this.sync_broadphase_fast()},sync_broadphase_fast:function(){for(var a=this.list.next;null!=a;){var b=a.next,c=a.prev;if(!(a.aabb.minx>c.aabb.minx)){for(;null!=c.prev&&c.prev.aabb.minx>a.aabb.minx;)c=c.prev;var d=a.prev;d.next=a.next;null!=a.next&&(a.next.prev=
d);null==c.prev?(a.prev=null,this.list=a,a.next=c,c.prev=a):(a.prev=c.prev,c.prev=a,a.prev.next=a,a.next=c)}a=b}},broadphase:function(a,b){if(null!=this.list){this.sync_broadphase_fast();for(var c=this.list;null!=c;){for(var d=c.next,e=c.shape,f=e.body,h=c.aabb.maxx;null!=d&&!(d.aabb.minx>h);){var i=d.shape,k=i.body;if(k!=f&&!(f.type==g.id_BodyType_STATIC&&k.type==g.id_BodyType_STATIC)&&(!f.component.sleeping||!k.component.sleeping))e.aabb.intersectY(i.aabb)&&(b?a.narrowPhase(e,i,f.type!=g.id_BodyType_DYNAMIC||
k.type!=g.id_BodyType_DYNAMIC,null,!1):a.continuousEvent(e,i,f.type!=g.id_BodyType_DYNAMIC||k.type!=g.id_BodyType_DYNAMIC,null,!1));d=d.next}c=c.next}}},bodiesUnderPoint:function(a,b,c,d){this.sync_broadphase();for(var e=H.get(a,b,null),d=null==d?new Gc:d,f=this.list;null!=f&&f.aabb.minx>a;)f=f.next;for(;null!=f&&f.aabb.minx<=a;){if(f.aabb.maxx>=a&&f.aabb.miny<=b&&f.aabb.maxy>=b){var h=f.shape,i=h.body.outer;if(!d.has(i)&&(null==c||h.filter.shouldCollide(c)))h.type==g.id_ShapeType_CIRCLE?o.circleContains(h.circle,
e)&&d.push(i):o.polyContains(h.polygon,e)&&d.push(i)}f=f.next}null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null);e._isimmutable=null;e._validate=null;e._invalidate=null;e.next=H.zpp_pool;H.zpp_pool=e;return d},__class__:De});var If=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};If.__name__=!0;If.prototype={inlined_add:function(a){var b;null==Oc.zpp_pool?b=new Oc:(b=Oc.zpp_pool,Oc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;
return a},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Oc.zpp_pool;Oc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:If};var Kc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=
null};Kc.__name__=!0;Kc.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Wa.zpp_pool?b=new Wa:(b=Wa.zpp_pool,Wa.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Wa.zpp_pool?c=new Wa:(c=Wa.zpp_pool,Wa.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=
c);this.pushmod=this.modified=!0;this.length++;return c},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Wa.zpp_pool;Wa.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=
!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Kc};var fd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};fd.__name__=!0;fd.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Xa.zpp_pool?b=new Xa:(b=Xa.zpp_pool,Xa.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,
b){var c;null==Xa.zpp_pool?c=new Xa:(c=Xa.zpp_pool,Xa.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Xa.zpp_pool;Xa.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Xa.zpp_pool;Xa.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=
this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:fd};var Ee=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ee.__name__=!0;Ee.prototype={remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,
this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=He.zpp_pool;He.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Ee};var Td=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Td.__name__=!0;Td.prototype={inlined_add:function(a){var b;null==Ha.zpp_pool?b=new Ha:(b=Ha.zpp_pool,Ha.zpp_pool=b.next,
b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ha.zpp_pool;Ha.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==
a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ha.zpp_pool;Ha.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},__class__:Td};var Df=
function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Df.__name__=!0;Df.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==ac.zpp_pool?b=new ac:(b=ac.zpp_pool,ac.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=ac.zpp_pool;ac.zpp_pool=a;null==this.head&&(this.pushmod=!0);
this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=
!0));a=b;a.elt=null;a.next=ac.zpp_pool;ac.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Df};var Kf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Kf.__name__=!0;Kf.prototype={inlined_add:function(a){var b;null==sc.zpp_pool?b=new sc:(b=sc.zpp_pool,sc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=
a.next;a.elt=null;a.next=sc.zpp_pool;sc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=
b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=sc.zpp_pool;sc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Kf};var Lf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Lf.__name__=!0;Lf.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==La.zpp_pool?b=new La:(b=La.zpp_pool,La.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;
this.head=b;this.modified=!0;this.length++;return a},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==La.zpp_pool?c=new La:(c=La.zpp_pool,La.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=La.zpp_pool;La.zpp_pool=a;null==this.head&&(this.pushmod=
!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=La.zpp_pool;La.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Lf};var Ce=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ce.__name__=!0;Ce.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Pc.zpp_pool?b=new Pc:(b=Pc.zpp_pool,Pc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Pc.zpp_pool;Pc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},__class__:Ce};var Mf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Mf.__name__=!0;Mf.prototype={inlined_add:function(a){var b;
null==bc.zpp_pool?b=new bc:(b=bc.zpp_pool,bc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=bc.zpp_pool;bc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},__class__:Mf};var Fe=
function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Fe.__name__=!0;Fe.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==cc.zpp_pool?b=new cc:(b=cc.zpp_pool,cc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;
c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=cc.zpp_pool;cc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Fe};var Pf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Pf.__name__=!0;Pf.prototype={inlined_add:function(a){var b;null==tc.zpp_pool?b=new tc:(b=tc.zpp_pool,tc.zpp_pool=b.next,
b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=tc.zpp_pool;tc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Pf};var Qf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Qf.__name__=!0;Qf.prototype={inlined_add:function(a){var b;
null==dc.zpp_pool?b=new dc:(b=dc.zpp_pool,dc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=dc.zpp_pool;dc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Qf};var Ge=function(){this.length=0;this.modified=this.pushmod=
!1;this.head=null};Ge.__name__=!0;Ge.prototype={remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ie.zpp_pool;Ie.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},
iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},__class__:Ge};var Of=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Of.__name__=!0;Of.prototype={add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==ec.zpp_pool?b=new ec:(b=ec.zpp_pool,ec.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;
this.head=a.next;a.elt=null;a.next=ec.zpp_pool;ec.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ec.zpp_pool;
ec.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},__class__:Of};var Ta=function(){this.next=this.elt=null};Ta.__name__=!0;Ta.prototype={__class__:Ta};var Oc=function(){this.next=this.elt=null};Oc.__name__=!0;Oc.prototype={__class__:Oc};var Wa=function(){this.next=this.elt=null};Wa.__name__=!0;Wa.prototype={__class__:Wa};var Xa=function(){this.next=this.elt=null};Xa.__name__=!0;Xa.prototype={__class__:Xa};var ha=function(){this.next=this.elt=null};ha.__name__=!0;ha.prototype={__class__:ha};
var He=function(){this.next=this.elt=null};He.__name__=!0;He.prototype={__class__:He};var Ha=function(){this.next=this.elt=null};Ha.__name__=!0;Ha.prototype={__class__:Ha};var Da=function(){this.next=this.elt=null};Da.__name__=!0;Da.prototype={__class__:Da};var Na=function(){this.next=this.elt=null};Na.__name__=!0;Na.prototype={__class__:Na};var $b=function(){this.next=this.elt=null};$b.__name__=!0;$b.prototype={__class__:$b};var ib=function(){this.next=this.elt=null};ib.__name__=!0;ib.prototype=
{__class__:ib};var ac=function(){this.next=this.elt=null};ac.__name__=!0;ac.prototype={__class__:ac};var Ib=function(){this.next=this.elt=null};Ib.__name__=!0;Ib.prototype={__class__:Ib};var sc=function(){this.next=this.elt=null};sc.__name__=!0;sc.prototype={__class__:sc};var Oa=function(){this.next=this.elt=null};Oa.__name__=!0;Oa.prototype={__class__:Oa};var La=function(){this.next=this.elt=null};La.__name__=!0;La.prototype={__class__:La};var Pc=function(){this.next=this.elt=null};Pc.__name__=!0;
Pc.prototype={__class__:Pc};var bc=function(){this.next=this.elt=null};bc.__name__=!0;bc.prototype={__class__:bc};var cc=function(){this.next=this.elt=null};cc.__name__=!0;cc.prototype={__class__:cc};var tc=function(){this.next=this.elt=null};tc.__name__=!0;tc.prototype={__class__:tc};var dc=function(){this.next=this.elt=null};dc.__name__=!0;dc.prototype={__class__:dc};var Ie=function(){this.next=this.elt=null};Ie.__name__=!0;Ie.prototype={__class__:Ie};var ec=function(){this.next=this.elt=null};
ec.__name__=!0;ec.prototype={__class__:ec};var ed=function(){this.at_index=0;this.at_ite=null;this.zip_length=!1;this._length=0;this.inner=null;ad.call(this);this.at_ite=null;this.at_index=0;this.zip_length=!0;this._length=0};ed.__name__=!0;ed.get=function(a,b){null==b&&(b=!1);var c=new ed;c.inner=a;c.zpp_inner.immutable=b;return c};ed.__super__=ad;ed.prototype=y(ad.prototype,{zpp_gl:function(){this.zpp_vm();if(this.zip_length){this._length=0;for(var a=this.inner.next;null!=a;)this._length++,a=a.next;
this.zip_length=!1}return this._length},zpp_vm:function(){this.zpp_inner.validate();this.inner.modified&&(this.zip_length=!0,this._length=0,this.at_ite=null)},at:function(a){this.zpp_vm();this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.at_index||null==this.at_ite){this.at_index=0;for(this.at_ite=this.inner.next;;)break}for(;this.at_index!=a;){this.at_index++;for(this.at_ite=this.at_ite.next;;)break}return this.at_ite.wrapper()},push:function(a){this.zpp_inner.modify_test();this.zpp_vm();
var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.inner.add(a.zpp_inner):this.inner.insert(this.inner.iterator_at(this.zpp_gl()-1),a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},__class__:ed});var ub=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=
this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Hc;this._invalidated=!0};ub.__name__=!0;ub.get=function(a,b){null==b&&(b=!1);var c=new sf;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};ub.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&
(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:ub};var Eb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new fd;this._invalidated=!0};Eb.__name__=!0;
Eb.get=function(a,b){null==b&&(b=!1);var c=new Gc;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Eb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=
this._invalidate&&this._invalidate(this)},__class__:Eb};var Wb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Ee;this._invalidated=!0};Wb.__name__=!0;Wb.get=function(a,b){null==b&&(b=!1);var c=new yf;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};
Wb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Wb};var Sb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=
null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Ge;this._invalidated=!0};Sb.__name__=!0;Sb.get=function(a,b){null==b&&(b=!1);var c=new qf;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Sb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=
!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Sb};var $c=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=
!1;this.outer=this.inner=null;this.inner=new Lc;this._invalidated=!0};$c.__name__=!0;$c.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:$c};
var Xb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Kc;this._invalidated=!0};Xb.__name__=!0;Xb.get=function(a,b){null==b&&(b=!1);var c=new Af;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Xb.prototype={valmod:function(){this.validate();
this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Xb};var Ub=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.reverse_flag=!1;
this._validate=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Td;this._invalidated=!0};Ub.__name__=!0;Ub.get=function(a,b){null==b&&(b=!1);var c=new tf;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Ub.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},validate:function(){this._invalidated&&
(this._invalidated=!1,null!=this._validate&&this._validate())},__class__:Ub};var Qd=function(){};Qd.__name__=!0;Qd.sqr=function(a){return a*a};var mc=function(){};mc.__name__=!0;var W=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};W.__name__=!0;W.prototype={clear_with:function(a){if(null!=this.parent){for(var b=this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=
a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=W.zpp_pool;W.zpp_pool=a;return c},__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,i,k,j;b==c.prev?(f=c,j=c.next,a==b.prev?(d=a,e=b,g=a.prev,i=a.next,k=b.next):(d=b,e=a,g=b.prev,i=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,i=a.prev,k=a.next,j=b.next):(e=b,f=a,i=b.prev,k=a.prev,j=a.next));a=c.parent;null==a?this.parent=e:a.prev==
c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=i;null!=i&&(i.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=j;null!=j&&(j.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==W.zpp_pool?b=new W:(b=W.zpp_pool,W.zpp_pool=b.next,b.next=null),
null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==W.zpp_pool?b=new W:(b=W.zpp_pool,W.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==W.zpp_pool?b=new W:(b=W.zpp_pool,W.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},
__class__:W};var jb=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};jb.__name__=!0;jb.prototype={empty:function(){return null==this.parent},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},remove:function(a){this.remove_node(this.find(a))},remove_node:function(a){if(null!=
a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);
break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=jb.zpp_pool;jb.zpp_pool=a},__fix_neg_red:function(a){var b=
a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=
d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,i,k,j;b==c.prev?(f=c,j=c.next,a==b.prev?(d=a,e=b,g=a.prev,i=a.next,k=b.next):(d=b,e=a,g=b.prev,i=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,i=a.prev,k=a.next,j=b.next):(e=b,f=a,i=b.prev,k=a.prev,
j=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=i;null!=i&&(i.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=j;null!=j&&(j.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},insert:function(a){var b;null==jb.zpp_pool?b=new jb:(b=jb.zpp_pool,jb.zpp_pool=
b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:jb};var fg=0;Math.NaN=Number.NaN;Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;Math.isFinite=function(a){return isFinite(a)};
Math.isNaN=function(a){return isNaN(a)};String.prototype.__class__=String;String.__name__=!0;Array.__name__=!0;Date.prototype.__class__=Date;Date.__name__=["Date"];var gg={__name__:["Int"]},hg={__name__:["Dynamic"]},bg=Number;bg.__name__=["Float"];var cg=Boolean;cg.__ename__=["Bool"];var ig={__name__:["Class"]},jg={};v.Element="element";v.PCData="pcdata";v.CData="cdata";v.Comment="comment";v.DocType="doctype";v.ProcessingInstruction="processingInstruction";v.Document="document";Nb.instance=new Nb;
ca.DISPATCHING_SENTINEL=new wc(null,null);u.root=new ba;u.uncaughtError=new Y;u.hidden=new ea(!1);u.volume=new C(1);u._platform=Nb.instance;u._calledInit=!1;Ba.__meta__={obj:{assets:[{main2:[{bytes:4585,md5:"1d8f889bacf980ebe92f7f05ccf49276",name:"bauble1.png"},{bytes:11084,md5:"6f8575661ea03cbfc60bf84fbdd6a669",name:"bauble2.png"},{bytes:25863,md5:"e449c6a7a711ddbec5c78e0dd14be916",name:"bauble3.png"},{bytes:21280,md5:"18d0e1306e8f842c212a5b0e313fba91",name:"bauble4.png"},{bytes:12561,md5:"460ea3dd78736be8ed4fd744d930816b",
name:"bauble5.png"},{bytes:9301,md5:"5c7ddab36a38e78daba4bcdc84fd711b",name:"bell.png"},{bytes:572590,md5:"e9d8bab159f561973f012c3823836290",name:"bg.png"},{bytes:421650,md5:"6163fd460ab7488788f81bf3c818d882",name:"bg_tree.png"},{bytes:2077,md5:"62d26663f1f3710ddb81403508189578",name:"btn_play.png"},{bytes:1386,md5:"061c9571385d21cb9708de64a2c8391f",name:"btn_sound_off.png"},{bytes:2132,md5:"b74ebc6d01512e7c91a7c249bd0f0e53",name:"btn_sound_on.png"},{bytes:10424,md5:"3d8ccbbede1a29f968ae3e41f904ced8",
name:"button_click_sfx.mp3"},{bytes:4091,md5:"82da33e889b08489dcdfa481b58be892",name:"candy.png"},{bytes:22501,md5:"150b5d3ee638b5eed99df8bb93560075",name:"debug_font.fnt"},{bytes:16702,md5:"736b0c441c9ef9887af6661d36267ee6",name:"debug_font.png"},{bytes:86686,md5:"ed1da3983ddf0d3264001ea14543e7eb",name:"fonts/msg_font_23px.fnt"},{bytes:29617,md5:"c985283a227db87de40f54449d265397",name:"fonts/msg_font_23px.png"},{bytes:45367,md5:"65e2b3c6d82f7ec5020c5b080a94020c",name:"fonts/princ_msg_font_20px.fnt"},
{bytes:7975,md5:"7ad132522ae7ca595201799bb2869b75",name:"fonts/princ_msg_font_20px.png"},{bytes:45799,md5:"cb303ed7e04c454c54907c20f15a2232",name:"fonts/princ_msg_font_40px.fnt"},{bytes:19296,md5:"03b27ce2e4b7c21053b06435ec2790a3",name:"fonts/princ_msg_font_40px.png"},{bytes:45731,md5:"05a1ac99906bec3a7b3372bc4e8183a5",name:"fonts/princ_msg_font_50px.fnt"},{bytes:104109,md5:"ffebd284d609231bb3b962bab830ae3e",name:"fonts/princ_msg_font_50px.png"},{bytes:45734,md5:"d41ee4a9602d6c8b8c4c5fe2aae76404",
name:"fonts/princ_msg_font_54px.fnt"},{bytes:28924,md5:"21a69d2d6c848a398b586586df578736",name:"fonts/princ_msg_font_54px.png"},{bytes:45943,md5:"ba10982e3ae09fa11084b9b70d420f21",name:"fonts/princ_msg_font_60px.fnt"},{bytes:32847,md5:"a1d13984363cc4bb1a5dd75f5d060cfb",name:"fonts/princ_msg_font_60px.png"},{bytes:45951,md5:"55031226f12d8f60a54783e43ce384ec",name:"fonts/princ_msg_font_80px.fnt"},{bytes:48509,md5:"a1f93ce95ce64e5d2080094d6bd14cf4",name:"fonts/princ_msg_font_80px.png"},{bytes:272123,
md5:"63b5120bead37ba2e29e00b6422ffcb7",name:"fr_tree1.png"},{bytes:677549,md5:"682f1f49fcb3e2dd5329f43aba8cec6b",name:"fr_tree2.png"},{bytes:1488,md5:"0d586416ad869a92170cae1f39e814b3",name:"fx/fx3.pex"},{bytes:5701,md5:"8715f4603c7b3498fa69fc4ff104849e",name:"fx/fx3.png"},{bytes:1847,md5:"0d30c88047ff0047a023db108eedda31",name:"fx/fx3_1.png"},{bytes:1441,md5:"72fd335ac240094c927da1ea6bd1f1cd",name:"fx/fx4.pex"},{bytes:1406,md5:"70e439220d0fd068d2ee4872a2560bfd",name:"fx/msg_fx.pex"},{bytes:737,md5:"243dd9166cda90988cbbf301841a5d4d",
name:"fx/msg_fx.png"},{bytes:1525,md5:"e42e4c04003af391fd2d4d3163dfc08f",name:"fx/star.png"},{bytes:20882,md5:"69db59f12b91c1c449b3bdec64871e4a",name:"logo_bauble.png"},{bytes:33421,md5:"e61a6e3578bb8b0273373d822f3da33d",name:"msg1_bauble.png"},{bytes:318264,md5:"fd3fb811ad9cdaa1517f38ce3a75b1e2",name:"msg2_bauble.png"},{bytes:6475,md5:"730a1e26d9f2bee32f13139402d780dd",name:"ribbon1.png"},{bytes:3469,md5:"f2649727fc63d503ea39f091aa0d1966",name:"ribbon2.png"},{bytes:2306,md5:"8b3d381668961c5ca519b4071b7d1df1",
name:"ribbon3.png"},{bytes:5087,md5:"502983c53be7569e14b558995c564be2",name:"ribbon4.png"},{bytes:3981,md5:"41161dcfea4cd221a0f40f3917e4309c",name:"ribbon5.png"},{bytes:9619,md5:"390f6f1950f499e506363650d4edc79e",name:"ribbon6.png"},{bytes:0,md5:"7c3560a0ef91db57dc8d180067e9da59",name:"settings.ini"},{bytes:5942,md5:"a88739094d68d887c28045c12423e5e0",name:"sound_bauble.png"},{bytes:10424,md5:"3d8ccbbede1a29f968ae3e41f904ced8",name:"sounds/button_click_sfx.mp3"},{bytes:9397,md5:"7484e8b8a478afca25f03ff7b4666642",
name:"star1.png"},{bytes:11995,md5:"6e634dd9f0e999271e3d9ad98cbc8fdd",name:"star2.png"},{bytes:8772,md5:"5553ca4a7c848f49d7ecb4e52fcd56e7",name:"star3.png"}],main:[{bytes:4518,md5:"bb0317f3845236e30e9d45a0ec8efcde",name:"bauble1.png"},{bytes:11277,md5:"c10c943f5b1382e9c4356fe48539e079",name:"bauble2.png"},{bytes:25482,md5:"586f69d3273e399ac9b4e94606b39fa2",name:"bauble3.png"},{bytes:21280,md5:"18d0e1306e8f842c212a5b0e313fba91",name:"bauble4.png"},{bytes:12724,md5:"95723e8ef6e28274ce756e157cea12ac",
name:"bauble5.png"},{bytes:9276,md5:"7a7b77b4c93f70421929361785399c8e",name:"bell.png"},{bytes:572590,md5:"e9d8bab159f561973f012c3823836290",name:"bg.png"},{bytes:431835,md5:"0479551828c2e3515ca7d17dc629385e",name:"bg_tree.png"},{bytes:2077,md5:"62d26663f1f3710ddb81403508189578",name:"btn_play.png"},{bytes:1604,md5:"ea6cb6f9c2803d7f3b4fe100803d373f",name:"btn_sound_off.png"},{bytes:2466,md5:"aedaee681681195f925d8b2893056c67",name:"btn_sound_on.png"},{bytes:10424,md5:"3d8ccbbede1a29f968ae3e41f904ced8",
name:"button_click_sfx.mp3"},{bytes:4169,md5:"0508b7cba9373c884e764de603c49b8f",name:"candy.png"},{bytes:22501,md5:"150b5d3ee638b5eed99df8bb93560075",name:"debug_font.fnt"},{bytes:16702,md5:"736b0c441c9ef9887af6661d36267ee6",name:"debug_font.png"},{bytes:86686,md5:"ed1da3983ddf0d3264001ea14543e7eb",name:"fonts/msg_font_23px.fnt"},{bytes:29617,md5:"c985283a227db87de40f54449d265397",name:"fonts/msg_font_23px.png"},{bytes:45367,md5:"65e2b3c6d82f7ec5020c5b080a94020c",name:"fonts/princ_msg_font_20px.fnt"},
{bytes:7975,md5:"7ad132522ae7ca595201799bb2869b75",name:"fonts/princ_msg_font_20px.png"},{bytes:45799,md5:"cb303ed7e04c454c54907c20f15a2232",name:"fonts/princ_msg_font_40px.fnt"},{bytes:19296,md5:"03b27ce2e4b7c21053b06435ec2790a3",name:"fonts/princ_msg_font_40px.png"},{bytes:45731,md5:"05a1ac99906bec3a7b3372bc4e8183a5",name:"fonts/princ_msg_font_50px.fnt"},{bytes:104109,md5:"ffebd284d609231bb3b962bab830ae3e",name:"fonts/princ_msg_font_50px.png"},{bytes:45734,md5:"d41ee4a9602d6c8b8c4c5fe2aae76404",
name:"fonts/princ_msg_font_54px.fnt"},{bytes:28924,md5:"21a69d2d6c848a398b586586df578736",name:"fonts/princ_msg_font_54px.png"},{bytes:45943,md5:"ba10982e3ae09fa11084b9b70d420f21",name:"fonts/princ_msg_font_60px.fnt"},{bytes:32847,md5:"a1d13984363cc4bb1a5dd75f5d060cfb",name:"fonts/princ_msg_font_60px.png"},{bytes:45951,md5:"55031226f12d8f60a54783e43ce384ec",name:"fonts/princ_msg_font_80px.fnt"},{bytes:48509,md5:"a1f93ce95ce64e5d2080094d6bd14cf4",name:"fonts/princ_msg_font_80px.png"},{bytes:272123,
md5:"63b5120bead37ba2e29e00b6422ffcb7",name:"fr_tree1.png"},{bytes:677549,md5:"682f1f49fcb3e2dd5329f43aba8cec6b",name:"fr_tree2.png"},{bytes:1488,md5:"0d586416ad869a92170cae1f39e814b3",name:"fx/fx3.pex"},{bytes:5701,md5:"8715f4603c7b3498fa69fc4ff104849e",name:"fx/fx3.png"},{bytes:1847,md5:"0d30c88047ff0047a023db108eedda31",name:"fx/fx3_1.png"},{bytes:1441,md5:"72fd335ac240094c927da1ea6bd1f1cd",name:"fx/fx4.pex"},{bytes:1406,md5:"70e439220d0fd068d2ee4872a2560bfd",name:"fx/msg_fx.pex"},{bytes:737,md5:"243dd9166cda90988cbbf301841a5d4d",
name:"fx/msg_fx.png"},{bytes:1525,md5:"e42e4c04003af391fd2d4d3163dfc08f",name:"fx/star.png"},{bytes:20882,md5:"69db59f12b91c1c449b3bdec64871e4a",name:"logo_bauble.png"},{bytes:33421,md5:"e61a6e3578bb8b0273373d822f3da33d",name:"msg1_bauble.png"},{bytes:343909,md5:"8082927a04cac9eff9106ba99516de19",name:"msg2_bauble.png"},{bytes:6475,md5:"730a1e26d9f2bee32f13139402d780dd",name:"ribbon1.png"},{bytes:7583,md5:"d95f774fd9c99e7c94c0615a780e6a9e",name:"ribbon2.png"},{bytes:3855,md5:"8662208008d7eea84a97aacab994e476",
name:"ribbon3.png"},{bytes:5087,md5:"502983c53be7569e14b558995c564be2",name:"ribbon4.png"},{bytes:9269,md5:"951c071438141a30466c597ae7fcfea3",name:"ribbon5.png"},{bytes:9619,md5:"390f6f1950f499e506363650d4edc79e",name:"ribbon6.png"},{bytes:0,md5:"7c3560a0ef91db57dc8d180067e9da59",name:"settings.ini"},{bytes:10985,md5:"ee083a1fb3eea75413f6a5bb3cb3e5b2",name:"sound_bauble.png"},{bytes:10424,md5:"3d8ccbbede1a29f968ae3e41f904ced8",name:"sounds/button_click_sfx.mp3"},{bytes:9397,md5:"7484e8b8a478afca25f03ff7b4666642",
name:"star1.png"},{bytes:11995,md5:"6e634dd9f0e999271e3d9ad98cbc8fdd",name:"star2.png"},{bytes:8377,md5:"c27f5cef9fdbcf0b54e21e97a3ae906d",name:"star3.png"}],boot:[{bytes:2902,md5:"8d2167af32ee8a2320f03c2e173ee8f6",name:"preloader.png"},{bytes:12539,md5:"393f49e00958ef6077f345c09fd58a28",name:"rot_phone.png"}]}]}};Ba._supportsCrossOrigin=function(){var a;a=0<=window.navigator.userAgent.indexOf("Linux; U; Android")?!1:null!=(new XMLHttpRequest).withCredentials;a||null;return a}();M._scratchPoint=new Pe;
xb.NEWLINE=new jd(10);ta._sharedEvent=new Ve;ia._sharedEvent=new We;vc.CANVAS_TEXTURES=(new Ya("(iPhone|iPod|iPad)","")).match(window.navigator.userAgent);J._mediaRefCount=0;J._detectBlobSupport=!1;w.VENDOR_PREFIXES=["webkit","moz","ms","o","khtml"];w.SHOULD_HIDE_MOBILE_BROWSER=window.top==window&&(new Ya("Mobile(/.*)? Safari","")).match(window.navigator.userAgent);P._detectSupport=!0;wb.escapes=function(){var a=new Za;a.set("lt","<");a.set("gt",">");a.set("amp","&");a.set("quot",'"');a.set("apos",
"'");a.set("nbsp",String.fromCharCode(160));return a}(this);m.epsilon=1.0E-8;m.fluidAngularDragFriction=2.5;m.fluidAngularDrag=100;m.fluidVacuumDrag=0.5;m.fluidLinearDrag=0.5;m.collisionSlop=0.2;m.collisionSlopCCD=0.5;m.distanceThresholdCCD=0.05;m.staticCCDLinearThreshold=0.05;m.staticCCDAngularThreshold=0.005;m.bulletCCDLinearThreshold=0.125;m.bulletCCDAngularThreshold=0.0125;m.dynamicSweepLinearThreshold=17;m.dynamicSweepAngularThreshold=0.6;m.angularCCDSlipScale=0.75;m.arbiterExpirationDelay=6;
m.staticFrictionThreshold=2;m.elasticThreshold=20;m.sleepDelay=60;m.linearSleepThreshold=0.2;m.angularSleepThreshold=0.4;m.contactBiasCoef=0.3;m.contactStaticBiasCoef=0.6;m.contactContinuousBiasCoef=0.4;m.contactContinuousStaticBiasCoef=0.5;m.constraintLinearSlop=0.1;m.illConditionedThreshold=2E8;aa.ribbonSprite=[];aa.ribbonBody=[];I.soundsFolder="sounds/";I.isMuted=!1;j.mainAssetsFolder="main";j.defaultOrientation=Ma.Portrait;j.defaultFont="default_font";j.systemBgColor=3355443;j.buttonClickSfx=
"";j.maskRootCont=!0;j.rootContYAlign="middle";j.useMouseHandCursor=!1;V._Constraint=0;V._Interactor=0;V._CbType=0;V._CbSet=0;va.ANY_SHAPE=new rd;va.ANY_BODY=new rd;va.ANY_COMPOUND=new rd;va.ANY_CONSTRAINT=new rd;g.internal=!1;g.id_ImmState_ACCEPT=1;g.id_ImmState_IGNORE=2;g.id_ImmState_ALWAYS=4;g.id_GravMassMode_DEFAULT=0;g.id_GravMassMode_FIXED=1;g.id_GravMassMode_SCALED=2;g.id_InertiaMode_DEFAULT=0;g.id_MassMode_DEFAULT=0;g.id_BodyType_STATIC=1;g.id_BodyType_DYNAMIC=2;g.id_BodyType_KINEMATIC=3;
g.id_ListenerType_BODY=0;g.id_PreFlag_ACCEPT=1;g.id_ListenerType_CONSTRAINT=1;g.id_ListenerType_INTERACTION=2;g.id_ListenerType_PRE=3;g.id_CbEvent_BEGIN=0;g.id_InteractionType_COLLISION=1;g.id_CbEvent_ONGOING=6;g.id_InteractionType_SENSOR=2;g.id_CbEvent_END=1;g.id_InteractionType_FLUID=4;g.id_CbEvent_WAKE=2;g.id_InteractionType_ANY=7;g.id_CbEvent_SLEEP=3;g.id_CbEvent_BREAK=4;g.id_CbEvent_PRE=5;g.id_ShapeType_CIRCLE=0;g.id_ShapeType_POLYGON=1;Ua.UCbSet=new Jc;Ua.VCbSet=new Jc;Ua.WCbSet=new Jc;Ua.UCbType=
new Zb;Ua.VCbType=new Zb;Ua.WCbType=new Zb;D.internal=!1;D.COL=1;D.FLUID=4;D.SENSOR=2;O.internal=!1;o.flowpoly=new Lc;o.flowsegs=new Lc;var dg;null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new N,g.internal=!1);dg=g.BodyType_STATIC;var eg;null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new N,g.internal=!1);eg=g.BodyType_DYNAMIC;null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new N,g.internal=!1);bb.types=[null,dg,eg,g.BodyType_KINEMATIC];K.WAKE=1;K.PROPS=2;K.ANGDRAG=
4;K.ARBITERS=8;R.internal=!1;Aa.tmpaabb=new qa;ub.internal=!1;Eb.internal=!1;Wb.internal=!1;Sb.internal=!1;$c.internal=!1;Xb.internal=!1;Ub.internal=!1;U.main()})();
